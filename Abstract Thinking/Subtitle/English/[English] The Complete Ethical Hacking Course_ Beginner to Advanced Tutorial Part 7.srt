1
00:00:02,419 --> 00:00:05,940
<font color="#E5E5E5">okay so let's see how we can gain full</font>

2
00:00:05,940 --> 00:00:08,099
control<font color="#E5E5E5"> and get a meterpreter session</font>

3
00:00:08,099 --> 00:00:11,759
from<font color="#CCCCCC"> the target computer</font><font color="#E5E5E5"> so again we're</font>

4
00:00:11,759 --> 00:00:14,130
<font color="#E5E5E5">gonna go on</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> commands</font><font color="#CCCCCC"> and we're</font><font color="#E5E5E5"> gonna</font>

5
00:00:14,130 --> 00:00:15,750
go<font color="#E5E5E5"> on</font><font color="#CCCCCC"> to social engineering now there's</font>

6
00:00:15,750 --> 00:00:17,760
<font color="#E5E5E5">actually a</font><font color="#CCCCCC"> number</font><font color="#E5E5E5"> of ways</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> you can</font>

7
00:00:17,760 --> 00:00:21,300
use in here<font color="#E5E5E5"> to get a reverse</font><font color="#CCCCCC"> shell now</font>

8
00:00:21,300 --> 00:00:23,430
it all depends on how<font color="#CCCCCC"> you want to make</font>

9
00:00:23,430 --> 00:00:26,070
<font color="#E5E5E5">your social engineering attack what</font>

10
00:00:26,070 --> 00:00:27,510
we're going to<font color="#CCCCCC"> use we're going</font><font color="#E5E5E5"> to use</font><font color="#CCCCCC"> a</font>

11
00:00:27,510 --> 00:00:30,060
notification<font color="#E5E5E5"> bar</font><font color="#CCCCCC"> a fake notification bar</font>

12
00:00:30,060 --> 00:00:32,488
<font color="#E5E5E5">and we're choosing Firefox</font><font color="#CCCCCC"> because our</font>

13
00:00:32,488 --> 00:00:35,280
target<font color="#CCCCCC"> is runs on Firefox or are using</font>

14
00:00:35,280 --> 00:00:39,000
<font color="#CCCCCC">Firefox</font><font color="#E5E5E5"> so what this will do it will</font>

15
00:00:39,000 --> 00:00:41,010
basically tell the user it will<font color="#E5E5E5"> display</font>

16
00:00:41,010 --> 00:00:43,260
a<font color="#CCCCCC"> notification bar</font><font color="#E5E5E5"> telling the user that</font>

17
00:00:43,260 --> 00:00:44,700
<font color="#E5E5E5">there is a new</font><font color="#CCCCCC"> update or there is a</font>

18
00:00:44,700 --> 00:00:46,890
<font color="#E5E5E5">plug-in that you need to install once</font>

19
00:00:46,890 --> 00:00:48,690
they install the plug-in<font color="#E5E5E5"> then they'll</font>

20
00:00:48,690 --> 00:00:50,520
actually install a backdoor<font color="#E5E5E5"> and you'll</font>

21
00:00:50,520 --> 00:00:53,039
gain full access to their<font color="#E5E5E5"> computer so</font>

22
00:00:53,039 --> 00:00:54,510
the way we're gonna do<font color="#CCCCCC"> this is we're</font>

23
00:00:54,510 --> 00:00:55,890
gonna<font color="#E5E5E5"> use the same backdoor that we</font>

24
00:00:55,890 --> 00:00:57,690
always created and we've been using<font color="#CCCCCC"> now</font>

25
00:00:57,690 --> 00:01:01,079
<font color="#CCCCCC">I actually have it stored in my web</font>

26
00:01:01,079 --> 00:01:05,719
server so I have it stored<font color="#CCCCCC"> in bar</font>

27
00:01:05,980 --> 00:01:09,020
<font color="#E5E5E5">www dot html' and I have it called</font>

28
00:01:09,020 --> 00:01:12,229
<font color="#CCCCCC">update 30 exe but it's the same backdoor</font>

29
00:01:12,229 --> 00:01:14,720
the same reverse HTTP interpreter that

30
00:01:14,720 --> 00:01:17,119
we used before

31
00:01:17,119 --> 00:01:20,210
so I'm gonna give the full<font color="#CCCCCC"> address to it</font>

32
00:01:20,210 --> 00:01:29,090
here so<font color="#CCCCCC"> it's stored in</font><font color="#E5E5E5"> 10 2014 207</font>

33
00:01:29,090 --> 00:01:32,869
that's my actual<font color="#CCCCCC"> IP and the name</font><font color="#E5E5E5"> of the</font>

34
00:01:32,869 --> 00:01:35,990
file is updated<font color="#E5E5E5"> to</font><font color="#CCCCCC"> Exe</font>

35
00:01:35,990 --> 00:01:38,780
and then the notification<font color="#E5E5E5"> the</font>

36
00:01:38,780 --> 00:01:40,280
notification is just saying<font color="#E5E5E5"> there is an</font>

37
00:01:40,280 --> 00:01:41,930
additional<font color="#CCCCCC"> plug-in that needs to be</font>

38
00:01:41,930 --> 00:01:44,990
installed<font color="#E5E5E5"> to display some elements on</font>

39
00:01:44,990 --> 00:01:46,790
this<font color="#CCCCCC"> page</font><font color="#E5E5E5"> now you can change this and</font>

40
00:01:46,790 --> 00:01:51,940
just say critical<font color="#E5E5E5"> updates for Firefox</font>

41
00:01:52,300 --> 00:01:55,350
<font color="#E5E5E5">click here</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> install</font>

42
00:01:56,740 --> 00:02:00,270
so I'm<font color="#E5E5E5"> going to hit execute</font>

43
00:02:01,180 --> 00:02:03,910
and if we go<font color="#E5E5E5"> on</font><font color="#CCCCCC"> the target</font><font color="#E5E5E5"> you can see</font>

44
00:02:03,910 --> 00:02:05,170
that they're getting<font color="#E5E5E5"> a</font><font color="#CCCCCC"> message telling</font>

45
00:02:05,170 --> 00:02:06,430
them that<font color="#E5E5E5"> there</font><font color="#CCCCCC"> is a new update</font><font color="#E5E5E5"> for</font>

46
00:02:06,430 --> 00:02:08,830
<font color="#E5E5E5">Firefox and click here to download and</font>

47
00:02:08,830 --> 00:02:10,960
install<font color="#E5E5E5"> so the target person will be</font>

48
00:02:10,960 --> 00:02:12,760
like oh yeah I need<font color="#CCCCCC"> to install</font><font color="#E5E5E5"> this so</font>

49
00:02:12,760 --> 00:02:16,030
they download<font color="#CCCCCC"> it and now basically</font><font color="#E5E5E5"> they</font>

50
00:02:16,030 --> 00:02:18,250
have<font color="#E5E5E5"> a</font><font color="#CCCCCC"> backdoor</font><font color="#E5E5E5"> downloaded on their</font>

51
00:02:18,250 --> 00:02:20,410
machine once they try to run<font color="#E5E5E5"> this</font>

52
00:02:20,410 --> 00:02:22,060
backdoor to install the update they

53
00:02:22,060 --> 00:02:23,560
think it's an update but they'll

54
00:02:23,560 --> 00:02:25,480
<font color="#E5E5E5">actually run a backdoor which will give</font>

55
00:02:25,480 --> 00:02:28,030
<font color="#CCCCCC">us full access to their computer</font><font color="#E5E5E5"> before</font>

56
00:02:28,030 --> 00:02:29,560
I run the backdoor I need to listen on

57
00:02:29,560 --> 00:02:31,270
the<font color="#CCCCCC"> part</font><font color="#E5E5E5"> exactly like we</font><font color="#CCCCCC"> did it before</font>

58
00:02:31,270 --> 00:02:33,310
<font color="#CCCCCC">so I'm just gonna</font><font color="#E5E5E5"> do show options here</font>

59
00:02:33,310 --> 00:02:34,750
to show you I'm not<font color="#E5E5E5"> gonna go through all</font>

60
00:02:34,750 --> 00:02:37,450
<font color="#E5E5E5">the steps it's using</font><font color="#CCCCCC"> Metasploit Multi</font>

61
00:02:37,450 --> 00:02:39,670
<font color="#CCCCCC">hunter</font><font color="#E5E5E5"> same way we did it in the video</font>

62
00:02:39,670 --> 00:02:43,150
of listening for ports<font color="#E5E5E5"> so we're using</font>

63
00:02:43,150 --> 00:02:46,060
<font color="#E5E5E5">meterpreter reverse HTTP</font><font color="#CCCCCC"> I have my IP</font>

64
00:02:46,060 --> 00:02:48,580
and the port<font color="#E5E5E5"> so I'm just</font><font color="#CCCCCC"> gonna do</font>

65
00:02:48,580 --> 00:02:50,390
exploit

66
00:02:50,390 --> 00:02:52,850
and I'm<font color="#E5E5E5"> listening</font><font color="#CCCCCC"> for the connections</font>

67
00:02:52,850 --> 00:02:55,280
now<font color="#CCCCCC"> now let's run the update that we</font>

68
00:02:55,280 --> 00:02:58,000
just<font color="#E5E5E5"> downloaded</font>

69
00:03:03,230 --> 00:03:05,290
you

70
00:03:05,410 --> 00:03:08,200
and if we go<font color="#CCCCCC"> on the target</font><font color="#E5E5E5"> you can see</font>

71
00:03:08,200 --> 00:03:10,570
that we got full control<font color="#CCCCCC"> over</font><font color="#E5E5E5"> it using</font><font color="#CCCCCC"> a</font>

72
00:03:10,570 --> 00:03:13,140
meterpreter session

73
00:03:14,990 --> 00:03:19,610
now again this<font color="#CCCCCC"> is just</font><font color="#E5E5E5"> an</font><font color="#CCCCCC"> example</font><font color="#E5E5E5"> of one</font>

74
00:03:19,610 --> 00:03:21,440
<font color="#E5E5E5">way of gaining full control over the</font>

75
00:03:21,440 --> 00:03:23,450
<font color="#E5E5E5">target computer</font><font color="#CCCCCC"> there's a number of</font><font color="#E5E5E5"> ways</font>

76
00:03:23,450 --> 00:03:25,760
that<font color="#E5E5E5"> you can do using beef and</font><font color="#CCCCCC"> there is</font>

77
00:03:25,760 --> 00:03:27,590
a number<font color="#CCCCCC"> of</font><font color="#E5E5E5"> social</font><font color="#CCCCCC"> engineering attacks</font>

78
00:03:27,590 --> 00:03:30,320
<font color="#E5E5E5">that you can do to gain full access on</font>

79
00:03:30,320 --> 00:03:32,840
the target computer<font color="#E5E5E5"> so again I highly</font>

80
00:03:32,840 --> 00:03:35,590
<font color="#E5E5E5">recommend you go over the plugins and</font>

81
00:03:35,590 --> 00:03:37,550
experiment with<font color="#E5E5E5"> them</font><font color="#CCCCCC"> and see what</font>

82
00:03:37,550 --> 00:03:41,600
attacks you can come<font color="#E5E5E5"> up with now let's</font>

83
00:03:41,600 --> 00:03:44,180
talk about<font color="#E5E5E5"> how we can prevent XSS</font>

84
00:03:44,180 --> 00:03:46,640
vulnerabilities the way these

85
00:03:46,640 --> 00:03:48,830
vulnerabilities happen is because

86
00:03:48,830 --> 00:03:51,710
<font color="#E5E5E5">whatever a user enters something into a</font>

87
00:03:51,710 --> 00:03:54,860
text box<font color="#CCCCCC"> or</font><font color="#E5E5E5"> into a parameter that input</font>

88
00:03:54,860 --> 00:03:58,070
<font color="#E5E5E5">is displayed into the HTML so it's</font>

89
00:03:58,070 --> 00:04:00,380
treated as if it's<font color="#E5E5E5"> part of the page and</font>

90
00:04:00,380 --> 00:04:02,960
therefore if there is JavaScript<font color="#CCCCCC"> in it</font>

91
00:04:02,960 --> 00:04:06,800
the code is<font color="#CCCCCC"> being executed so to prevent</font>

92
00:04:06,800 --> 00:04:09,650
<font color="#E5E5E5">this exploit the best thing to do is to</font>

93
00:04:09,650 --> 00:04:13,040
try<font color="#E5E5E5"> and minimize</font><font color="#CCCCCC"> the usage of untrusted</font>

94
00:04:13,040 --> 00:04:15,350
input so anytime<font color="#E5E5E5"> a user input something</font>

95
00:04:15,350 --> 00:04:17,180
<font color="#E5E5E5">or anytime something's input from</font>

96
00:04:17,180 --> 00:04:20,690
parameters<font color="#E5E5E5"> try to minimize that also</font>

97
00:04:20,690 --> 00:04:22,880
make<font color="#CCCCCC"> sure that you always escape</font>

98
00:04:22,880 --> 00:04:25,850
whatever<font color="#E5E5E5"> that's</font><font color="#CCCCCC"> going to be</font><font color="#E5E5E5"> displayed or</font>

99
00:04:25,850 --> 00:04:29,420
used<font color="#CCCCCC"> into the</font><font color="#E5E5E5"> HTML page because XSS can</font>

100
00:04:29,420 --> 00:04:31,910
not only be injected into places<font color="#CCCCCC"> where</font>

101
00:04:31,910 --> 00:04:33,980
things are displayed<font color="#CCCCCC"> on the page</font><font color="#E5E5E5"> but it</font>

102
00:04:33,980 --> 00:04:36,800
can also be injected into parameters of

103
00:04:36,800 --> 00:04:41,440
certain elements<font color="#CCCCCC"> of the HTML</font><font color="#E5E5E5"> page</font>

104
00:04:41,790 --> 00:04:44,910
so what I mean<font color="#CCCCCC"> by escaping</font><font color="#E5E5E5"> is converting</font>

105
00:04:44,910 --> 00:04:47,160
each of these characters to what they

106
00:04:47,160 --> 00:04:50,790
would<font color="#CCCCCC"> be represented by an HTML you</font><font color="#E5E5E5"> can</font>

107
00:04:50,790 --> 00:04:52,710
do that using scripts and<font color="#CCCCCC"> you can do</font>

108
00:04:52,710 --> 00:04:55,620
that using<font color="#E5E5E5"> your own script now let me</font>

109
00:04:55,620 --> 00:04:57,510
show<font color="#CCCCCC"> you how this happens now I'm here</font>

110
00:04:57,510 --> 00:04:59,490
at my vulnerable web page that we were

111
00:04:59,490 --> 00:05:01,970
using<font color="#E5E5E5"> and I'm gonna go to this third one</font>

112
00:05:01,970 --> 00:05:04,830
and<font color="#E5E5E5"> obviously can see that every time</font><font color="#CCCCCC"> we</font>

113
00:05:04,830 --> 00:05:07,800
<font color="#E5E5E5">click on</font><font color="#CCCCCC"> that the XSS runs so let's</font>

114
00:05:07,800 --> 00:05:09,990
inspect this<font color="#E5E5E5"> element now this element is</font>

115
00:05:09,990 --> 00:05:13,260
where we injected<font color="#E5E5E5"> our alert and if we</font>

116
00:05:13,260 --> 00:05:16,710
<font color="#CCCCCC">right-click and go on inspect element it</font>

117
00:05:16,710 --> 00:05:20,160
will show us<font color="#E5E5E5"> the HTML of this page or</font>

118
00:05:20,160 --> 00:05:22,890
the<font color="#CCCCCC"> HTML of this particular element</font>

119
00:05:22,890 --> 00:05:26,730
right here highlighted so I'm<font color="#E5E5E5"> going to</font>

120
00:05:26,730 --> 00:05:30,210
make this bigger<font color="#E5E5E5"> and if we look at it</font>

121
00:05:30,210 --> 00:05:32,430
right<font color="#CCCCCC"> here you'll</font><font color="#E5E5E5"> see that</font><font color="#CCCCCC"> we have the</font>

122
00:05:32,430 --> 00:05:37,320
name and that's<font color="#CCCCCC"> xate and then the other</font>

123
00:05:37,320 --> 00:05:40,380
input which<font color="#CCCCCC"> is</font><font color="#E5E5E5"> the message it's a script</font>

124
00:05:40,380 --> 00:05:42,450
<font color="#E5E5E5">and the script where the script tells it</font>

125
00:05:42,450 --> 00:05:45,090
does<font color="#E5E5E5"> alert exercise so it's exactly what</font>

126
00:05:45,090 --> 00:05:47,220
we injected into it<font color="#CCCCCC"> when we did the</font>

127
00:05:47,220 --> 00:05:50,850
comment so every time<font color="#E5E5E5"> we run this page</font>

128
00:05:50,850 --> 00:05:54,720
this piece of code gets<font color="#E5E5E5"> is executed so</font>

129
00:05:54,720 --> 00:05:56,430
we need to do is we need<font color="#E5E5E5"> to make</font><font color="#CCCCCC"> sure</font>

130
00:05:56,430 --> 00:05:58,590
every<font color="#CCCCCC"> time a user enters</font><font color="#E5E5E5"> something and</font>

131
00:05:58,590 --> 00:06:00,600
that something<font color="#E5E5E5"> will be displayed on a</font>

132
00:06:00,600 --> 00:06:03,180
page<font color="#CCCCCC"> or that something</font><font color="#E5E5E5"> will</font><font color="#CCCCCC"> be used</font>

133
00:06:03,180 --> 00:06:06,000
<font color="#E5E5E5">somewhere</font><font color="#CCCCCC"> in the</font><font color="#E5E5E5"> elements so even the ID</font>

134
00:06:06,000 --> 00:06:09,540
here or even<font color="#E5E5E5"> the H the ID is just for</font>

135
00:06:09,540 --> 00:06:12,060
<font color="#CCCCCC">example is a</font><font color="#E5E5E5"> parameter of the</font><font color="#CCCCCC"> Dib it's</font>

136
00:06:12,060 --> 00:06:14,460
not displayed you never see<font color="#E5E5E5"> this ID but</font>

137
00:06:14,460 --> 00:06:16,650
this is this can<font color="#CCCCCC"> be injectable it can be</font>

138
00:06:16,650 --> 00:06:19,530
<font color="#CCCCCC">injected as well so hackers can actually</font>

139
00:06:19,530 --> 00:06:21,360
try<font color="#CCCCCC"> to inject</font><font color="#E5E5E5"> stuff into the parameters</font>

140
00:06:21,360 --> 00:06:24,030
<font color="#CCCCCC">they can try</font><font color="#E5E5E5"> to inject itself into the</font>

141
00:06:24,030 --> 00:06:26,040
image attributes<font color="#E5E5E5"> for</font><font color="#CCCCCC"> example they can</font><font color="#E5E5E5"> do</font>

142
00:06:26,040 --> 00:06:28,350
an image and inject stuff into the

143
00:06:28,350 --> 00:06:30,900
source or into the URL<font color="#E5E5E5"> so this is just</font>

144
00:06:30,900 --> 00:06:34,140
an example here and every<font color="#E5E5E5"> time</font><font color="#CCCCCC"> a user's</font>

145
00:06:34,140 --> 00:06:36,390
input is going<font color="#E5E5E5"> to</font><font color="#CCCCCC"> be</font><font color="#E5E5E5"> used anywhere on</font>

146
00:06:36,390 --> 00:06:38,250
the<font color="#E5E5E5"> page so even if you don't see it if</font>

147
00:06:38,250 --> 00:06:40,110
you usually<font color="#E5E5E5"> don't see it you need</font><font color="#CCCCCC"> to</font>

148
00:06:40,110 --> 00:06:42,570
<font color="#CCCCCC">make sure</font><font color="#E5E5E5"> that you escape that input and</font>

149
00:06:42,570 --> 00:06:45,090
make sure that it does<font color="#E5E5E5"> not</font><font color="#CCCCCC"> contain any</font>

150
00:06:45,090 --> 00:06:46,800
code and if it contains any code that

151
00:06:46,800 --> 00:06:49,230
<font color="#CCCCCC">it's it's converted to its HTTP</font>

152
00:06:49,230 --> 00:06:51,630
equivalent<font color="#E5E5E5"> once you escape this you'll</font>

153
00:06:51,630 --> 00:06:53,850
actually<font color="#E5E5E5"> see this in the message so you</font>

154
00:06:53,850 --> 00:06:55,530
see the message<font color="#CCCCCC"> as script</font>

155
00:06:55,530 --> 00:06:59,130
<font color="#E5E5E5">xs/s but it will never be executed</font><font color="#CCCCCC"> the</font>

156
00:06:59,130 --> 00:07:01,200
this script will never actually be

157
00:07:01,200 --> 00:07:03,540
<font color="#E5E5E5">executed on</font><font color="#CCCCCC"> the target person</font><font color="#E5E5E5"> when they</font>

158
00:07:03,540 --> 00:07:05,930
run it

159
00:07:06,030 --> 00:07:08,250
and this is<font color="#CCCCCC"> exactly</font><font color="#E5E5E5"> what the high</font>

160
00:07:08,250 --> 00:07:10,740
security<font color="#CCCCCC"> level implements so let me go</font>

161
00:07:10,740 --> 00:07:14,640
through<font color="#CCCCCC"> the security</font><font color="#E5E5E5"> settings</font><font color="#CCCCCC"> and let me</font>

162
00:07:14,640 --> 00:07:18,630
close this and I'm gonna set this to

163
00:07:18,630 --> 00:07:24,570
high I'm<font color="#E5E5E5"> gonna submit</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> and we'll go</font>

164
00:07:24,570 --> 00:07:26,100
<font color="#E5E5E5">back to our reflected it's the same</font>

165
00:07:26,100 --> 00:07:29,100
<font color="#E5E5E5">measurement are taken in the reflected</font>

166
00:07:29,100 --> 00:07:32,040
and in distort<font color="#E5E5E5"> and now if we try</font><font color="#CCCCCC"> to</font>

167
00:07:32,040 --> 00:07:34,680
inject any of our codes that we were

168
00:07:34,680 --> 00:07:37,260
doing<font color="#CCCCCC"> before for example if we try</font><font color="#E5E5E5"> to</font>

169
00:07:37,260 --> 00:07:41,340
inject this script<font color="#E5E5E5"> so script alert XSS</font>

170
00:07:41,340 --> 00:07:43,980
and<font color="#CCCCCC"> then we close the script you'll see</font>

171
00:07:43,980 --> 00:07:46,470
<font color="#E5E5E5">this script</font><font color="#CCCCCC"> exactly the same</font><font color="#E5E5E5"> way that</font>

172
00:07:46,470 --> 00:07:48,000
you<font color="#E5E5E5"> would have seen a normal name so if</font>

173
00:07:48,000 --> 00:07:49,860
we say is<font color="#E5E5E5"> 8 here you'll just see my name</font>

174
00:07:49,860 --> 00:07:53,700
and if we inject our script<font color="#E5E5E5"> you'll see</font>

175
00:07:53,700 --> 00:07:56,040
it appearing as if<font color="#E5E5E5"> it's a normal name it</font>

176
00:07:56,040 --> 00:07:58,350
<font color="#E5E5E5">doesn't appear you</font><font color="#CCCCCC"> don't only</font><font color="#E5E5E5"> see what's</font>

177
00:07:58,350 --> 00:08:00,030
between the tags<font color="#E5E5E5"> and then the code</font>

178
00:08:00,030 --> 00:08:02,790
doesn't<font color="#E5E5E5"> even get executed if we look at</font>

179
00:08:02,790 --> 00:08:06,030
the source you'll see that you see all

180
00:08:06,030 --> 00:08:07,680
the tags so you can<font color="#E5E5E5"> see the script tag</font>

181
00:08:07,680 --> 00:08:09,990
<font color="#E5E5E5">you</font><font color="#CCCCCC"> can see the close</font><font color="#E5E5E5"> of the script tag</font>

182
00:08:09,990 --> 00:08:12,090
and everything<font color="#CCCCCC"> is</font><font color="#E5E5E5"> being injected</font>

183
00:08:12,090 --> 00:08:14,100
properly so you think<font color="#CCCCCC"> that this should</font>

184
00:08:14,100 --> 00:08:16,560
<font color="#CCCCCC">work</font><font color="#E5E5E5"> but it doesn't</font><font color="#CCCCCC"> work because</font><font color="#E5E5E5"> the</font>

185
00:08:16,560 --> 00:08:18,390
website or<font color="#E5E5E5"> the</font><font color="#CCCCCC"> web page or the browser</font>

186
00:08:18,390 --> 00:08:21,480
<font color="#E5E5E5">now is that these tags are should be</font>

187
00:08:21,480 --> 00:08:24,120
treated as HTML characters and should

188
00:08:24,120 --> 00:08:26,370
not<font color="#E5E5E5"> be</font><font color="#CCCCCC"> treated as part</font><font color="#E5E5E5"> of the code and</font>

189
00:08:26,370 --> 00:08:29,580
this<font color="#CCCCCC"> is</font><font color="#E5E5E5"> all thanks to a function that's</font>

190
00:08:29,580 --> 00:08:32,940
being used<font color="#E5E5E5"> here which is called the HTML</font>

191
00:08:32,940 --> 00:08:36,750
special<font color="#E5E5E5"> characters so it's all thanks to</font>

192
00:08:36,750 --> 00:08:38,640
this function<font color="#CCCCCC"> so whatever your input in</font>

193
00:08:38,640 --> 00:08:41,429
in the name<font color="#E5E5E5"> it's being filtered through</font>

194
00:08:41,429 --> 00:08:43,740
<font color="#E5E5E5">this</font><font color="#CCCCCC"> function</font><font color="#E5E5E5"> now this function will</font>

195
00:08:43,740 --> 00:08:45,870
<font color="#CCCCCC">iterate over each character</font><font color="#E5E5E5"> that you</font>

196
00:08:45,870 --> 00:08:48,690
entered and it'll<font color="#E5E5E5"> tell</font><font color="#CCCCCC"> Hastie ml or the</font>

197
00:08:48,690 --> 00:08:50,490
browser<font color="#CCCCCC"> it'll</font><font color="#E5E5E5"> change it to its</font>

198
00:08:50,490 --> 00:08:53,400
<font color="#E5E5E5">equivalent in HTML code therefore the</font>

199
00:08:53,400 --> 00:08:55,740
browser will know that this<font color="#E5E5E5"> is</font><font color="#CCCCCC"> not part</font>

200
00:08:55,740 --> 00:08:58,380
of the code and this<font color="#CCCCCC"> is part of what</font>

201
00:08:58,380 --> 00:09:00,780
<font color="#E5E5E5">should be displayed on screen as text</font>

202
00:09:00,780 --> 00:09:03,750
<font color="#E5E5E5">and this way no matter what you try to</font>

203
00:09:03,750 --> 00:09:06,540
inject it will be<font color="#E5E5E5"> converted to</font><font color="#CCCCCC"> HTML code</font>

204
00:09:06,540 --> 00:09:08,910
<font color="#E5E5E5">which will just be displayed on screen</font>

205
00:09:08,910 --> 00:09:13,460
<font color="#E5E5E5">like normal text or normal characters</font>

206
00:09:14,290 --> 00:09:17,439
now as a user<font color="#E5E5E5"> to prevent yourself from</font>

207
00:09:17,439 --> 00:09:20,889
being used<font color="#CCCCCC"> into an XSS attack</font><font color="#E5E5E5"> now the</font>

208
00:09:20,889 --> 00:09:23,019
URL coming to you will probably<font color="#E5E5E5"> look</font>

209
00:09:23,019 --> 00:09:25,540
like<font color="#E5E5E5"> a</font><font color="#CCCCCC"> URL</font><font color="#E5E5E5"> of a trusted</font><font color="#CCCCCC"> website for</font>

210
00:09:25,540 --> 00:09:27,819
example<font color="#E5E5E5"> let's assume</font><font color="#CCCCCC"> that you work in</font><font color="#E5E5E5"> a</font>

211
00:09:27,819 --> 00:09:30,549
<font color="#CCCCCC">company and there it was</font><font color="#E5E5E5"> an XSS in your</font>

212
00:09:30,549 --> 00:09:32,169
company and you<font color="#CCCCCC"> were logging</font><font color="#E5E5E5"> into your</font>

213
00:09:32,169 --> 00:09:34,569
company<font color="#E5E5E5"> and the code gets executed on</font>

214
00:09:34,569 --> 00:09:36,459
you then there isn't<font color="#E5E5E5"> much</font><font color="#CCCCCC"> you can</font><font color="#E5E5E5"> do</font>

215
00:09:36,459 --> 00:09:38,979
<font color="#CCCCCC">yourself</font><font color="#E5E5E5"> but you need to be careful so</font>

216
00:09:38,979 --> 00:09:41,379
with beef we<font color="#CCCCCC"> saw</font><font color="#E5E5E5"> in order to exploit the</font>

217
00:09:41,379 --> 00:09:43,029
vulnerabilities we were showing<font color="#E5E5E5"> for</font>

218
00:09:43,029 --> 00:09:45,549
example<font color="#CCCCCC"> a fake</font><font color="#E5E5E5"> update so make sure when</font>

219
00:09:45,549 --> 00:09:47,439
<font color="#E5E5E5">you if you get an if you get a message</font>

220
00:09:47,439 --> 00:09:49,689
<font color="#E5E5E5">always that there is an update</font><font color="#CCCCCC"> make sure</font>

221
00:09:49,689 --> 00:09:51,999
you actually<font color="#E5E5E5"> go to the website that</font>

222
00:09:51,999 --> 00:09:54,789
<font color="#E5E5E5">provides did that application so Firefox</font>

223
00:09:54,789 --> 00:09:56,589
said that<font color="#E5E5E5"> there</font><font color="#CCCCCC"> is an</font><font color="#E5E5E5"> update go to the</font>

224
00:09:56,589 --> 00:09:58,929
<font color="#CCCCCC">fate to the website</font><font color="#E5E5E5"> a face of Firefox</font>

225
00:09:58,929 --> 00:10:01,149
<font color="#E5E5E5">and see if there is actually an update</font>

226
00:10:01,149 --> 00:10:03,699
and if there is download it from that

227
00:10:03,699 --> 00:10:05,679
website<font color="#E5E5E5"> don't download it from the</font>

228
00:10:05,679 --> 00:10:08,169
notification<font color="#CCCCCC"> that you got also make sure</font>

229
00:10:08,169 --> 00:10:10,389
<font color="#CCCCCC">you're downloading it</font><font color="#E5E5E5"> from an HTTPS</font>

230
00:10:10,389 --> 00:10:13,299
website<font color="#E5E5E5"> and once you download</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> can</font>

231
00:10:13,299 --> 00:10:15,729
inspect it and check it<font color="#E5E5E5"> the same way</font>

232
00:10:15,729 --> 00:10:17,739
<font color="#E5E5E5">that</font><font color="#CCCCCC"> we seen before to make</font><font color="#E5E5E5"> sure that</font>

233
00:10:17,739 --> 00:10:20,160
there is no back doors<font color="#E5E5E5"> or anything</font><font color="#CCCCCC"> in it</font>

234
00:10:20,160 --> 00:10:23,619
<font color="#E5E5E5">it can</font><font color="#CCCCCC"> also check the</font><font color="#E5E5E5"> md5 sum to make</font>

235
00:10:23,619 --> 00:10:24,819
sure that the file hasn't<font color="#E5E5E5"> been</font>

236
00:10:24,819 --> 00:10:26,679
manipulated while it was being

237
00:10:26,679 --> 00:10:29,230
downloaded<font color="#E5E5E5"> the same one we</font><font color="#CCCCCC"> did the fake</font>

238
00:10:29,230 --> 00:10:32,709
facebook<font color="#E5E5E5"> login when you</font><font color="#CCCCCC"> are with beef so</font>

239
00:10:32,709 --> 00:10:35,410
what you can do is whenever<font color="#E5E5E5"> you're told</font>

240
00:10:35,410 --> 00:10:37,359
that<font color="#E5E5E5"> you got logged out</font><font color="#CCCCCC"> and please log</font>

241
00:10:37,359 --> 00:10:39,850
back in<font color="#CCCCCC"> again ignore</font><font color="#E5E5E5"> that go to</font>

242
00:10:39,850 --> 00:10:41,980
facebook.com<font color="#CCCCCC"> make sure it's going</font>

243
00:10:41,980 --> 00:10:46,829
<font color="#E5E5E5">through HTTPS and then</font><font color="#CCCCCC"> login to</font><font color="#E5E5E5"> Facebook</font>

244
00:10:46,880 --> 00:10:49,790
so always try<font color="#CCCCCC"> to be careful</font><font color="#E5E5E5"> with</font>

245
00:10:49,790 --> 00:10:52,069
notifications popping up telling you you

246
00:10:52,069 --> 00:10:54,290
need<font color="#CCCCCC"> to do stuff</font><font color="#E5E5E5"> always be</font><font color="#CCCCCC"> wary and</font>

247
00:10:54,290 --> 00:10:57,069
never trust them

248
00:10:58,200 --> 00:11:00,390
in this<font color="#E5E5E5"> lecture we're going to learn how</font>

249
00:11:00,390 --> 00:11:03,270
<font color="#CCCCCC">to bypass other authentication by</font>

250
00:11:03,270 --> 00:11:06,260
manipulating cookie values

251
00:11:06,260 --> 00:11:08,360
now this doesn't<font color="#E5E5E5"> always happen</font><font color="#CCCCCC"> and it's</font>

252
00:11:08,360 --> 00:11:10,460
<font color="#E5E5E5">not always possible but it's possible</font>

253
00:11:10,460 --> 00:11:12,290
when<font color="#E5E5E5"> the session management</font><font color="#CCCCCC"> is</font>

254
00:11:12,290 --> 00:11:14,810
programmed in a way that can easily be

255
00:11:14,810 --> 00:11:16,940
<font color="#E5E5E5">bypassed and I'll talk</font><font color="#CCCCCC"> more about that</font>

256
00:11:16,940 --> 00:11:19,370
<font color="#E5E5E5">once we actually do the attack but</font>

257
00:11:19,370 --> 00:11:21,470
before<font color="#E5E5E5"> we do anything we need</font><font color="#CCCCCC"> to have a</font>

258
00:11:21,470 --> 00:11:23,720
<font color="#CCCCCC">plugin that allow us to</font><font color="#E5E5E5"> modify</font><font color="#CCCCCC"> our</font>

259
00:11:23,720 --> 00:11:26,060
cookies<font color="#E5E5E5"> so the first thing that</font><font color="#CCCCCC"> I'm</font>

260
00:11:26,060 --> 00:11:29,070
gonna do is go on<font color="#E5E5E5"> Google</font>

261
00:11:29,070 --> 00:11:34,070
and look for cookie editor

262
00:11:34,110 --> 00:11:36,890
Firefox

263
00:11:36,890 --> 00:11:39,260
and I'm gonna download cookie<font color="#CCCCCC"> manager</font>

264
00:11:39,260 --> 00:11:41,630
plus all they have to do is just<font color="#E5E5E5"> click</font>

265
00:11:41,630 --> 00:11:47,230
on the link to<font color="#E5E5E5"> Firefox and install</font>

266
00:11:47,230 --> 00:11:49,120
and it's going<font color="#E5E5E5"> to ask you to</font><font color="#CCCCCC"> restart so</font>

267
00:11:49,120 --> 00:11:52,050
<font color="#CCCCCC">I'm going</font><font color="#E5E5E5"> to restart it</font>

268
00:11:52,420 --> 00:11:57,100
and it should<font color="#E5E5E5"> be installed now now the</font>

269
00:11:57,100 --> 00:11:59,200
cookies<font color="#CCCCCC"> are used to authenticate</font><font color="#E5E5E5"> users</font>

270
00:11:59,200 --> 00:12:03,339
<font color="#CCCCCC">after they login</font><font color="#E5E5E5"> so for example once you</font>

271
00:12:03,339 --> 00:12:06,820
go in here<font color="#E5E5E5"> and</font><font color="#CCCCCC"> log in I've already</font>

272
00:12:06,820 --> 00:12:08,680
created an account<font color="#E5E5E5"> on this you can</font>

273
00:12:08,680 --> 00:12:10,120
<font color="#CCCCCC">create one</font><font color="#E5E5E5"> by just</font><font color="#CCCCCC"> clicking on</font><font color="#E5E5E5"> the</font>

274
00:12:10,120 --> 00:12:12,310
<font color="#CCCCCC">register here</font><font color="#E5E5E5"> and the account that</font><font color="#CCCCCC"> I</font>

275
00:12:12,310 --> 00:12:15,760
<font color="#CCCCCC">created</font><font color="#E5E5E5"> the username is 8 and the</font>

276
00:12:15,760 --> 00:12:19,360
password is 1 2 3<font color="#CCCCCC"> 4 5 6</font>

277
00:12:19,360 --> 00:12:21,790
now once I log in here<font color="#E5E5E5"> you'll</font><font color="#CCCCCC"> notice</font>

278
00:12:21,790 --> 00:12:23,829
<font color="#CCCCCC">that every time I</font><font color="#E5E5E5"> go to a different page</font>

279
00:12:23,829 --> 00:12:26,170
<font color="#CCCCCC">I don't have to</font><font color="#E5E5E5"> log in again so every</font>

280
00:12:26,170 --> 00:12:28,089
time I<font color="#E5E5E5"> just browse</font><font color="#CCCCCC"> through this website</font>

281
00:12:28,089 --> 00:12:30,910
<font color="#E5E5E5">you'll</font><font color="#CCCCCC"> see</font><font color="#E5E5E5"> that I</font><font color="#CCCCCC"> don't get</font><font color="#E5E5E5"> presented to</font>

282
00:12:30,910 --> 00:12:33,519
log in again and everywhere I go it

283
00:12:33,519 --> 00:12:36,309
knows that<font color="#E5E5E5"> I'm logged in as</font><font color="#CCCCCC"> eight now</font>

284
00:12:36,309 --> 00:12:39,220
this is<font color="#E5E5E5"> possible based on cookies so</font>

285
00:12:39,220 --> 00:12:41,799
every<font color="#E5E5E5"> time I go to this website or to</font>

286
00:12:41,799 --> 00:12:43,959
these pages<font color="#CCCCCC"> they know that Zeta is</font>

287
00:12:43,959 --> 00:12:45,970
trying<font color="#E5E5E5"> to get in here because the</font>

288
00:12:45,970 --> 00:12:48,429
cookies are<font color="#E5E5E5"> stored in my browser</font><font color="#CCCCCC"> and</font>

289
00:12:48,429 --> 00:12:50,860
every time I request something<font color="#CCCCCC"> from this</font>

290
00:12:50,860 --> 00:12:53,379
<font color="#CCCCCC">website the cookies</font><font color="#E5E5E5"> are sent to that</font>

291
00:12:53,379 --> 00:12:56,439
<font color="#E5E5E5">webpage and</font><font color="#CCCCCC"> Stellan it that</font><font color="#E5E5E5"> they it has</font>

292
00:12:56,439 --> 00:12:58,749
<font color="#E5E5E5">already authenticated himself and he is</font>

293
00:12:58,749 --> 00:13:01,420
just<font color="#E5E5E5"> trying to display this website so</font>

294
00:13:01,420 --> 00:13:04,269
<font color="#E5E5E5">even if I</font><font color="#CCCCCC"> close this</font><font color="#E5E5E5"> and so I'm just</font>

295
00:13:04,269 --> 00:13:05,860
<font color="#E5E5E5">gonna close me till the day and just get</font>

296
00:13:05,860 --> 00:13:08,610
back to it again

297
00:13:11,850 --> 00:13:14,160
you'll see that I'm still<font color="#CCCCCC"> logged in as</font>

298
00:13:14,160 --> 00:13:17,850
<font color="#E5E5E5">eight now cookies have a date of expiry</font>

299
00:13:17,850 --> 00:13:20,700
<font color="#E5E5E5">and they'll expire after a while</font>

300
00:13:20,700 --> 00:13:23,490
sometimes the cookies are configured in

301
00:13:23,490 --> 00:13:25,110
<font color="#E5E5E5">a way that they can be</font><font color="#CCCCCC"> easily</font>

302
00:13:25,110 --> 00:13:28,050
manipulated<font color="#CCCCCC"> so let's have a look on the</font>

303
00:13:28,050 --> 00:13:30,240
cookies for this<font color="#E5E5E5"> website</font><font color="#CCCCCC"> now if we go</font>

304
00:13:30,240 --> 00:13:32,370
I'm<font color="#E5E5E5"> gonna click on alt to display the</font>

305
00:13:32,370 --> 00:13:34,860
menus here<font color="#E5E5E5"> and then I'm gonna go</font><font color="#CCCCCC"> on</font>

306
00:13:34,860 --> 00:13:38,850
<font color="#E5E5E5">tools cookie</font><font color="#CCCCCC"> manager</font><font color="#E5E5E5"> plus and I'm gonna</font>

307
00:13:38,850 --> 00:13:40,860
search for<font color="#CCCCCC"> the name of this website</font>

308
00:13:40,860 --> 00:13:44,040
which is 10 2014 to 12 and that will

309
00:13:44,040 --> 00:13:46,260
display<font color="#E5E5E5"> all the cookies that</font><font color="#CCCCCC"> have</font><font color="#E5E5E5"> been</font>

310
00:13:46,260 --> 00:13:49,290
sent<font color="#E5E5E5"> so</font><font color="#CCCCCC"> you can see that the PHP SSID</font>

311
00:13:49,290 --> 00:13:52,770
<font color="#E5E5E5">and all these cookies</font><font color="#CCCCCC"> you can see that</font>

312
00:13:52,770 --> 00:13:54,630
there is<font color="#E5E5E5"> an</font><font color="#CCCCCC"> two interesting cookies one</font>

313
00:13:54,630 --> 00:13:57,000
of them is called<font color="#E5E5E5"> user name and the</font>

314
00:13:57,000 --> 00:14:01,040
<font color="#E5E5E5">other one is called user ID or UID</font>

315
00:14:01,040 --> 00:14:03,380
so this is really<font color="#E5E5E5"> interesting</font><font color="#CCCCCC"> and if we</font>

316
00:14:03,380 --> 00:14:05,630
click<font color="#E5E5E5"> on edit</font>

317
00:14:05,630 --> 00:14:08,090
you'll see that we<font color="#E5E5E5"> have the name of</font><font color="#CCCCCC"> the</font>

318
00:14:08,090 --> 00:14:11,690
<font color="#CCCCCC">cookie is</font><font color="#E5E5E5"> UID or user ID and the</font><font color="#CCCCCC"> content</font>

319
00:14:11,690 --> 00:14:15,680
is 17 so you can try<font color="#E5E5E5"> to guess that means</font>

320
00:14:15,680 --> 00:14:18,350
<font color="#CCCCCC">that this</font><font color="#E5E5E5"> cookie is</font><font color="#CCCCCC"> telling this</font><font color="#E5E5E5"> page</font>

321
00:14:18,350 --> 00:14:22,040
that the user ID<font color="#E5E5E5"> of the person</font><font color="#CCCCCC"> who's</font>

322
00:14:22,040 --> 00:14:25,400
trying<font color="#CCCCCC"> to visit</font><font color="#E5E5E5"> this page is 17 so we</font>

323
00:14:25,400 --> 00:14:27,740
can guess that<font color="#E5E5E5"> the user ID for</font><font color="#CCCCCC"> Zaid for</font>

324
00:14:27,740 --> 00:14:31,760
the user<font color="#E5E5E5"> that</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> just created is 17 so</font>

325
00:14:31,760 --> 00:14:33,980
what we can do is we can try to<font color="#E5E5E5"> modify</font>

326
00:14:33,980 --> 00:14:36,320
this to a<font color="#E5E5E5"> different value and see what</font>

327
00:14:36,320 --> 00:14:39,290
happens and often admin users are

328
00:14:39,290 --> 00:14:42,710
created first<font color="#CCCCCC"> at at every website</font><font color="#E5E5E5"> so we</font>

329
00:14:42,710 --> 00:14:45,440
<font color="#E5E5E5">can try to go for one so I'm just going</font>

330
00:14:45,440 --> 00:14:47,210
to delete<font color="#E5E5E5"> the 7 and I'm going to keep it</font>

331
00:14:47,210 --> 00:14:49,340
as<font color="#CCCCCC"> 1 and then we're gonna save the</font>

332
00:14:49,340 --> 00:14:51,470
cookies like<font color="#E5E5E5"> this</font>

333
00:14:51,470 --> 00:14:54,019
<font color="#E5E5E5">I'm going to close that</font>

334
00:14:54,019 --> 00:14:55,730
and then I'm<font color="#CCCCCC"> just going to refresh</font><font color="#E5E5E5"> the</font>

335
00:14:55,730 --> 00:14:57,910
<font color="#CCCCCC">page</font>

336
00:14:58,010 --> 00:14:59,990
and now you can see that I've actually

337
00:14:59,990 --> 00:15:02,960
I'm logged in as admin and I can browse

338
00:15:02,960 --> 00:15:05,270
the<font color="#E5E5E5"> website</font><font color="#CCCCCC"> and do anything</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> the</font>

339
00:15:05,270 --> 00:15:07,700
<font color="#CCCCCC">admins are allowed</font><font color="#E5E5E5"> to do and we managed</font>

340
00:15:07,700 --> 00:15:10,040
<font color="#CCCCCC">to do this very simply by modifying our</font>

341
00:15:10,040 --> 00:15:12,890
cookies and changing our user ID to<font color="#E5E5E5"> user</font>

342
00:15:12,890 --> 00:15:16,460
ID<font color="#CCCCCC"> number one so this was possible</font>

343
00:15:16,460 --> 00:15:18,950
<font color="#E5E5E5">because the cookies</font><font color="#CCCCCC"> that are</font><font color="#E5E5E5"> used are</font>

344
00:15:18,950 --> 00:15:19,730
very<font color="#E5E5E5"> simple</font>

345
00:15:19,730 --> 00:15:23,270
now<font color="#E5E5E5"> cookies should be more complicated</font>

346
00:15:23,270 --> 00:15:25,970
<font color="#E5E5E5">so</font><font color="#CCCCCC"> they should actually use</font><font color="#E5E5E5"> what's known</font>

347
00:15:25,970 --> 00:15:29,870
<font color="#CCCCCC">as session IDs or tokens</font><font color="#E5E5E5"> these</font><font color="#CCCCCC"> tokens</font>

348
00:15:29,870 --> 00:15:32,480
should be very complicated<font color="#E5E5E5"> and not</font>

349
00:15:32,480 --> 00:15:35,750
relate to<font color="#CCCCCC"> the user ID</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> way I</font>

350
00:15:35,750 --> 00:15:38,000
wouldn't be<font color="#E5E5E5"> able to know what</font><font color="#CCCCCC"> the user</font>

351
00:15:38,000 --> 00:15:39,980
ID even<font color="#E5E5E5"> if I know that the admin has</font><font color="#CCCCCC"> a</font>

352
00:15:39,980 --> 00:15:42,200
user ID<font color="#CCCCCC"> of</font><font color="#E5E5E5"> one</font><font color="#CCCCCC"> I wouldn't be able</font><font color="#E5E5E5"> to</font>

353
00:15:42,200 --> 00:15:45,770
<font color="#CCCCCC">know</font><font color="#E5E5E5"> what token that</font><font color="#CCCCCC"> admin is using so</font>

354
00:15:45,770 --> 00:15:48,200
they should be dynamically generated

355
00:15:48,200 --> 00:15:51,380
based on each user<font color="#E5E5E5"> and they should vary</font>

356
00:15:51,380 --> 00:15:53,600
from time to time so even<font color="#E5E5E5"> for the same</font>

357
00:15:53,600 --> 00:15:56,090
user<font color="#CCCCCC"> every time he logs in they</font><font color="#E5E5E5"> should</font>

358
00:15:56,090 --> 00:15:59,030
get different token randomly based on

359
00:15:59,030 --> 00:16:01,100
some parameters so that<font color="#CCCCCC"> it's very</font>

360
00:16:01,100 --> 00:16:05,030
difficult<font color="#E5E5E5"> for anybody to know what token</font>

361
00:16:05,030 --> 00:16:08,480
<font color="#E5E5E5">each user gets otherwise it'll be very</font>

362
00:16:08,480 --> 00:16:11,240
easily<font color="#E5E5E5"> for people to guess what token</font>

363
00:16:11,240 --> 00:16:13,640
the add mirror<font color="#E5E5E5"> or any other user has and</font>

364
00:16:13,640 --> 00:16:16,490
just<font color="#E5E5E5"> injected into their browser now</font>

365
00:16:16,490 --> 00:16:18,920
using complicated tokens and session IDs

366
00:16:18,920 --> 00:16:20,900
is<font color="#CCCCCC"> still one vulnerable for</font>

367
00:16:20,900 --> 00:16:23,120
<font color="#E5E5E5">man-in-the-middle attacks and we see</font>

368
00:16:23,120 --> 00:16:24,950
that in plugins like<font color="#CCCCCC"> Firesheep</font>

369
00:16:24,950 --> 00:16:27,860
and in programs<font color="#E5E5E5"> like ferret and hamster</font>

370
00:16:27,860 --> 00:16:29,750
where I actually explained that in my

371
00:16:29,750 --> 00:16:31,970
network penetration testing course where

372
00:16:31,970 --> 00:16:33,890
you could gain access<font color="#E5E5E5"> to any user</font>

373
00:16:33,890 --> 00:16:36,650
account<font color="#E5E5E5"> as long as the people</font><font color="#CCCCCC"> are on the</font>

374
00:16:36,650 --> 00:16:38,690
same<font color="#CCCCCC"> network as you so even if the token</font>

375
00:16:38,690 --> 00:16:40,940
<font color="#E5E5E5">is really complicated</font><font color="#CCCCCC"> you'll be able to</font>

376
00:16:40,940 --> 00:16:43,100
capture that<font color="#E5E5E5"> token and then inject it</font>

377
00:16:43,100 --> 00:16:45,200
into the<font color="#E5E5E5"> browser</font><font color="#CCCCCC"> but</font><font color="#E5E5E5"> the main idea</font><font color="#CCCCCC"> is</font>

378
00:16:45,200 --> 00:16:47,420
<font color="#CCCCCC">the website is</font><font color="#E5E5E5"> not vulnerable because</font>

379
00:16:47,420 --> 00:16:49,250
<font color="#CCCCCC">you can't guess it yourself here you</font>

380
00:16:49,250 --> 00:16:51,560
have to actually<font color="#CCCCCC"> capture that</font><font color="#E5E5E5"> token from</font>

381
00:16:51,560 --> 00:16:53,720
another person and then<font color="#E5E5E5"> inject it</font>

382
00:16:53,720 --> 00:16:55,790
whereas in here we were able<font color="#E5E5E5"> to just</font>

383
00:16:55,790 --> 00:16:58,100
<font color="#CCCCCC">know or guess that the admin has an idea</font>

384
00:16:58,100 --> 00:17:02,860
of one injected and then login<font color="#CCCCCC"> as admin</font>

385
00:17:02,860 --> 00:17:05,839
in this<font color="#E5E5E5"> lecture we're going</font><font color="#CCCCCC"> to have a</font>

386
00:17:05,839 --> 00:17:08,209
look on<font color="#E5E5E5"> CSRF or cross-site request</font>

387
00:17:08,209 --> 00:17:11,900
forgery<font color="#E5E5E5"> these vulnerabilities allow us</font>

388
00:17:11,900 --> 00:17:14,480
to force a user<font color="#E5E5E5"> to do things that they</font>

389
00:17:14,480 --> 00:17:16,760
don't<font color="#CCCCCC"> want to</font><font color="#E5E5E5"> do for example once</font><font color="#CCCCCC"> you</font>

390
00:17:16,760 --> 00:17:18,560
log<font color="#E5E5E5"> into a website let's take</font><font color="#CCCCCC"> facebook</font>

391
00:17:18,560 --> 00:17:20,810
you'll be able<font color="#E5E5E5"> to do certain things to</font>

392
00:17:20,810 --> 00:17:22,760
your profile so you can upload<font color="#CCCCCC"> pictures</font>

393
00:17:22,760 --> 00:17:24,589
<font color="#E5E5E5">you can change your password you can</font>

394
00:17:24,589 --> 00:17:26,449
<font color="#E5E5E5">change your information</font><font color="#CCCCCC"> send messages</font>

395
00:17:26,449 --> 00:17:30,110
and post stuff to your wall<font color="#E5E5E5"> now CSRF</font>

396
00:17:30,110 --> 00:17:33,020
occurs when the<font color="#CCCCCC"> website doesn't validate</font>

397
00:17:33,020 --> 00:17:35,510
if the user<font color="#E5E5E5"> actually wants</font><font color="#CCCCCC"> to do the</font>

398
00:17:35,510 --> 00:17:37,430
certain<font color="#E5E5E5"> task so it doesn't check if the</font>

399
00:17:37,430 --> 00:17:40,190
user actually<font color="#E5E5E5"> intends to change their</font>

400
00:17:40,190 --> 00:17:42,050
profile picture<font color="#E5E5E5"> or to change their</font>

401
00:17:42,050 --> 00:17:44,390
password<font color="#E5E5E5"> so if the website</font><font color="#CCCCCC"> doesn't do</font>

402
00:17:44,390 --> 00:17:46,880
that<font color="#E5E5E5"> we'll be able to program</font><font color="#CCCCCC"> an HTML</font>

403
00:17:46,880 --> 00:17:49,520
page<font color="#CCCCCC"> and if the</font><font color="#E5E5E5"> user clicks it or runs</font>

404
00:17:49,520 --> 00:17:51,680
it they'll<font color="#E5E5E5"> be forced to</font><font color="#CCCCCC"> carry</font><font color="#E5E5E5"> out a</font>

405
00:17:51,680 --> 00:17:54,200
<font color="#E5E5E5">certain task</font><font color="#CCCCCC"> that we program it</font><font color="#E5E5E5"> to do</font>

406
00:17:54,200 --> 00:17:55,730
for example<font color="#E5E5E5"> we can get the user to</font>

407
00:17:55,730 --> 00:17:58,130
change their password<font color="#E5E5E5"> without them even</font>

408
00:17:58,130 --> 00:18:00,830
knowing<font color="#E5E5E5"> let's have an</font><font color="#CCCCCC"> example on how</font>

409
00:18:00,830 --> 00:18:03,350
<font color="#E5E5E5">this happens</font><font color="#CCCCCC"> and it will</font><font color="#E5E5E5"> become</font><font color="#CCCCCC"> more</font>

410
00:18:03,350 --> 00:18:06,950
<font color="#CCCCCC">clear to</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> so I have my dvwa here</font><font color="#E5E5E5"> and</font>

411
00:18:06,950 --> 00:18:08,480
I'm<font color="#E5E5E5"> just going</font><font color="#CCCCCC"> to log in with my</font>

412
00:18:08,480 --> 00:18:11,450
<font color="#E5E5E5">username and password which</font><font color="#CCCCCC"> is admin</font>

413
00:18:11,450 --> 00:18:15,580
and I'm gonna put my<font color="#CCCCCC"> password</font>

414
00:18:17,000 --> 00:18:20,830
now if we go<font color="#E5E5E5"> to the</font><font color="#CCCCCC"> CRS F tab here</font>

415
00:18:20,830 --> 00:18:23,510
you'll see that<font color="#CCCCCC"> it allows us to</font><font color="#E5E5E5"> change</font>

416
00:18:23,510 --> 00:18:26,179
our our password so this is<font color="#E5E5E5"> just like a</font>

417
00:18:26,179 --> 00:18:28,610
normal<font color="#E5E5E5"> control panel to a normal website</font>

418
00:18:28,610 --> 00:18:30,320
<font color="#CCCCCC">and usually when you log into</font><font color="#E5E5E5"> your</font>

419
00:18:30,320 --> 00:18:32,090
<font color="#E5E5E5">account one of the features that you</font><font color="#CCCCCC"> can</font>

420
00:18:32,090 --> 00:18:34,070
do is you can<font color="#CCCCCC"> change</font><font color="#E5E5E5"> your password</font><font color="#CCCCCC"> to a</font>

421
00:18:34,070 --> 00:18:35,840
different password<font color="#CCCCCC"> so from</font><font color="#E5E5E5"> here I'm</font>

422
00:18:35,840 --> 00:18:38,000
<font color="#E5E5E5">gonna set my</font><font color="#CCCCCC"> password to two two two two</font>

423
00:18:38,000 --> 00:18:41,299
two two<font color="#CCCCCC"> and I'll set it</font><font color="#E5E5E5"> in</font><font color="#CCCCCC"> here as well</font>

424
00:18:41,299 --> 00:18:43,490
the same<font color="#E5E5E5"> password I'm gonna hit enter</font>

425
00:18:43,490 --> 00:18:45,740
<font color="#CCCCCC">and as you</font><font color="#E5E5E5"> can</font><font color="#CCCCCC"> see it's telling us</font><font color="#E5E5E5"> that</font>

426
00:18:45,740 --> 00:18:48,980
<font color="#CCCCCC">the password</font><font color="#E5E5E5"> has been changed so this is</font>

427
00:18:48,980 --> 00:18:51,169
an example<font color="#E5E5E5"> of a feature that the user</font>

428
00:18:51,169 --> 00:18:53,419
can do to their account<font color="#E5E5E5"> they can change</font>

429
00:18:53,419 --> 00:18:55,640
their password if the target website

430
00:18:55,640 --> 00:18:58,610
<font color="#E5E5E5">which is</font><font color="#CCCCCC"> dvwa doesn't check if the user</font>

431
00:18:58,610 --> 00:19:01,159
<font color="#CCCCCC">actually wants to do this task</font><font color="#E5E5E5"> then we</font>

432
00:19:01,159 --> 00:19:03,530
can<font color="#E5E5E5"> create a page that is similar to</font>

433
00:19:03,530 --> 00:19:06,350
<font color="#CCCCCC">this page and once the user runs that</font>

434
00:19:06,350 --> 00:19:08,360
page they'll actually<font color="#E5E5E5"> change their</font>

435
00:19:08,360 --> 00:19:11,120
password<font color="#E5E5E5"> without them even knowing now</font>

436
00:19:11,120 --> 00:19:12,860
there's a number<font color="#E5E5E5"> of</font><font color="#CCCCCC"> ways to analyze</font><font color="#E5E5E5"> the</font>

437
00:19:12,860 --> 00:19:14,780
connection and<font color="#CCCCCC"> analyze the information</font>

438
00:19:14,780 --> 00:19:17,330
sent<font color="#CCCCCC"> between the client and</font><font color="#E5E5E5"> the target</font>

439
00:19:17,330 --> 00:19:19,940
to make that<font color="#E5E5E5"> CSRF exploit</font><font color="#CCCCCC"> I'm going to</font>

440
00:19:19,940 --> 00:19:21,740
show<font color="#E5E5E5"> you the easiest and most</font><font color="#CCCCCC"> reliable</font>

441
00:19:21,740 --> 00:19:23,809
way and it works regardless<font color="#E5E5E5"> of the type</font>

442
00:19:23,809 --> 00:19:27,080
<font color="#CCCCCC">of form whether it's post or get so with</font>

443
00:19:27,080 --> 00:19:28,490
this<font color="#CCCCCC"> particular</font><font color="#E5E5E5"> one it's actually</font><font color="#CCCCCC"> really</font>

444
00:19:28,490 --> 00:19:30,289
easy to<font color="#E5E5E5"> exploit if you just send the URL</font>

445
00:19:30,289 --> 00:19:32,690
<font color="#E5E5E5">right</font><font color="#CCCCCC"> here to the target user</font><font color="#E5E5E5"> and then</font>

446
00:19:32,690 --> 00:19:33,950
if they run<font color="#CCCCCC"> it their password will be</font>

447
00:19:33,950 --> 00:19:36,289
<font color="#CCCCCC">changed but in more complicated ways</font>

448
00:19:36,289 --> 00:19:38,179
sometimes<font color="#E5E5E5"> you don't see that sometimes</font>

449
00:19:38,179 --> 00:19:40,820
post is used<font color="#E5E5E5"> so I'll show you the most</font>

450
00:19:40,820 --> 00:19:42,710
<font color="#E5E5E5">reliable way</font><font color="#CCCCCC"> to do this</font><font color="#E5E5E5"> kind of attack</font>

451
00:19:42,710 --> 00:19:44,929
<font color="#E5E5E5">so the first thing to do is right-click</font>

452
00:19:44,929 --> 00:19:47,750
the form<font color="#E5E5E5"> that you want to</font><font color="#CCCCCC"> hijack you</font>

453
00:19:47,750 --> 00:19:50,650
were going to inspect<font color="#CCCCCC"> the element</font><font color="#E5E5E5"> and</font>

454
00:19:50,650 --> 00:19:53,960
we're going<font color="#E5E5E5"> to look</font><font color="#CCCCCC"> to at where the</font><font color="#E5E5E5"> form</font>

455
00:19:53,960 --> 00:19:55,850
is so we're going<font color="#E5E5E5"> to look at where is</font>

456
00:19:55,850 --> 00:19:58,880
the start of<font color="#E5E5E5"> the form tag and the end of</font>

457
00:19:58,880 --> 00:20:00,960
the form tag

458
00:20:00,960 --> 00:20:02,789
I'm actually going<font color="#E5E5E5"> to right-click it in</font>

459
00:20:02,789 --> 00:20:05,809
here inside the<font color="#CCCCCC"> form</font>

460
00:20:06,279 --> 00:20:08,200
and as you can<font color="#E5E5E5"> see now we have the start</font>

461
00:20:08,200 --> 00:20:12,340
<font color="#E5E5E5">of the form is</font><font color="#CCCCCC"> in here</font><font color="#E5E5E5"> and it ends</font><font color="#CCCCCC"> with</font>

462
00:20:12,340 --> 00:20:14,739
with a slash form forward slash form and

463
00:20:14,739 --> 00:20:18,190
you can<font color="#E5E5E5"> see it right</font><font color="#CCCCCC"> here at</font><font color="#E5E5E5"> the end so</font>

464
00:20:18,190 --> 00:20:20,229
this is the part of the code<font color="#CCCCCC"> that were</font>

465
00:20:20,229 --> 00:20:22,330
interested<font color="#E5E5E5"> in</font><font color="#CCCCCC"> - this is the part</font><font color="#E5E5E5"> of the</font>

466
00:20:22,330 --> 00:20:26,529
code that<font color="#CCCCCC"> we want</font><font color="#E5E5E5"> to modify and send to</font>

467
00:20:26,529 --> 00:20:28,419
<font color="#E5E5E5">the target user so</font><font color="#CCCCCC"> that when they run it</font>

468
00:20:28,419 --> 00:20:30,369
<font color="#E5E5E5">they'll actually change their password</font>

469
00:20:30,369 --> 00:20:31,590
without them knowing

470
00:20:31,590 --> 00:20:34,479
so I'm<font color="#E5E5E5"> going to right click this and I'm</font>

471
00:20:34,479 --> 00:20:37,840
<font color="#E5E5E5">gonna add it as HTML</font><font color="#CCCCCC"> and I'm gonna</font><font color="#E5E5E5"> copy</font>

472
00:20:37,840 --> 00:20:39,489
everything inside<font color="#CCCCCC"> here so I'm going to</font>

473
00:20:39,489 --> 00:20:44,289
do<font color="#E5E5E5"> ctrl a ctrl C and that's copied for</font>

474
00:20:44,289 --> 00:20:46,469
me

475
00:20:46,520 --> 00:20:48,590
and then<font color="#E5E5E5"> I'm going to go to my</font><font color="#CCCCCC"> leaf</font><font color="#E5E5E5"> pad</font>

476
00:20:48,590 --> 00:20:52,710
right<font color="#CCCCCC"> here and I'm gonna paste it</font>

477
00:20:52,710 --> 00:20:54,929
and I'm<font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> save this and we'll call</font>

478
00:20:54,929 --> 00:20:58,640
<font color="#E5E5E5">it CSRF dot</font><font color="#CCCCCC"> html'</font>

479
00:21:02,140 --> 00:21:05,140
and I'll put this<font color="#CCCCCC"> in</font><font color="#E5E5E5"> the desktop and</font>

480
00:21:05,140 --> 00:21:09,370
click on<font color="#CCCCCC"> save and that's</font><font color="#E5E5E5"> it</font><font color="#CCCCCC"> save now if</font>

481
00:21:09,370 --> 00:21:12,160
we let's just run this code<font color="#E5E5E5"> at the start</font>

482
00:21:12,160 --> 00:21:14,950
<font color="#E5E5E5">and see what we get so I have it right</font>

483
00:21:14,950 --> 00:21:16,950
<font color="#E5E5E5">here</font><font color="#CCCCCC"> on</font><font color="#E5E5E5"> my desktop</font>

484
00:21:16,950 --> 00:21:18,630
and I'm just going<font color="#E5E5E5"> to double</font><font color="#CCCCCC"> click</font><font color="#E5E5E5"> it</font>

485
00:21:18,630 --> 00:21:21,900
<font color="#E5E5E5">and as</font><font color="#CCCCCC"> you can see you</font><font color="#E5E5E5"> just get a page a</font>

486
00:21:21,900 --> 00:21:23,760
normal page that<font color="#CCCCCC"> asks you for a new</font>

487
00:21:23,760 --> 00:21:25,380
password<font color="#CCCCCC"> and a comfort to confirm the</font>

488
00:21:25,380 --> 00:21:27,900
password<font color="#E5E5E5"> so</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> can see the form here is</font>

489
00:21:27,900 --> 00:21:29,850
actually similar<font color="#E5E5E5"> to</font><font color="#CCCCCC"> the form</font><font color="#E5E5E5"> that we</font>

490
00:21:29,850 --> 00:21:32,090
want<font color="#E5E5E5"> to hijack</font>

491
00:21:32,090 --> 00:21:35,060
now to get<font color="#CCCCCC"> that page to work we</font><font color="#E5E5E5"> need to</font>

492
00:21:35,060 --> 00:21:37,310
<font color="#E5E5E5">modify a few things now you can see here</font>

493
00:21:37,310 --> 00:21:40,220
we<font color="#E5E5E5"> have a</font><font color="#CCCCCC"> forum right</font><font color="#E5E5E5"> here and the</font>

494
00:21:40,220 --> 00:21:42,620
action<font color="#E5E5E5"> is set to a hashtag so it</font>

495
00:21:42,620 --> 00:21:45,020
actually<font color="#CCCCCC"> doesn't give a website to</font>

496
00:21:45,020 --> 00:21:47,480
submit<font color="#E5E5E5"> this form</font><font color="#CCCCCC"> to so the first thing</font>

497
00:21:47,480 --> 00:21:48,920
you want to<font color="#CCCCCC"> modify is you want us to</font>

498
00:21:48,920 --> 00:21:50,630
<font color="#E5E5E5">give it to the website</font><font color="#CCCCCC"> to submit</font><font color="#E5E5E5"> this</font>

499
00:21:50,630 --> 00:21:52,910
form<font color="#E5E5E5"> to and this is going to be the same</font>

500
00:21:52,910 --> 00:21:54,920
website<font color="#CCCCCC"> that we're on at the moment</font><font color="#E5E5E5"> so</font>

501
00:21:54,920 --> 00:21:58,730
I'm<font color="#CCCCCC"> gonna ctrl copy this and I'm gonna</font>

502
00:21:58,730 --> 00:22:02,470
put it in<font color="#CCCCCC"> here instead of the</font><font color="#E5E5E5"> hashtag</font>

503
00:22:02,680 --> 00:22:04,870
now sometimes you'll actually<font color="#E5E5E5"> if you're</font>

504
00:22:04,870 --> 00:22:06,400
copying a form<font color="#E5E5E5"> from a</font><font color="#CCCCCC"> different website</font>

505
00:22:06,400 --> 00:22:09,220
<font color="#CCCCCC">you might</font><font color="#E5E5E5"> actually see a name of a file</font>

506
00:22:09,220 --> 00:22:11,410
so you'll just<font color="#CCCCCC"> see a file</font><font color="#E5E5E5"> name</font><font color="#CCCCCC"> you want</font>

507
00:22:11,410 --> 00:22:13,690
to<font color="#E5E5E5"> make sure you have the full URL to</font>

508
00:22:13,690 --> 00:22:16,450
the to the form<font color="#E5E5E5"> because if you just have</font>

509
00:22:16,450 --> 00:22:18,160
<font color="#CCCCCC">a file name for example if you</font><font color="#E5E5E5"> just have</font>

510
00:22:18,160 --> 00:22:20,710
index dot PHP<font color="#CCCCCC"> it won't know</font><font color="#E5E5E5"> whether that</font>

511
00:22:20,710 --> 00:22:23,320
index dot PHP is it now it when it's on

512
00:22:23,320 --> 00:22:25,420
<font color="#CCCCCC">the website</font><font color="#E5E5E5"> because</font><font color="#CCCCCC"> it's already</font><font color="#E5E5E5"> stored</font>

513
00:22:25,420 --> 00:22:27,250
on that<font color="#E5E5E5"> website but when we're actually</font>

514
00:22:27,250 --> 00:22:29,350
taking<font color="#E5E5E5"> the file like this and storing it</font>

515
00:22:29,350 --> 00:22:31,330
on our local<font color="#E5E5E5"> machine</font><font color="#CCCCCC"> you want</font><font color="#E5E5E5"> to make</font>

516
00:22:31,330 --> 00:22:33,730
<font color="#CCCCCC">sure you have the full URL in here so</font>

517
00:22:33,730 --> 00:22:35,320
<font color="#E5E5E5">even if</font><font color="#CCCCCC"> you seen</font><font color="#E5E5E5"> something instead</font><font color="#CCCCCC"> of</font>

518
00:22:35,320 --> 00:22:36,880
the hash tag<font color="#E5E5E5"> if you seen something</font><font color="#CCCCCC"> like</font>

519
00:22:36,880 --> 00:22:39,790
index dot PHP or whatever<font color="#CCCCCC"> keep that in</font>

520
00:22:39,790 --> 00:22:41,740
there<font color="#E5E5E5"> but make sure you give</font><font color="#CCCCCC"> it the full</font>

521
00:22:41,740 --> 00:22:45,670
URL<font color="#E5E5E5"> that comes before</font><font color="#CCCCCC"> that page</font>

522
00:22:45,670 --> 00:22:48,440
so this is all good now if I save<font color="#CCCCCC"> this</font>

523
00:22:48,440 --> 00:22:50,809
and if we<font color="#CCCCCC"> run this</font><font color="#E5E5E5"> we'll actually be</font>

524
00:22:50,809 --> 00:22:53,360
<font color="#E5E5E5">able</font><font color="#CCCCCC"> to change the password</font><font color="#E5E5E5"> using this</font>

525
00:22:53,360 --> 00:22:55,970
form now the<font color="#E5E5E5"> beautiful</font><font color="#CCCCCC"> thing about</font><font color="#E5E5E5"> these</font>

526
00:22:55,970 --> 00:22:58,340
<font color="#E5E5E5">exploits you can actually confirm that</font>

527
00:22:58,340 --> 00:23:00,410
it works for<font color="#E5E5E5"> you first and then</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> can</font>

528
00:23:00,410 --> 00:23:02,000
send it to<font color="#CCCCCC"> the target client or the</font>

529
00:23:02,000 --> 00:23:05,809
<font color="#E5E5E5">target person so if we</font><font color="#CCCCCC"> actually reset</font>

530
00:23:05,809 --> 00:23:07,190
our password here so I'm going<font color="#CCCCCC"> to set</font>

531
00:23:07,190 --> 00:23:12,150
the password<font color="#E5E5E5"> to 3 3 3 3 3 3</font>

532
00:23:12,150 --> 00:23:16,070
and confirm it<font color="#E5E5E5"> in here</font>

533
00:23:17,090 --> 00:23:20,630
I'm gonna do hit enter you'll see that

534
00:23:20,630 --> 00:23:22,070
we<font color="#E5E5E5"> get a message</font><font color="#CCCCCC"> telling us that the</font>

535
00:23:22,070 --> 00:23:24,080
password has<font color="#CCCCCC"> been changed and we</font><font color="#E5E5E5"> can</font>

536
00:23:24,080 --> 00:23:26,090
actually<font color="#E5E5E5"> now log out and</font><font color="#CCCCCC"> login with the</font>

537
00:23:26,090 --> 00:23:28,670
new password<font color="#E5E5E5"> so this is good now we have</font>

538
00:23:28,670 --> 00:23:30,470
a form that's actually not stored on the

539
00:23:30,470 --> 00:23:33,680
<font color="#E5E5E5">website but using it we can actually go</font>

540
00:23:33,680 --> 00:23:35,420
<font color="#E5E5E5">to that website and change the password</font>

541
00:23:35,420 --> 00:23:38,270
<font color="#CCCCCC">so this</font><font color="#E5E5E5"> actually confirms that the</font>

542
00:23:38,270 --> 00:23:41,180
target<font color="#E5E5E5"> website</font><font color="#CCCCCC"> is vulnerable to</font><font color="#E5E5E5"> CSRF</font>

543
00:23:41,180 --> 00:23:43,460
<font color="#E5E5E5">because it's not validating that the</font>

544
00:23:43,460 --> 00:23:45,260
request is<font color="#E5E5E5"> coming from the website</font>

545
00:23:45,260 --> 00:23:47,540
itself so it's not validating if the

546
00:23:47,540 --> 00:23:51,350
user actually<font color="#CCCCCC"> wants to do that</font><font color="#E5E5E5"> now the</font>

547
00:23:51,350 --> 00:23:53,600
<font color="#CCCCCC">webpage</font><font color="#E5E5E5"> that we made so far is not very</font>

548
00:23:53,600 --> 00:23:55,550
good<font color="#E5E5E5"> because</font><font color="#CCCCCC"> it still asks the user to</font>

549
00:23:55,550 --> 00:23:57,230
<font color="#E5E5E5">change their username and password and</font>

550
00:23:57,230 --> 00:23:59,330
these are still<font color="#E5E5E5"> pics what's username and</font>

551
00:23:59,330 --> 00:24:01,730
password they want to use so<font color="#E5E5E5"> now we're</font>

552
00:24:01,730 --> 00:24:03,560
<font color="#E5E5E5">going to modify our code one</font><font color="#CCCCCC"> more time</font>

553
00:24:03,560 --> 00:24:06,320
<font color="#E5E5E5">and with this time we're actually going</font>

554
00:24:06,320 --> 00:24:08,960
to<font color="#E5E5E5"> make everything invisible and we're</font>

555
00:24:08,960 --> 00:24:10,700
going<font color="#E5E5E5"> to make this code to be submitted</font>

556
00:24:10,700 --> 00:24:12,980
automatically once the<font color="#E5E5E5"> user</font><font color="#CCCCCC"> browse</font><font color="#E5E5E5"> the</font>

557
00:24:12,980 --> 00:24:15,470
page<font color="#E5E5E5"> so the first thing to</font><font color="#CCCCCC"> make</font>

558
00:24:15,470 --> 00:24:18,620
everything hidden<font color="#CCCCCC"> we're going to convert</font>

559
00:24:18,620 --> 00:24:21,260
all the inputs<font color="#E5E5E5"> and we're going to add to</font>

560
00:24:21,260 --> 00:24:24,170
them<font color="#E5E5E5"> type equals hidden so you can see</font>

561
00:24:24,170 --> 00:24:26,210
we have an input<font color="#CCCCCC"> here</font><font color="#E5E5E5"> and I'm</font><font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> add</font>

562
00:24:26,210 --> 00:24:30,820
an argument saying<font color="#E5E5E5"> type equals hidden</font>

563
00:24:30,870 --> 00:24:33,600
I'm also going to add to this<font color="#CCCCCC"> input</font>

564
00:24:33,600 --> 00:24:35,250
right here which is<font color="#CCCCCC"> the input that</font>

565
00:24:35,250 --> 00:24:37,800
confirms the password<font color="#E5E5E5"> so we're going to</font>

566
00:24:37,800 --> 00:24:40,840
set that<font color="#CCCCCC"> to hidden as well</font>

567
00:24:40,840 --> 00:24:43,809
and we're gonna change the last<font color="#E5E5E5"> input</font>

568
00:24:43,809 --> 00:24:45,700
<font color="#E5E5E5">which submits the code as</font><font color="#CCCCCC"> you can see</font>

569
00:24:45,700 --> 00:24:47,470
here it's<font color="#E5E5E5"> called change we're gonna</font>

570
00:24:47,470 --> 00:24:49,330
change that to<font color="#CCCCCC"> hidden as well so the</font>

571
00:24:49,330 --> 00:24:51,370
user<font color="#E5E5E5"> won't see this</font><font color="#CCCCCC"> input either this</font><font color="#E5E5E5"> is</font>

572
00:24:51,370 --> 00:24:53,880
<font color="#E5E5E5">the submit button</font>

573
00:24:55,370 --> 00:24:57,260
and I'm gonna remove everything<font color="#CCCCCC"> written</font>

574
00:24:57,260 --> 00:24:58,850
on the page<font color="#CCCCCC"> so you can see that in here</font>

575
00:24:58,850 --> 00:25:00,740
<font color="#E5E5E5">it says</font><font color="#CCCCCC"> confirmed</font><font color="#E5E5E5"> password so I'm going</font>

576
00:25:00,740 --> 00:25:02,720
<font color="#E5E5E5">to remove that</font>

577
00:25:02,720 --> 00:25:05,510
and we can see<font color="#E5E5E5"> that in here it also asks</font>

578
00:25:05,510 --> 00:25:07,010
for<font color="#E5E5E5"> the new password so I'm going to</font>

579
00:25:07,010 --> 00:25:08,299
<font color="#E5E5E5">remove</font><font color="#CCCCCC"> this part as well</font>

580
00:25:08,299 --> 00:25:12,350
and I'm<font color="#E5E5E5"> going</font><font color="#CCCCCC"> to remove this tag</font>

581
00:25:12,350 --> 00:25:14,990
and now I have my<font color="#CCCCCC"> three inputs and I</font>

582
00:25:14,990 --> 00:25:17,090
have my<font color="#E5E5E5"> form</font><font color="#CCCCCC"> so I only have the</font>

583
00:25:17,090 --> 00:25:20,750
important<font color="#E5E5E5"> part of the code so</font><font color="#CCCCCC"> we have</font>

584
00:25:20,750 --> 00:25:23,389
our first input<font color="#E5E5E5"> and it's set hidden this</font>

585
00:25:23,389 --> 00:25:25,009
is the first input<font color="#E5E5E5"> that the user puts</font>

586
00:25:25,009 --> 00:25:28,429
the password in and we have the second

587
00:25:28,429 --> 00:25:31,340
input right here which is<font color="#CCCCCC"> the confirm</font>

588
00:25:31,340 --> 00:25:33,860
<font color="#CCCCCC">password</font><font color="#E5E5E5"> and then we have the submit</font>

589
00:25:33,860 --> 00:25:36,559
button<font color="#E5E5E5"> now we're going to remove the</font>

590
00:25:36,559 --> 00:25:38,659
types<font color="#E5E5E5"> from here from the input from the</font>

591
00:25:38,659 --> 00:25:42,049
password input<font color="#E5E5E5"> and instead of that we're</font>

592
00:25:42,049 --> 00:25:43,759
<font color="#E5E5E5">going to add a value so we're actually</font>

593
00:25:43,759 --> 00:25:45,320
going<font color="#E5E5E5"> to set the</font><font color="#CCCCCC"> value for the new</font>

594
00:25:45,320 --> 00:25:46,970
<font color="#E5E5E5">password</font>

595
00:25:46,970 --> 00:25:49,789
and this time we're gonna set<font color="#E5E5E5"> it to six</font>

596
00:25:49,789 --> 00:25:52,580
sixes so one<font color="#E5E5E5"> two three one two</font><font color="#CCCCCC"> three</font><font color="#E5E5E5"> and</font>

597
00:25:52,580 --> 00:25:55,419
I'm gonna do the<font color="#E5E5E5"> same with</font><font color="#CCCCCC"> the confirm</font>

598
00:25:55,419 --> 00:25:59,120
with<font color="#CCCCCC"> the confirm password</font><font color="#E5E5E5"> input so we're</font>

599
00:25:59,120 --> 00:26:02,750
gonna set its value to six six six six

600
00:26:02,750 --> 00:26:04,730
six six because<font color="#E5E5E5"> we've already changed</font>

601
00:26:04,730 --> 00:26:08,120
<font color="#E5E5E5">the type to hidden and</font><font color="#CCCCCC"> I misspelled type</font>

602
00:26:08,120 --> 00:26:12,020
in here so I'm gonna save this and I'll

603
00:26:12,020 --> 00:26:14,960
<font color="#E5E5E5">just open this in my</font><font color="#CCCCCC"> browser</font><font color="#E5E5E5"> just to see</font>

604
00:26:14,960 --> 00:26:18,530
what this website<font color="#E5E5E5"> looks like now now as</font>

605
00:26:18,530 --> 00:26:20,799
you<font color="#E5E5E5"> can</font><font color="#CCCCCC"> see the page is actually</font><font color="#E5E5E5"> empty</font>

606
00:26:20,799 --> 00:26:23,929
<font color="#E5E5E5">but if we view</font><font color="#CCCCCC"> the source you'll see</font>

607
00:26:23,929 --> 00:26:27,560
that we still have our firms

608
00:26:27,560 --> 00:26:30,080
so you can see I'm<font color="#CCCCCC"> just gonna zoom on</font>

609
00:26:30,080 --> 00:26:34,100
this you can<font color="#CCCCCC"> see that</font><font color="#E5E5E5"> still submitting</font>

610
00:26:34,100 --> 00:26:37,130
the form<font color="#E5E5E5"> to</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> right place</font><font color="#CCCCCC"> it has the</font>

611
00:26:37,130 --> 00:26:39,830
<font color="#E5E5E5">input which</font><font color="#CCCCCC"> is set to hidden and then</font><font color="#E5E5E5"> it</font>

612
00:26:39,830 --> 00:26:41,870
has the new password<font color="#E5E5E5"> the value is set to</font>

613
00:26:41,870 --> 00:26:45,140
<font color="#E5E5E5">six sixes we also have the confirmed</font>

614
00:26:45,140 --> 00:26:47,330
<font color="#CCCCCC">password it's also</font><font color="#E5E5E5"> set to hidden and the</font>

615
00:26:47,330 --> 00:26:50,810
value<font color="#E5E5E5"> is six sixes and we have our</font><font color="#CCCCCC"> input</font>

616
00:26:50,810 --> 00:26:53,480
<font color="#E5E5E5">the one that changes everything and this</font>

617
00:26:53,480 --> 00:26:56,120
one is set to hidden as well<font color="#E5E5E5"> so all this</font>

618
00:26:56,120 --> 00:26:58,190
good<font color="#E5E5E5"> now the last thing we want</font><font color="#CCCCCC"> to do is</font>

619
00:26:58,190 --> 00:27:00,320
we want this to be executed

620
00:27:00,320 --> 00:27:02,240
<font color="#E5E5E5">automatically when the user double</font>

621
00:27:02,240 --> 00:27:03,650
clicks the file so we don't want the

622
00:27:03,650 --> 00:27:06,020
user<font color="#CCCCCC"> to hit anything we even made our</font>

623
00:27:06,020 --> 00:27:08,150
input the submit button we made it

624
00:27:08,150 --> 00:27:09,980
hidden<font color="#E5E5E5"> so we want the user as soon as</font>

625
00:27:09,980 --> 00:27:11,750
<font color="#CCCCCC">they run this file</font><font color="#E5E5E5"> they get redirected</font>

626
00:27:11,750 --> 00:27:14,150
<font color="#CCCCCC">to the page that will change their</font>

627
00:27:14,150 --> 00:27:17,930
password to do that<font color="#E5E5E5"> we're gonna you need</font>

628
00:27:17,930 --> 00:27:20,540
to use a<font color="#E5E5E5"> JavaScript code that will</font>

629
00:27:20,540 --> 00:27:22,880
automatically submit<font color="#E5E5E5"> this form so once</font>

630
00:27:22,880 --> 00:27:24,650
the page loads<font color="#E5E5E5"> it will automatically</font>

631
00:27:24,650 --> 00:27:27,590
submit<font color="#CCCCCC"> this form so the first thing we</font>

632
00:27:27,590 --> 00:27:29,540
need to do we're<font color="#CCCCCC"> going to</font><font color="#E5E5E5"> need to set an</font>

633
00:27:29,540 --> 00:27:32,240
ID for this forms so<font color="#CCCCCC"> that JavaScript can</font>

634
00:27:32,240 --> 00:27:34,760
identify this<font color="#E5E5E5"> form so I'm gonna give it</font>

635
00:27:34,760 --> 00:27:38,360
<font color="#E5E5E5">an ID and I'm gonna set that</font><font color="#CCCCCC"> to let's</font>

636
00:27:38,360 --> 00:27:41,220
say form<font color="#CCCCCC"> one</font>

637
00:27:41,220 --> 00:27:43,710
and I'm gonna place the<font color="#E5E5E5"> JavaScript code</font>

638
00:27:43,710 --> 00:27:46,110
in<font color="#CCCCCC"> here and to do that we're going</font><font color="#E5E5E5"> to</font>

639
00:27:46,110 --> 00:27:48,299
<font color="#E5E5E5">need to put it between two JavaScript</font>

640
00:27:48,299 --> 00:27:50,610
tags<font color="#E5E5E5"> so we're gonna start with the</font>

641
00:27:50,610 --> 00:27:53,250
script<font color="#E5E5E5"> and we need to close</font><font color="#CCCCCC"> that tag as</font>

642
00:27:53,250 --> 00:27:57,650
well so it's a<font color="#E5E5E5"> slash script</font>

643
00:27:58,010 --> 00:28:00,050
<font color="#E5E5E5">then we're going</font><font color="#CCCCCC"> to do document</font><font color="#E5E5E5"> to</font>

644
00:28:00,050 --> 00:28:03,100
access the<font color="#CCCCCC"> current document</font>

645
00:28:03,570 --> 00:28:07,109
dot get element by ID<font color="#CCCCCC"> so we can access</font>

646
00:28:07,109 --> 00:28:09,690
the form that we<font color="#E5E5E5"> just created and we</font>

647
00:28:09,690 --> 00:28:12,590
called it form<font color="#CCCCCC"> one</font>

648
00:28:13,059 --> 00:28:15,309
<font color="#E5E5E5">then we're going</font><font color="#CCCCCC"> to place the idea that</font>

649
00:28:15,309 --> 00:28:17,740
<font color="#E5E5E5">we just created and we called it form</font>

650
00:28:17,740 --> 00:28:20,139
one right here<font color="#E5E5E5"> so we're gonna change</font>

651
00:28:20,139 --> 00:28:24,280
that<font color="#E5E5E5"> to here so we can say form one</font>

652
00:28:24,280 --> 00:28:26,590
so the code so far will access the

653
00:28:26,590 --> 00:28:28,390
current<font color="#E5E5E5"> document</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> it's</font><font color="#CCCCCC"> going to look</font>

654
00:28:28,390 --> 00:28:31,000
for an element<font color="#E5E5E5"> that has</font><font color="#CCCCCC"> the ID of</font><font color="#E5E5E5"> number</font>

655
00:28:31,000 --> 00:28:33,310
one then we're going to tell it<font color="#E5E5E5"> what we</font>

656
00:28:33,310 --> 00:28:35,020
want<font color="#E5E5E5"> to do with that element with</font><font color="#CCCCCC"> that</font>

657
00:28:35,020 --> 00:28:36,760
form<font color="#E5E5E5"> and we're going to want it to</font>

658
00:28:36,760 --> 00:28:40,649
submit so we're<font color="#E5E5E5"> going to say dot submit</font>

659
00:28:40,649 --> 00:28:43,209
so the code is<font color="#E5E5E5"> very simple</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> just added</font>

660
00:28:43,209 --> 00:28:45,309
an ID to the current form<font color="#CCCCCC"> we called it</font>

661
00:28:45,309 --> 00:28:47,919
form<font color="#CCCCCC"> one and then we added</font><font color="#E5E5E5"> a JavaScript</font>

662
00:28:47,919 --> 00:28:50,889
code<font color="#CCCCCC"> starting with a script</font><font color="#E5E5E5"> and ending</font>

663
00:28:50,889 --> 00:28:53,889
<font color="#CCCCCC">with a forward slash script</font><font color="#E5E5E5"> and we said</font>

664
00:28:53,889 --> 00:28:56,649
the document<font color="#E5E5E5"> and we want you to</font><font color="#CCCCCC"> get the</font>

665
00:28:56,649 --> 00:28:59,529
<font color="#E5E5E5">element by ID we want you to get form</font>

666
00:28:59,529 --> 00:29:02,039
<font color="#CCCCCC">one and we want you</font><font color="#E5E5E5"> to submit it</font>

667
00:29:02,039 --> 00:29:04,749
now once the user<font color="#E5E5E5"> double clicks this</font>

668
00:29:04,749 --> 00:29:06,999
file the file will<font color="#CCCCCC"> be executed</font>

669
00:29:06,999 --> 00:29:09,309
<font color="#E5E5E5">automatically without</font><font color="#CCCCCC"> the user having to</font>

670
00:29:09,309 --> 00:29:12,190
<font color="#E5E5E5">do anything so let's see this in action</font>

671
00:29:12,190 --> 00:29:15,460
I'm gonna come now I'm<font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> close this</font>

672
00:29:15,460 --> 00:29:17,530
and I'm going to<font color="#E5E5E5"> close this one as well</font>

673
00:29:17,530 --> 00:29:20,920
<font color="#E5E5E5">and I'm just going to</font><font color="#CCCCCC"> double click my</font>

674
00:29:20,920 --> 00:29:23,430
new file right<font color="#CCCCCC"> here</font>

675
00:29:23,430 --> 00:29:26,040
and as you can<font color="#E5E5E5"> see automatically</font><font color="#CCCCCC"> I got a</font>

676
00:29:26,040 --> 00:29:28,500
new page and this page is<font color="#E5E5E5"> telling me</font>

677
00:29:28,500 --> 00:29:31,380
that<font color="#CCCCCC"> the password have been changed</font><font color="#E5E5E5"> so</font>

678
00:29:31,380 --> 00:29:33,420
the user didn't click anything<font color="#CCCCCC"> the user</font>

679
00:29:33,420 --> 00:29:36,150
<font color="#E5E5E5">didn't put any password and the page was</font>

680
00:29:36,150 --> 00:29:39,510
executed from<font color="#E5E5E5"> a place that's not on the</font>

681
00:29:39,510 --> 00:29:41,700
same web server so it was<font color="#E5E5E5"> executed from</font>

682
00:29:41,700 --> 00:29:44,010
the local machine<font color="#CCCCCC"> but still</font><font color="#E5E5E5"> it submitted</font>

683
00:29:44,010 --> 00:29:46,440
the<font color="#CCCCCC"> information the website</font><font color="#E5E5E5"> accepted the</font>

684
00:29:46,440 --> 00:29:48,780
information<font color="#E5E5E5"> and the website</font><font color="#CCCCCC"> changed my</font>

685
00:29:48,780 --> 00:29:51,030
password<font color="#CCCCCC"> to the new password so my</font>

686
00:29:51,030 --> 00:29:53,070
password now<font color="#CCCCCC"> the admin password have</font>

687
00:29:53,070 --> 00:29:59,840
been changed<font color="#E5E5E5"> to 666 666 so if I log out</font>

688
00:30:00,080 --> 00:30:02,210
and try to<font color="#CCCCCC"> login</font><font color="#E5E5E5"> I'm gonna put my</font>

689
00:30:02,210 --> 00:30:04,429
username as admin and the password to

690
00:30:04,429 --> 00:30:08,899
666 666<font color="#CCCCCC"> hit enter</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> you'll</font><font color="#E5E5E5"> see that I</font>

691
00:30:08,899 --> 00:30:11,450
logged in<font color="#E5E5E5"> with the new password instead</font>

692
00:30:11,450 --> 00:30:15,080
of my original<font color="#E5E5E5"> password now it's all up</font>

693
00:30:15,080 --> 00:30:17,539
to you and<font color="#CCCCCC"> how smart</font><font color="#E5E5E5"> you you are with</font>

694
00:30:17,539 --> 00:30:19,850
her with<font color="#E5E5E5"> tricking the targets with how</font>

695
00:30:19,850 --> 00:30:22,490
to<font color="#E5E5E5"> get them to run your file so now</font><font color="#CCCCCC"> it's</font>

696
00:30:22,490 --> 00:30:24,140
all<font color="#E5E5E5"> down to social</font><font color="#CCCCCC"> engineering how</font>

697
00:30:24,140 --> 00:30:25,429
you're going<font color="#E5E5E5"> to send it what you're</font>

698
00:30:25,429 --> 00:30:27,529
gonna pretend that<font color="#E5E5E5"> the file is going to</font>

699
00:30:27,529 --> 00:30:31,460
<font color="#CCCCCC">be one way is to send the file as it is</font>

700
00:30:31,460 --> 00:30:35,269
<font color="#E5E5E5">as HTML the other way is just</font><font color="#CCCCCC"> to host</font>

701
00:30:35,269 --> 00:30:38,779
the file on an<font color="#E5E5E5"> HTML web hosting so you</font>

702
00:30:38,779 --> 00:30:40,309
can<font color="#E5E5E5"> upload</font><font color="#CCCCCC"> it to</font><font color="#E5E5E5"> any web host think</font>

703
00:30:40,309 --> 00:30:42,649
there's a lot<font color="#E5E5E5"> of free ones and then you</font>

704
00:30:42,649 --> 00:30:44,120
can just<font color="#E5E5E5"> send the URL of the file</font>

705
00:30:44,120 --> 00:30:45,710
instead<font color="#CCCCCC"> of even getting the target</font>

706
00:30:45,710 --> 00:30:47,539
person<font color="#E5E5E5"> to download the file which will</font>

707
00:30:47,539 --> 00:30:51,289
<font color="#CCCCCC">be much less suspicious</font><font color="#E5E5E5"> in the previous</font>

708
00:30:51,289 --> 00:30:54,169
lecture we've seen how<font color="#CCCCCC"> to</font><font color="#E5E5E5"> create</font><font color="#CCCCCC"> a HTML</font>

709
00:30:54,169 --> 00:30:57,080
<font color="#CCCCCC">web</font><font color="#E5E5E5"> page that exploits a CSRF</font>

710
00:30:57,080 --> 00:30:59,330
vulnerability<font color="#E5E5E5"> that will automatically</font>

711
00:30:59,330 --> 00:31:01,669
submit<font color="#CCCCCC"> a form and</font><font color="#E5E5E5"> we see in how we can</font>

712
00:31:01,669 --> 00:31:04,490
exploit it<font color="#E5E5E5"> to get the target person to</font>

713
00:31:04,490 --> 00:31:06,409
change<font color="#E5E5E5"> their password without them even</font>

714
00:31:06,409 --> 00:31:08,330
<font color="#E5E5E5">knowing so as soon as they double-click</font>

715
00:31:08,330 --> 00:31:10,760
the file<font color="#E5E5E5"> this form will be automatically</font>

716
00:31:10,760 --> 00:31:12,740
submitted<font color="#E5E5E5"> changing the password to the</font>

717
00:31:12,740 --> 00:31:15,799
password<font color="#CCCCCC"> that we want one problem with</font>

718
00:31:15,799 --> 00:31:18,320
<font color="#E5E5E5">that is it's usually a bit difficult to</font>

719
00:31:18,320 --> 00:31:20,240
<font color="#E5E5E5">get</font><font color="#CCCCCC"> people to run files</font><font color="#E5E5E5"> even though it's</font>

720
00:31:20,240 --> 00:31:23,059
just<font color="#E5E5E5"> the HTML</font><font color="#CCCCCC"> file</font><font color="#E5E5E5"> and you can use smart</font>

721
00:31:23,059 --> 00:31:25,340
<font color="#E5E5E5">social engineering skills</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> get them to</font>

722
00:31:25,340 --> 00:31:28,250
run it<font color="#E5E5E5"> it's still a bit difficult</font><font color="#CCCCCC"> and it</font>

723
00:31:28,250 --> 00:31:30,500
will be much easier if<font color="#CCCCCC"> we can</font><font color="#E5E5E5"> just send</font>

724
00:31:30,500 --> 00:31:32,809
them a link which will<font color="#E5E5E5"> change their</font>

725
00:31:32,809 --> 00:31:34,549
password<font color="#CCCCCC"> as soon as they click on that</font>

726
00:31:34,549 --> 00:31:36,950
<font color="#CCCCCC">link</font><font color="#E5E5E5"> and this is actually really easy</font>

727
00:31:36,950 --> 00:31:39,500
<font color="#CCCCCC">because</font><font color="#E5E5E5"> the file we created</font><font color="#CCCCCC"> is a HTML</font>

728
00:31:39,500 --> 00:31:42,380
file<font color="#CCCCCC"> so all we have to do is just upload</font>

729
00:31:42,380 --> 00:31:44,480
<font color="#E5E5E5">that file to a web hosting company now</font>

730
00:31:44,480 --> 00:31:46,070
there is a lot<font color="#E5E5E5"> of free web</font><font color="#CCCCCC"> hosting</font>

731
00:31:46,070 --> 00:31:48,230
online<font color="#E5E5E5"> you can just upload</font><font color="#CCCCCC"> that file</font>

732
00:31:48,230 --> 00:31:50,299
there<font color="#E5E5E5"> you can use a URL shortening</font>

733
00:31:50,299 --> 00:31:52,490
service<font color="#CCCCCC"> as well to</font><font color="#E5E5E5"> make the URL shorter</font>

734
00:31:52,490 --> 00:31:54,409
and less suspicious and then you can

735
00:31:54,409 --> 00:31:56,809
send<font color="#E5E5E5"> it</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> the target</font><font color="#CCCCCC"> person so I'm</font>

736
00:31:56,809 --> 00:31:58,190
going<font color="#E5E5E5"> to show you how to do that but I'm</font>

737
00:31:58,190 --> 00:31:59,570
actually going<font color="#E5E5E5"> to do it on my local</font>

738
00:31:59,570 --> 00:32:01,220
machine<font color="#E5E5E5"> because everything for me here</font>

739
00:32:01,220 --> 00:32:03,679
is<font color="#CCCCCC"> local but it works</font><font color="#E5E5E5"> on the external</font>

740
00:32:03,679 --> 00:32:05,750
<font color="#CCCCCC">websites</font><font color="#E5E5E5"> exactly the same you'll just</font>

741
00:32:05,750 --> 00:32:08,809
have to upload<font color="#CCCCCC"> the HTML page on a web</font>

742
00:32:08,809 --> 00:32:10,669
hosting<font color="#E5E5E5"> doesn't matter if it's real free</font>

743
00:32:10,669 --> 00:32:12,620
or paid<font color="#E5E5E5"> but there is a lot of free ones</font>

744
00:32:12,620 --> 00:32:13,549
so I'm

745
00:32:13,549 --> 00:32:15,320
use my local<font color="#E5E5E5"> Apache server right here</font>

746
00:32:15,320 --> 00:32:17,659
<font color="#CCCCCC">and then we're going to browse it from</font>

747
00:32:17,659 --> 00:32:20,090
our<font color="#E5E5E5"> target Windows machine and we'll see</font>

748
00:32:20,090 --> 00:32:22,580
how that<font color="#CCCCCC"> is</font><font color="#E5E5E5"> going to be executed and how</font>

749
00:32:22,580 --> 00:32:24,860
the password is going<font color="#E5E5E5"> to</font><font color="#CCCCCC"> be changed</font><font color="#E5E5E5"> so</font>

750
00:32:24,860 --> 00:32:26,749
before I do anything I'm actually just

751
00:32:26,749 --> 00:32:28,549
going to reopen the<font color="#E5E5E5"> file and I'm gonna</font>

752
00:32:28,549 --> 00:32:30,320
set the<font color="#CCCCCC"> password to seven seven seven</font>

753
00:32:30,320 --> 00:32:33,110
seven seven seven<font color="#CCCCCC"> instead of</font><font color="#E5E5E5"> 666 so we</font>

754
00:32:33,110 --> 00:32:34,730
<font color="#E5E5E5">just know that the password has been</font>

755
00:32:34,730 --> 00:32:37,700
changed to the<font color="#E5E5E5"> new one and I'll change</font>

756
00:32:37,700 --> 00:32:41,059
it in here as well and now I'm<font color="#E5E5E5"> going to</font>

757
00:32:41,059 --> 00:32:43,309
copy this to my<font color="#E5E5E5"> local</font><font color="#CCCCCC"> web server and</font>

758
00:32:43,309 --> 00:32:47,419
<font color="#E5E5E5">Kali first of all I'm going to copy the</font>

759
00:32:47,419 --> 00:32:50,059
file<font color="#CCCCCC"> to my</font><font color="#E5E5E5"> document root so the file is</font>

760
00:32:50,059 --> 00:32:52,580
<font color="#CCCCCC">stored</font><font color="#E5E5E5"> in desktop</font><font color="#CCCCCC"> now so I'm going to</font><font color="#E5E5E5"> do</font>

761
00:32:52,580 --> 00:33:01,220
CP<font color="#CCCCCC"> desktop</font><font color="#E5E5E5"> CSRF</font><font color="#CCCCCC"> to var www HTML and now</font>

762
00:33:01,220 --> 00:33:03,049
I'm gonna<font color="#E5E5E5"> start my Apache so I'm gonna</font>

763
00:33:03,049 --> 00:33:07,720
do service<font color="#E5E5E5"> I</font><font color="#CCCCCC"> Pat you</font><font color="#E5E5E5"> to start</font>

764
00:33:08,570 --> 00:33:10,909
now<font color="#CCCCCC"> everything's working so I'm just</font>

765
00:33:10,909 --> 00:33:13,809
going<font color="#E5E5E5"> to get my IP address</font>

766
00:33:14,630 --> 00:33:19,100
and my IP address is<font color="#E5E5E5"> 10 2014</font><font color="#CCCCCC"> to 13</font><font color="#E5E5E5"> so</font>

767
00:33:19,100 --> 00:33:20,540
I'm just<font color="#E5E5E5"> going to go to a Windows</font>

768
00:33:20,540 --> 00:33:22,360
<font color="#E5E5E5">machine</font>

769
00:33:22,360 --> 00:33:24,320
now in this<font color="#E5E5E5"> machine I'm actually</font>

770
00:33:24,320 --> 00:33:27,679
pretending to be a target user so first

771
00:33:27,679 --> 00:33:29,600
of all<font color="#E5E5E5"> I have to be logged in to</font><font color="#CCCCCC"> my</font>

772
00:33:29,600 --> 00:33:32,889
<font color="#E5E5E5">account so I'm just going to go to dvwa</font>

773
00:33:32,889 --> 00:33:35,029
<font color="#E5E5E5">so I'm going to</font><font color="#CCCCCC"> log in</font><font color="#E5E5E5"> with my</font><font color="#CCCCCC"> username</font>

774
00:33:35,029 --> 00:33:37,909
which is admin and I'm going to<font color="#E5E5E5"> log in</font>

775
00:33:37,909 --> 00:33:40,519
<font color="#E5E5E5">with my old password which</font><font color="#CCCCCC"> is or - my</font>

776
00:33:40,519 --> 00:33:42,470
current<font color="#CCCCCC"> password the one that we reset</font>

777
00:33:42,470 --> 00:33:46,539
it<font color="#E5E5E5"> previously which is</font><font color="#CCCCCC"> six sixes</font>

778
00:33:46,539 --> 00:33:49,169
now as you can<font color="#CCCCCC"> see I can login</font><font color="#E5E5E5"> normally</font>

779
00:33:49,169 --> 00:33:53,920
now I'm<font color="#E5E5E5"> gonna go I'm</font><font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> close this</font>

780
00:33:53,920 --> 00:33:57,190
now we're<font color="#E5E5E5"> gonna browse to the page that</font>

781
00:33:57,190 --> 00:34:00,760
<font color="#CCCCCC">contains the forest</font><font color="#E5E5E5"> CSRF exploit so</font>

782
00:34:00,760 --> 00:34:03,580
we're gonna<font color="#E5E5E5"> pretend</font><font color="#CCCCCC"> that I was</font><font color="#E5E5E5"> social</font>

783
00:34:03,580 --> 00:34:06,010
<font color="#E5E5E5">engineered and someone gave</font><font color="#CCCCCC"> me a</font><font color="#E5E5E5"> URL to</font>

784
00:34:06,010 --> 00:34:07,720
<font color="#E5E5E5">click so at the moment we're actually</font>

785
00:34:07,720 --> 00:34:09,820
not<font color="#CCCCCC"> gonna download</font><font color="#E5E5E5"> any file we're not</font>

786
00:34:09,820 --> 00:34:11,739
gonna double-click any file<font color="#CCCCCC"> all we're</font>

787
00:34:11,739 --> 00:34:14,530
gonna do<font color="#CCCCCC"> is literally just browse a URL</font>

788
00:34:14,530 --> 00:34:16,960
<font color="#E5E5E5">and once we do that our password is</font>

789
00:34:16,960 --> 00:34:19,540
going<font color="#E5E5E5"> to</font><font color="#CCCCCC"> be changed</font><font color="#E5E5E5"> so the page as I</font>

790
00:34:19,540 --> 00:34:21,550
said you can host<font color="#E5E5E5"> it on free hosting</font>

791
00:34:21,550 --> 00:34:23,440
there's a lot of free hosting online<font color="#E5E5E5"> at</font>

792
00:34:23,440 --> 00:34:25,810
the moment<font color="#CCCCCC"> I have it hosted on my</font><font color="#E5E5E5"> Kali</font>

793
00:34:25,810 --> 00:34:32,960
machine and<font color="#CCCCCC"> its IP is 10 2014 to</font><font color="#E5E5E5"> 13</font>

794
00:34:32,960 --> 00:34:35,418
and then I'm gonna put my the name of

795
00:34:35,418 --> 00:34:37,489
the page which<font color="#E5E5E5"> you are set</font><font color="#CCCCCC"> to CSRF dot</font>

796
00:34:37,489 --> 00:34:40,148
<font color="#E5E5E5">HTML</font>

797
00:34:40,310 --> 00:34:43,000
I'm gonna hit<font color="#CCCCCC"> enter</font>

798
00:34:43,130 --> 00:34:45,350
and as you can<font color="#CCCCCC"> see it's</font><font color="#E5E5E5"> telling me</font><font color="#CCCCCC"> that</font>

799
00:34:45,350 --> 00:34:47,570
the password<font color="#E5E5E5"> has been changed</font><font color="#CCCCCC"> and all I</font>

800
00:34:47,570 --> 00:34:50,510
did<font color="#E5E5E5"> again all I did is</font><font color="#CCCCCC"> just run a URL</font><font color="#E5E5E5"> so</font>

801
00:34:50,510 --> 00:34:52,790
<font color="#CCCCCC">it's all</font><font color="#E5E5E5"> done to</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> to how you're gonna</font>

802
00:34:52,790 --> 00:34:55,570
convince<font color="#E5E5E5"> your target to execute that URL</font>

803
00:34:55,570 --> 00:34:58,970
<font color="#CCCCCC">so if I just log out now and</font><font color="#E5E5E5"> log in</font>

804
00:34:58,970 --> 00:35:02,240
again you see<font color="#CCCCCC"> that my password</font><font color="#E5E5E5"> now I</font>

805
00:35:02,240 --> 00:35:04,700
have to login with admin<font color="#E5E5E5"> and I'm</font>

806
00:35:04,700 --> 00:35:06,200
actually<font color="#E5E5E5"> going to type the</font><font color="#CCCCCC"> password here</font>

807
00:35:06,200 --> 00:35:08,150
so it's seven seven seven seven seven

808
00:35:08,150 --> 00:35:11,620
<font color="#CCCCCC">seven and I'm gonna copy all of this and</font>

809
00:35:11,620 --> 00:35:15,260
paste<font color="#E5E5E5"> it down there just so that you</font>

810
00:35:15,260 --> 00:35:16,640
actually know that<font color="#E5E5E5"> the password has been</font>

811
00:35:16,640 --> 00:35:18,410
changed to<font color="#E5E5E5"> seven seven seven seven</font>

812
00:35:18,410 --> 00:35:22,580
so the vulnerable URL was 10 2014<font color="#CCCCCC"> to</font>

813
00:35:22,580 --> 00:35:26,420
<font color="#CCCCCC">thirteen forward</font><font color="#E5E5E5"> slash</font><font color="#CCCCCC"> CSRF anybody who</font>

814
00:35:26,420 --> 00:35:29,750
would<font color="#E5E5E5"> run this URL and logged into the</font>

815
00:35:29,750 --> 00:35:32,240
target website<font color="#CCCCCC"> they'll be</font><font color="#E5E5E5"> forced</font><font color="#CCCCCC"> to</font>

816
00:35:32,240 --> 00:35:35,600
change<font color="#E5E5E5"> their password to 7 7 7 7 7 7</font>

817
00:35:35,600 --> 00:35:37,790
now you can use this method<font color="#CCCCCC"> as I said</font>

818
00:35:37,790 --> 00:35:40,490
with any website<font color="#CCCCCC"> that is vulnerable to a</font>

819
00:35:40,490 --> 00:35:44,150
<font color="#E5E5E5">CSRF and it'll force the user to do any</font>

820
00:35:44,150 --> 00:35:45,800
action you want<font color="#E5E5E5"> all you have to do is</font>

821
00:35:45,800 --> 00:35:47,930
just adopt the same method<font color="#CCCCCC"> to the form</font>

822
00:35:47,930 --> 00:35:50,060
<font color="#E5E5E5">so whether it's a payment form whether</font>

823
00:35:50,060 --> 00:35:52,400
it's<font color="#CCCCCC"> a signup form whether it's a submit</font>

824
00:35:52,400 --> 00:35:54,440
article form whether<font color="#CCCCCC"> it's a form that</font>

825
00:35:54,440 --> 00:35:56,780
<font color="#E5E5E5">sends a</font><font color="#CCCCCC"> message to a friend you can just</font>

826
00:35:56,780 --> 00:35:59,630
change the<font color="#E5E5E5"> website</font><font color="#CCCCCC"> right click</font><font color="#E5E5E5"> inspect</font>

827
00:35:59,630 --> 00:36:02,330
the form element<font color="#E5E5E5"> copy the form code hide</font>

828
00:36:02,330 --> 00:36:04,580
everything<font color="#E5E5E5"> did you have a script code</font>

829
00:36:04,580 --> 00:36:07,190
that submits the website<font color="#E5E5E5"> or that submits</font>

830
00:36:07,190 --> 00:36:09,650
the form automatically then you can send

831
00:36:09,650 --> 00:36:12,410
the web the HTML website<font color="#E5E5E5"> as it is to the</font>

832
00:36:12,410 --> 00:36:14,990
target<font color="#CCCCCC"> person or you can</font><font color="#E5E5E5"> upload it to</font><font color="#CCCCCC"> a</font>

833
00:36:14,990 --> 00:36:17,480
known online hosting and then just send

834
00:36:17,480 --> 00:36:19,880
the hosting URL to the target<font color="#CCCCCC"> person</font>

835
00:36:19,880 --> 00:36:22,370
once they browse that URL<font color="#E5E5E5"> the web page</font>

836
00:36:22,370 --> 00:36:25,010
will<font color="#CCCCCC"> be automatically executed</font><font color="#E5E5E5"> forcing</font>

837
00:36:25,010 --> 00:36:27,140
them<font color="#E5E5E5"> to</font><font color="#CCCCCC"> change their password or to do</font>

838
00:36:27,140 --> 00:36:30,680
the action that you want<font color="#E5E5E5"> them</font><font color="#CCCCCC"> to do</font>

839
00:36:30,680 --> 00:36:32,779
now that we<font color="#E5E5E5"> know how to discover and</font>

840
00:36:32,779 --> 00:36:35,869
exploit<font color="#E5E5E5"> CSRF vulnerabilities let's talk</font>

841
00:36:35,869 --> 00:36:39,069
about how<font color="#E5E5E5"> to protect websites from them</font>

842
00:36:39,069 --> 00:36:43,789
<font color="#E5E5E5">so if we just go back now to dvwa and</font>

843
00:36:43,789 --> 00:36:47,150
set the<font color="#CCCCCC"> security to</font><font color="#E5E5E5"> high you'll see that</font>

844
00:36:47,150 --> 00:36:50,059
they have<font color="#CCCCCC"> a very</font><font color="#E5E5E5"> simple way to protect</font>

845
00:36:50,059 --> 00:36:51,589
against it<font color="#E5E5E5"> but this way</font><font color="#CCCCCC"> actually works</font>

846
00:36:51,589 --> 00:36:54,259
<font color="#E5E5E5">and what they do is they ask you</font><font color="#CCCCCC"> for the</font>

847
00:36:54,259 --> 00:36:57,470
current password<font color="#CCCCCC"> so</font><font color="#E5E5E5"> even if we get this</font>

848
00:36:57,470 --> 00:36:59,749
form and<font color="#CCCCCC"> we do all the forging and all</font>

849
00:36:59,749 --> 00:37:01,099
the stuff that<font color="#CCCCCC"> we were doing it then</font>

850
00:37:01,099 --> 00:37:03,559
send it<font color="#CCCCCC"> to</font><font color="#E5E5E5"> the target person</font><font color="#CCCCCC"> we can't</font>

851
00:37:03,559 --> 00:37:04,999
actually<font color="#E5E5E5"> hide this and</font><font color="#CCCCCC"> get it to</font>

852
00:37:04,999 --> 00:37:07,309
automatically<font color="#CCCCCC"> submit because</font><font color="#E5E5E5"> we don't</font>

853
00:37:07,309 --> 00:37:09,499
know<font color="#CCCCCC"> the current password so it</font><font color="#E5E5E5"> asks for</font>

854
00:37:09,499 --> 00:37:11,630
<font color="#E5E5E5">the current password</font><font color="#CCCCCC"> and then it</font><font color="#E5E5E5"> allows</font>

855
00:37:11,630 --> 00:37:14,480
you<font color="#CCCCCC"> to add a</font><font color="#E5E5E5"> new password so this is a</font>

856
00:37:14,480 --> 00:37:16,460
really good<font color="#CCCCCC"> solution for</font><font color="#E5E5E5"> this case only</font>

857
00:37:16,460 --> 00:37:19,339
<font color="#CCCCCC">though because what</font><font color="#E5E5E5"> if the form actually</font>

858
00:37:19,339 --> 00:37:21,470
<font color="#E5E5E5">doesn't change a password what if we're</font>

859
00:37:21,470 --> 00:37:23,839
<font color="#E5E5E5">just going</font><font color="#CCCCCC"> to send messages</font><font color="#E5E5E5"> pretending</font>

860
00:37:23,839 --> 00:37:24,890
<font color="#E5E5E5">to be</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> person</font>

861
00:37:24,890 --> 00:37:27,109
what if we're gonna<font color="#E5E5E5"> post things to that</font>

862
00:37:27,109 --> 00:37:28,970
person's wall<font color="#CCCCCC"> what if we're gonna post</font>

863
00:37:28,970 --> 00:37:33,049
things into that person's blog so<font color="#E5E5E5"> CSRF</font>

864
00:37:33,049 --> 00:37:35,269
can be exploited<font color="#CCCCCC"> to do many things as I</font>

865
00:37:35,269 --> 00:37:37,579
said in<font color="#E5E5E5"> previous videos and this method</font>

866
00:37:37,579 --> 00:37:39,589
will<font color="#CCCCCC"> only protect against change in the</font>

867
00:37:39,589 --> 00:37:40,190
<font color="#E5E5E5">password</font>

868
00:37:40,190 --> 00:37:42,829
you can't really<font color="#CCCCCC"> ask</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> person for</font>

869
00:37:42,829 --> 00:37:44,660
their<font color="#CCCCCC"> password every time</font><font color="#E5E5E5"> that they</font><font color="#CCCCCC"> want</font>

870
00:37:44,660 --> 00:37:46,369
to<font color="#E5E5E5"> post something</font><font color="#CCCCCC"> or to do</font><font color="#E5E5E5"> something</font>

871
00:37:46,369 --> 00:37:48,700
with their profile

872
00:37:48,700 --> 00:37:51,400
now newer versions<font color="#E5E5E5"> of dvwa that don't</font>

873
00:37:51,400 --> 00:37:53,410
come with<font color="#CCCCCC"> Metasploit able to actually</font>

874
00:37:53,410 --> 00:37:56,200
<font color="#E5E5E5">have a more secure</font><font color="#CCCCCC"> option that will</font>

875
00:37:56,200 --> 00:37:57,670
<font color="#E5E5E5">implement the method that I'm going</font><font color="#CCCCCC"> to</font>

876
00:37:57,670 --> 00:37:59,170
<font color="#CCCCCC">talk to you about it now it's</font><font color="#E5E5E5"> actually</font>

877
00:37:59,170 --> 00:38:01,510
called<font color="#E5E5E5"> impossible</font><font color="#CCCCCC"> instead of hi</font><font color="#E5E5E5"> but it</font>

878
00:38:01,510 --> 00:38:02,980
doesn't<font color="#CCCCCC"> matter it's not exploitable</font>

879
00:38:02,980 --> 00:38:04,869
anyway so we don't really<font color="#E5E5E5"> need to have</font>

880
00:38:04,869 --> 00:38:06,510
<font color="#E5E5E5">it installed</font>

881
00:38:06,510 --> 00:38:08,700
so let's talk about<font color="#E5E5E5"> how you could</font>

882
00:38:08,700 --> 00:38:10,650
actually prevent these<font color="#E5E5E5"> vulnerabilities</font>

883
00:38:10,650 --> 00:38:13,109
from happen<font color="#E5E5E5"> without asking the user</font><font color="#CCCCCC"> to</font>

884
00:38:13,109 --> 00:38:15,300
re-enter<font color="#E5E5E5"> information or</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> early enter</font>

885
00:38:15,300 --> 00:38:17,670
the password<font color="#E5E5E5"> if you</font><font color="#CCCCCC"> think of it the way</font>

886
00:38:17,670 --> 00:38:20,640
<font color="#E5E5E5">we were able</font><font color="#CCCCCC"> to exploit this is we were</font>

887
00:38:20,640 --> 00:38:22,770
able<font color="#CCCCCC"> to</font><font color="#E5E5E5"> just copy the form that the</font>

888
00:38:22,770 --> 00:38:25,800
website uses and send it<font color="#CCCCCC"> to the target</font>

889
00:38:25,800 --> 00:38:28,260
<font color="#E5E5E5">person and get that person</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> run it or</font>

890
00:38:28,260 --> 00:38:30,780
automatically<font color="#E5E5E5"> run on the target person's</font>

891
00:38:30,780 --> 00:38:32,160
<font color="#E5E5E5">computer</font>

892
00:38:32,160 --> 00:38:34,860
so once the request is sent<font color="#E5E5E5"> to the</font>

893
00:38:34,860 --> 00:38:36,840
server the<font color="#CCCCCC"> server</font><font color="#E5E5E5"> wasn't doing any type</font>

894
00:38:36,840 --> 00:38:39,480
<font color="#CCCCCC">of validation to ensure that the user</font>

895
00:38:39,480 --> 00:38:42,080
<font color="#CCCCCC">actually wants to change</font><font color="#E5E5E5"> their password</font>

896
00:38:42,080 --> 00:38:46,530
so the best way to prevent<font color="#CCCCCC"> CSRF is to</font>

897
00:38:46,530 --> 00:38:48,600
make sure<font color="#CCCCCC"> that the user is submitting</font>

898
00:38:48,600 --> 00:38:51,090
data through a page<font color="#CCCCCC"> that was served to</font>

899
00:38:51,090 --> 00:38:54,120
him<font color="#E5E5E5"> by the web application and not by</font>

900
00:38:54,120 --> 00:38:57,360
<font color="#E5E5E5">anyone else</font><font color="#CCCCCC"> a good way of implementing</font>

901
00:38:57,360 --> 00:39:01,440
<font color="#CCCCCC">that is to use synchronizing tokens now</font>

902
00:39:01,440 --> 00:39:03,660
I know the name sounds complicated<font color="#CCCCCC"> but</font>

903
00:39:03,660 --> 00:39:05,300
the idea<font color="#CCCCCC"> is very</font><font color="#E5E5E5"> simple</font>

904
00:39:05,300 --> 00:39:08,730
basically we want<font color="#E5E5E5"> to generate a unique</font>

905
00:39:08,730 --> 00:39:12,660
and random token at<font color="#E5E5E5"> the server side then</font>

906
00:39:12,660 --> 00:39:14,760
when the page<font color="#CCCCCC"> is loaded when the form is</font>

907
00:39:14,760 --> 00:39:17,310
loaded we're going to embed this<font color="#E5E5E5"> already</font>

908
00:39:17,310 --> 00:39:20,190
generated token<font color="#E5E5E5"> into that page as a</font>

909
00:39:20,190 --> 00:39:23,070
<font color="#CCCCCC">hidden form</font><font color="#E5E5E5"> then when the form is</font>

910
00:39:23,070 --> 00:39:25,380
submitted<font color="#CCCCCC"> we're going to make sure</font><font color="#E5E5E5"> that</font>

911
00:39:25,380 --> 00:39:27,870
the form<font color="#E5E5E5"> was submitted with that token</font>

912
00:39:27,870 --> 00:39:31,170
that<font color="#E5E5E5"> we sent to that specific user</font><font color="#CCCCCC"> so</font>

913
00:39:31,170 --> 00:39:33,390
basically we give the<font color="#CCCCCC"> user a token and</font>

914
00:39:33,390 --> 00:39:36,510
then<font color="#E5E5E5"> we wait for him to submit the form</font>

915
00:39:36,510 --> 00:39:39,000
with<font color="#E5E5E5"> the token that we gave him that way</font>

916
00:39:39,000 --> 00:39:41,250
the token that<font color="#E5E5E5"> the hacker gets will only</font>

917
00:39:41,250 --> 00:39:43,950
work<font color="#CCCCCC"> for him</font><font color="#E5E5E5"> so even if</font><font color="#CCCCCC"> he generates a</font>

918
00:39:43,950 --> 00:39:45,750
page and send it<font color="#CCCCCC"> to the target and the</font>

919
00:39:45,750 --> 00:39:48,270
target runs the page the form will be

920
00:39:48,270 --> 00:39:50,610
<font color="#E5E5E5">submitted while it will be refused by</font>

921
00:39:50,610 --> 00:39:53,250
the server because<font color="#E5E5E5"> it did not give</font><font color="#CCCCCC"> that</font>

922
00:39:53,250 --> 00:39:55,890
token to that user<font color="#CCCCCC"> it gave that token to</font>

923
00:39:55,890 --> 00:39:58,680
the<font color="#E5E5E5"> hacker say for example we have this</font>

924
00:39:58,680 --> 00:40:01,730
user here<font color="#E5E5E5"> and he requests</font><font color="#CCCCCC"> facebook.com/</font>

925
00:40:01,730 --> 00:40:05,550
<font color="#E5E5E5">password with PHP it goes to the server</font>

926
00:40:05,550 --> 00:40:08,160
<font color="#CCCCCC">the server is gonna</font><font color="#E5E5E5"> generate a response</font>

927
00:40:08,160 --> 00:40:11,190
for that request<font color="#CCCCCC"> so it's going to</font><font color="#E5E5E5"> return</font>

928
00:40:11,190 --> 00:40:13,890
the HTML page<font color="#CCCCCC"> that</font><font color="#E5E5E5"> represents password</font>

929
00:40:13,890 --> 00:40:17,550
dot PHP<font color="#CCCCCC"> in that page</font><font color="#E5E5E5"> it's going to</font>

930
00:40:17,550 --> 00:40:20,790
include a unique token so when the page

931
00:40:20,790 --> 00:40:23,190
<font color="#CCCCCC">is loaded at the client-side it's</font><font color="#E5E5E5"> gonna</font>

932
00:40:23,190 --> 00:40:26,010
already<font color="#E5E5E5"> have the form that the user is</font>

933
00:40:26,010 --> 00:40:28,740
<font color="#CCCCCC">looking for</font><font color="#E5E5E5"> plus a unique token that was</font>

934
00:40:28,740 --> 00:40:32,940
<font color="#E5E5E5">generated by</font><font color="#CCCCCC"> the server</font><font color="#E5E5E5"> then when the</font>

935
00:40:32,940 --> 00:40:34,740
user<font color="#E5E5E5"> submits whatever they want to</font>

936
00:40:34,740 --> 00:40:37,770
<font color="#CCCCCC">submit the server will only accept</font><font color="#E5E5E5"> the</font>

937
00:40:37,770 --> 00:40:39,810
form and<font color="#CCCCCC"> will all will own the response</font>

938
00:40:39,810 --> 00:40:42,510
to what<font color="#CCCCCC"> the user</font><font color="#E5E5E5"> is asking if the user</font>

939
00:40:42,510 --> 00:40:45,990
returns the same token now<font color="#E5E5E5"> of this</font>

940
00:40:45,990 --> 00:40:48,390
implemented properly<font color="#CCCCCC"> it can still be</font>

941
00:40:48,390 --> 00:40:50,310
exploited so if the token<font color="#E5E5E5"> was</font>

942
00:40:50,310 --> 00:40:52,680
predictable<font color="#CCCCCC"> or if the same token was</font>

943
00:40:52,680 --> 00:40:56,040
being<font color="#E5E5E5"> used then the</font><font color="#CCCCCC"> hacker can discover</font>

944
00:40:56,040 --> 00:40:58,830
what the token is embedded in the<font color="#CCCCCC"> HTML</font>

945
00:40:58,830 --> 00:41:02,160
code<font color="#E5E5E5"> and send it to the user</font><font color="#CCCCCC"> so the</font>

946
00:41:02,160 --> 00:41:03,480
token needs<font color="#E5E5E5"> to have certain</font>

947
00:41:03,480 --> 00:41:06,000
characteristics<font color="#CCCCCC"> so that it's secure</font><font color="#E5E5E5"> and</font>

948
00:41:06,000 --> 00:41:08,100
basically the<font color="#E5E5E5"> main thing is that you</font>

949
00:41:08,100 --> 00:41:10,230
<font color="#E5E5E5">want to keep in</font><font color="#CCCCCC"> mind is that</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> token</font>

950
00:41:10,230 --> 00:41:13,380
needs<font color="#E5E5E5"> to be</font><font color="#CCCCCC"> unpredictable</font><font color="#E5E5E5"> and it cannot</font>

951
00:41:13,380 --> 00:41:16,260
<font color="#E5E5E5">be</font><font color="#CCCCCC"> reused</font><font color="#E5E5E5"> regardless of the way you're</font>

952
00:41:16,260 --> 00:41:18,150
going<font color="#E5E5E5"> to implement this these are the</font>

953
00:41:18,150 --> 00:41:19,740
<font color="#E5E5E5">two main things</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> you want to keep in</font>

954
00:41:19,740 --> 00:41:22,380
<font color="#CCCCCC">mind</font><font color="#E5E5E5"> because if it was predictable</font><font color="#CCCCCC"> then</font>

955
00:41:22,380 --> 00:41:24,360
the hacker will be able<font color="#E5E5E5"> to create their</font>

956
00:41:24,360 --> 00:41:26,520
<font color="#E5E5E5">own tokens and then embed them in the</font>

957
00:41:26,520 --> 00:41:29,400
code and run the attack same if the

958
00:41:29,400 --> 00:41:30,900
<font color="#E5E5E5">token can be reused</font>

959
00:41:30,900 --> 00:41:33,270
<font color="#E5E5E5">then the hacker can just use their token</font>

960
00:41:33,270 --> 00:41:35,880
or someone else's token to target their

961
00:41:35,880 --> 00:41:39,000
target so in order<font color="#CCCCCC"> to make the token</font>

962
00:41:39,000 --> 00:41:41,160
unpredictable and make it so that<font color="#E5E5E5"> it</font>

963
00:41:41,160 --> 00:41:43,680
can't<font color="#E5E5E5"> be used then the token needs to be</font>

964
00:41:43,680 --> 00:41:46,470
<font color="#E5E5E5">a large value</font><font color="#CCCCCC"> so that</font><font color="#E5E5E5"> the hacker can't</font>

965
00:41:46,470 --> 00:41:49,380
do a<font color="#CCCCCC"> brute-force</font><font color="#E5E5E5"> attack and discover</font>

966
00:41:49,380 --> 00:41:51,960
what the token is the<font color="#E5E5E5"> token needs to be</font>

967
00:41:51,960 --> 00:41:53,910
random<font color="#E5E5E5"> so</font><font color="#CCCCCC"> that the hacker will</font><font color="#E5E5E5"> not be</font>

968
00:41:53,910 --> 00:41:57,240
able<font color="#E5E5E5"> to create</font><font color="#CCCCCC"> their</font><font color="#E5E5E5"> own tokens and it</font>

969
00:41:57,240 --> 00:41:59,280
needs to<font color="#CCCCCC"> be unique for</font><font color="#E5E5E5"> each user because</font>

970
00:41:59,280 --> 00:42:01,560
if users get the same token or similar

971
00:42:01,560 --> 00:42:03,810
tokens then they can pass them around

972
00:42:03,810 --> 00:42:05,730
<font color="#CCCCCC">and then the token that</font><font color="#E5E5E5"> works for the</font>

973
00:42:05,730 --> 00:42:07,530
hacker will work for other people<font color="#CCCCCC"> so</font>

974
00:42:07,530 --> 00:42:11,130
<font color="#CCCCCC">that will defy the whole point you can</font>

975
00:42:11,130 --> 00:42:13,350
also increase the<font color="#CCCCCC"> security of the token</font>

976
00:42:13,350 --> 00:42:16,440
by<font color="#E5E5E5"> including other factors in the token</font>

977
00:42:16,440 --> 00:42:19,200
generation algorithm<font color="#E5E5E5"> so you can include</font>

978
00:42:19,200 --> 00:42:21,660
<font color="#E5E5E5">for</font><font color="#CCCCCC"> example the date and time</font><font color="#E5E5E5"> then</font>

979
00:42:21,660 --> 00:42:23,340
<font color="#E5E5E5">combine</font><font color="#CCCCCC"> it with</font><font color="#E5E5E5"> a secure random</font>

980
00:42:23,340 --> 00:42:26,670
<font color="#E5E5E5">generator and then encrypt that all of</font>

981
00:42:26,670 --> 00:42:28,380
<font color="#E5E5E5">this is obviously happening</font><font color="#CCCCCC"> at the</font>

982
00:42:28,380 --> 00:42:30,600
server side so the hacker will not be

983
00:42:30,600 --> 00:42:32,580
able<font color="#E5E5E5"> to</font><font color="#CCCCCC"> know what algorithm you're using</font>

984
00:42:32,580 --> 00:42:35,340
<font color="#E5E5E5">because the code will be executed at</font><font color="#CCCCCC"> the</font>

985
00:42:35,340 --> 00:42:38,010
server side<font color="#CCCCCC"> you don't necessarily have</font>

986
00:42:38,010 --> 00:42:40,560
<font color="#CCCCCC">to do</font><font color="#E5E5E5"> this using a secure large and</font>

987
00:42:40,560 --> 00:42:43,170
unique random number is enough<font color="#CCCCCC"> but if</font>

988
00:42:43,170 --> 00:42:45,180
you want to increase<font color="#CCCCCC"> the security</font><font color="#E5E5E5"> then</font>

989
00:42:45,180 --> 00:42:47,100
you can just<font color="#E5E5E5"> add</font><font color="#CCCCCC"> other factors</font><font color="#E5E5E5"> and</font>

990
00:42:47,100 --> 00:42:49,410
encrypt the token<font color="#CCCCCC"> before you send it to</font>

991
00:42:49,410 --> 00:42:51,930
the user<font color="#CCCCCC"> this is actually implemented in</font>

992
00:42:51,930 --> 00:42:54,540
<font color="#E5E5E5">Matilda so let me just show it</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> you in</font>

993
00:42:54,540 --> 00:42:55,720
action

994
00:42:55,720 --> 00:42:58,420
so I'm<font color="#E5E5E5"> just going to go to</font><font color="#CCCCCC"> Matilda in</font>

995
00:42:58,420 --> 00:43:00,900
here

996
00:43:02,119 --> 00:43:05,630
and I'm gonna go<font color="#CCCCCC"> on our Stan</font><font color="#E5E5E5"> CSRF and</font>

997
00:43:05,630 --> 00:43:08,320
add<font color="#E5E5E5"> to blog</font>

998
00:43:08,320 --> 00:43:11,470
so this allows you to<font color="#E5E5E5"> add a blog post so</font>

999
00:43:11,470 --> 00:43:12,550
it doesn't allow you to<font color="#E5E5E5"> change your</font>

1000
00:43:12,550 --> 00:43:14,110
password<font color="#CCCCCC"> or anything</font><font color="#E5E5E5"> it</font><font color="#CCCCCC"> actually allows</font>

1001
00:43:14,110 --> 00:43:17,020
anonymous<font color="#CCCCCC"> people to add posts as well so</font>

1002
00:43:17,020 --> 00:43:18,310
you can't<font color="#E5E5E5"> really</font><font color="#CCCCCC"> ask people for</font><font color="#E5E5E5"> a</font>

1003
00:43:18,310 --> 00:43:20,530
password<font color="#CCCCCC"> I'm actually gonna go</font><font color="#E5E5E5"> and</font>

1004
00:43:20,530 --> 00:43:23,320
toggle security so that<font color="#E5E5E5"> it's the</font><font color="#CCCCCC"> highest</font>

1005
00:43:23,320 --> 00:43:26,790
because<font color="#E5E5E5"> it's at zero</font><font color="#CCCCCC"> right now</font>

1006
00:43:28,620 --> 00:43:31,680
so now it's the<font color="#E5E5E5"> most secure and if we</font>

1007
00:43:31,680 --> 00:43:34,680
right-click this and go<font color="#CCCCCC"> on is</font><font color="#E5E5E5"> inspect</font>

1008
00:43:34,680 --> 00:43:37,160
element

1009
00:43:37,950 --> 00:43:40,640
<font color="#E5E5E5">going to scroll up</font>

1010
00:43:40,780 --> 00:43:42,880
and as you can<font color="#E5E5E5"> see</font><font color="#CCCCCC"> we have the form here</font>

1011
00:43:42,880 --> 00:43:46,150
<font color="#E5E5E5">and we have a hidden input with</font><font color="#CCCCCC"> a very</font>

1012
00:43:46,150 --> 00:43:49,120
<font color="#E5E5E5">long value and this</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> the token so this</font>

1013
00:43:49,120 --> 00:43:51,100
has already<font color="#E5E5E5"> been generated by the server</font>

1014
00:43:51,100 --> 00:43:53,890
and the server<font color="#E5E5E5"> will refuse any</font><font color="#CCCCCC"> request</font>

1015
00:43:53,890 --> 00:43:56,380
<font color="#E5E5E5">that we</font><font color="#CCCCCC"> sent to</font><font color="#E5E5E5"> it unless it has this</font>

1016
00:43:56,380 --> 00:43:59,620
specific token<font color="#CCCCCC"> and if I</font><font color="#E5E5E5"> use this form</font>

1017
00:43:59,620 --> 00:44:01,120
and send it<font color="#CCCCCC"> to someone</font><font color="#E5E5E5"> else</font>

1018
00:44:01,120 --> 00:44:04,060
<font color="#E5E5E5">then again the</font><font color="#CCCCCC"> e requests</font><font color="#E5E5E5"> that they will</font>

1019
00:44:04,060 --> 00:44:06,340
send will be refused<font color="#E5E5E5"> because</font><font color="#CCCCCC"> they'll</font><font color="#E5E5E5"> get</font>

1020
00:44:06,340 --> 00:44:08,320
a different token this token was

1021
00:44:08,320 --> 00:44:11,980
generated for me<font color="#E5E5E5"> and for me only so let</font>

1022
00:44:11,980 --> 00:44:13,540
<font color="#E5E5E5">me show</font><font color="#CCCCCC"> you if I actually refresh right</font>

1023
00:44:13,540 --> 00:44:15,369
now

1024
00:44:15,369 --> 00:44:16,960
I'm gonna get a<font color="#CCCCCC"> different token</font><font color="#E5E5E5"> and</font>

1025
00:44:16,960 --> 00:44:20,380
again if i refresh<font color="#CCCCCC"> again I'll get a</font>

1026
00:44:20,380 --> 00:44:24,279
<font color="#E5E5E5">different token and if I modify</font><font color="#CCCCCC"> this so</font>

1027
00:44:24,279 --> 00:44:25,839
let's<font color="#E5E5E5"> say instead of the capital I at</font>

1028
00:44:25,839 --> 00:44:28,859
the<font color="#E5E5E5"> end I'm going</font><font color="#CCCCCC"> to put a small I</font><font color="#E5E5E5"> and</font>

1029
00:44:28,859 --> 00:44:32,759
if I submit<font color="#E5E5E5"> this now</font>

1030
00:44:35,619 --> 00:44:39,700
it's given me an error but<font color="#E5E5E5"> let me not</font>

1031
00:44:39,700 --> 00:44:41,799
change this so again<font color="#CCCCCC"> I got a different</font>

1032
00:44:41,799 --> 00:44:43,869
token now and if I just<font color="#CCCCCC"> submitted the</font>

1033
00:44:43,869 --> 00:44:46,259
way it is

1034
00:44:48,720 --> 00:44:50,790
it's going to work<font color="#E5E5E5"> and now we have a</font>

1035
00:44:50,790 --> 00:44:52,200
blog entry called

1036
00:44:52,200 --> 00:44:55,710
test<font color="#E5E5E5"> so that's it it's</font><font color="#CCCCCC"> actually very</font>

1037
00:44:55,710 --> 00:44:58,140
very<font color="#E5E5E5"> simple</font><font color="#CCCCCC"> I didn't want to go into</font><font color="#E5E5E5"> too</font>

1038
00:44:58,140 --> 00:45:01,140
much<font color="#E5E5E5"> details</font><font color="#CCCCCC"> about how to create random</font>

1039
00:45:01,140 --> 00:45:03,329
<font color="#E5E5E5">token and all that because</font><font color="#CCCCCC"> that's</font><font color="#E5E5E5"> going</font>

1040
00:45:03,329 --> 00:45:05,220
to<font color="#E5E5E5"> be specific</font><font color="#CCCCCC"> depending on the</font>

1041
00:45:05,220 --> 00:45:07,050
programming language that's<font color="#E5E5E5"> the web</font>

1042
00:45:07,050 --> 00:45:10,079
application is programmed in but I was<font color="#E5E5E5"> I</font>

1043
00:45:10,079 --> 00:45:12,150
<font color="#E5E5E5">just wanted to show you the concept or</font>

1044
00:45:12,150 --> 00:45:15,000
the<font color="#CCCCCC"> idea</font><font color="#E5E5E5"> of how to secure web web</font>

1045
00:45:15,000 --> 00:45:16,650
<font color="#E5E5E5">applications against this type of</font>

1046
00:45:16,650 --> 00:45:19,440
<font color="#CCCCCC">vulnerability</font><font color="#E5E5E5"> the whole idea is</font><font color="#CCCCCC"> you want</font>

1047
00:45:19,440 --> 00:45:21,390
to make<font color="#CCCCCC"> sure</font><font color="#E5E5E5"> that the user submits their</font>

1048
00:45:21,390 --> 00:45:24,390
data<font color="#E5E5E5"> through a page</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> you serve to</font>

1049
00:45:24,390 --> 00:45:26,819
them<font color="#E5E5E5"> and not</font><font color="#CCCCCC"> by a page that was given to</font>

1050
00:45:26,819 --> 00:45:29,400
them by any other person<font color="#CCCCCC"> so in order</font><font color="#E5E5E5"> to</font>

1051
00:45:29,400 --> 00:45:32,010
do that we generate a<font color="#E5E5E5"> token</font><font color="#CCCCCC"> at the</font>

1052
00:45:32,010 --> 00:45:34,380
<font color="#CCCCCC">server side this token needs to be</font><font color="#E5E5E5"> long</font>

1053
00:45:34,380 --> 00:45:38,369
<font color="#E5E5E5">random and unique send that token with</font>

1054
00:45:38,369 --> 00:45:40,890
the page with the<font color="#E5E5E5"> form and embed</font><font color="#CCCCCC"> it as a</font>

1055
00:45:40,890 --> 00:45:43,560
<font color="#E5E5E5">hidden form and then whenever a user</font>

1056
00:45:43,560 --> 00:45:45,990
<font color="#CCCCCC">submits the response</font><font color="#E5E5E5"> make sure that they</font>

1057
00:45:45,990 --> 00:45:48,329
submit the same token that<font color="#E5E5E5"> was given to</font>

1058
00:45:48,329 --> 00:45:50,690
<font color="#E5E5E5">them</font>

1059
00:45:50,730 --> 00:45:53,250
now let's assume<font color="#CCCCCC"> you</font><font color="#E5E5E5"> tried all the</font>

1060
00:45:53,250 --> 00:45:55,320
attacks<font color="#CCCCCC"> that we learned so far</font><font color="#E5E5E5"> on</font><font color="#CCCCCC"> your</font>

1061
00:45:55,320 --> 00:45:57,930
target<font color="#E5E5E5"> website you tried all of them on</font>

1062
00:45:57,930 --> 00:45:59,970
all the<font color="#CCCCCC"> websites</font><font color="#E5E5E5"> on the same server and</font>

1063
00:45:59,970 --> 00:46:02,849
none of<font color="#CCCCCC"> these websites</font><font color="#E5E5E5"> is vulnerable</font><font color="#CCCCCC"> you</font>

1064
00:46:02,849 --> 00:46:05,099
went and<font color="#CCCCCC"> you try</font><font color="#E5E5E5"> to hack into</font><font color="#CCCCCC"> that</font>

1065
00:46:05,099 --> 00:46:07,380
server using the applications installed

1066
00:46:07,380 --> 00:46:09,030
<font color="#E5E5E5">on the server using the</font><font color="#CCCCCC"> server-side</font>

1067
00:46:09,030 --> 00:46:11,790
attacks<font color="#CCCCCC"> so</font><font color="#E5E5E5"> you use the port scanner and</font>

1068
00:46:11,790 --> 00:46:14,369
you<font color="#E5E5E5"> determine</font><font color="#CCCCCC"> the programs and the open</font>

1069
00:46:14,369 --> 00:46:17,040
ports and you try to hack into<font color="#E5E5E5"> the</font>

1070
00:46:17,040 --> 00:46:19,260
server based on these<font color="#E5E5E5"> services and</font><font color="#CCCCCC"> again</font>

1071
00:46:19,260 --> 00:46:21,150
you still didn't find<font color="#E5E5E5"> any way to get in</font>

1072
00:46:21,150 --> 00:46:24,510
<font color="#E5E5E5">and let's assume that you try to attack</font>

1073
00:46:24,510 --> 00:46:26,579
the data center<font color="#E5E5E5"> itself which contains</font>

1074
00:46:26,579 --> 00:46:28,440
all<font color="#E5E5E5"> the servers</font><font color="#CCCCCC"> and again you still</font>

1075
00:46:28,440 --> 00:46:31,170
<font color="#E5E5E5">didn't manage</font><font color="#CCCCCC"> to gain</font><font color="#E5E5E5"> access and you try</font>

1076
00:46:31,170 --> 00:46:33,300
to hack the users that<font color="#E5E5E5"> use the</font><font color="#CCCCCC"> websites</font>

1077
00:46:33,300 --> 00:46:35,099
all<font color="#E5E5E5"> the</font><font color="#CCCCCC"> websites on</font><font color="#E5E5E5"> the same server as</font>

1078
00:46:35,099 --> 00:46:37,320
<font color="#E5E5E5">your target website so you try</font><font color="#CCCCCC"> to hack</font>

1079
00:46:37,320 --> 00:46:39,720
the users<font color="#E5E5E5"> you try to hack the admins you</font>

1080
00:46:39,720 --> 00:46:41,940
try to hack the support<font color="#E5E5E5"> people using</font>

1081
00:46:41,940 --> 00:46:43,680
<font color="#CCCCCC">social engineering attacks and all these</font>

1082
00:46:43,680 --> 00:46:45,780
attacks<font color="#E5E5E5"> and again you still didn't</font>

1083
00:46:45,780 --> 00:46:49,230
manage<font color="#CCCCCC"> to gain your</font><font color="#E5E5E5"> access then I'd</font>

1084
00:46:49,230 --> 00:46:51,720
<font color="#CCCCCC">usually go down</font><font color="#E5E5E5"> to brute-force attacks</font>

1085
00:46:51,720 --> 00:46:54,089
<font color="#E5E5E5">now a lot of people would actually try</font>

1086
00:46:54,089 --> 00:46:56,369
<font color="#CCCCCC">brute-force attacks before</font><font color="#E5E5E5"> that but I</font>

1087
00:46:56,369 --> 00:46:58,140
just<font color="#CCCCCC"> don't</font><font color="#E5E5E5"> really like brute force</font>

1088
00:46:58,140 --> 00:47:00,450
attacks<font color="#E5E5E5"> not because they're not</font><font color="#CCCCCC"> useful</font>

1089
00:47:00,450 --> 00:47:02,430
or because they're not effective they're

1090
00:47:02,430 --> 00:47:05,010
actually<font color="#CCCCCC"> very effective</font><font color="#E5E5E5"> but it's just</font>

1091
00:47:05,010 --> 00:47:07,170
<font color="#E5E5E5">that I don't really feel satisfaction</font>

1092
00:47:07,170 --> 00:47:09,569
<font color="#E5E5E5">when I gain access to a</font><font color="#CCCCCC"> system using a</font>

1093
00:47:09,569 --> 00:47:11,839
<font color="#E5E5E5">brute force attack</font>

1094
00:47:11,839 --> 00:47:14,910
so what we mean by brute force<font color="#E5E5E5"> attacks</font>

1095
00:47:14,910 --> 00:47:16,799
<font color="#E5E5E5">is we're gonna go to the login screen</font>

1096
00:47:16,799 --> 00:47:18,930
<font color="#CCCCCC">most websites have login screen to allow</font>

1097
00:47:18,930 --> 00:47:21,569
<font color="#CCCCCC">the administer login and we're gonna</font><font color="#E5E5E5"> try</font>

1098
00:47:21,569 --> 00:47:24,390
<font color="#E5E5E5">to determine all possible combinations</font>

1099
00:47:24,390 --> 00:47:26,460
of the password

1100
00:47:26,460 --> 00:47:28,410
so there is two flavors<font color="#CCCCCC"> of</font><font color="#E5E5E5"> brute force</font>

1101
00:47:28,410 --> 00:47:30,990
<font color="#E5E5E5">attacks</font><font color="#CCCCCC"> or I should</font><font color="#E5E5E5"> say guessing attacks</font>

1102
00:47:30,990 --> 00:47:33,000
there<font color="#E5E5E5"> is brute force attacks and</font>

1103
00:47:33,000 --> 00:47:35,520
dictionary attacks<font color="#E5E5E5"> so brute force</font>

1104
00:47:35,520 --> 00:47:38,190
attacks would try to cover<font color="#E5E5E5"> all possible</font>

1105
00:47:38,190 --> 00:47:40,140
combinations of the password for<font color="#E5E5E5"> example</font>

1106
00:47:40,140 --> 00:47:42,839
<font color="#CCCCCC">on</font><font color="#E5E5E5"> your phone the pin can only be made</font>

1107
00:47:42,839 --> 00:47:45,119
out<font color="#CCCCCC"> of numbers</font><font color="#E5E5E5"> so you can actually cover</font>

1108
00:47:45,119 --> 00:47:47,220
all<font color="#E5E5E5"> possibilities very easily because</font>

1109
00:47:47,220 --> 00:47:49,020
the pin<font color="#E5E5E5"> only has four digits and there</font>

1110
00:47:49,020 --> 00:47:51,450
is only nine possibilities<font color="#CCCCCC"> when this</font>

1111
00:47:51,450 --> 00:47:53,609
comes to passwords<font color="#E5E5E5"> especially when it</font>

1112
00:47:53,609 --> 00:47:55,980
<font color="#E5E5E5">comes to web logins you have lowercase</font>

1113
00:47:55,980 --> 00:47:58,800
characters uppercase characters<font color="#E5E5E5"> symbols</font>

1114
00:47:58,800 --> 00:48:01,559
and digits<font color="#E5E5E5"> which makes the brute-force</font>

1115
00:48:01,559 --> 00:48:03,990
<font color="#E5E5E5">attack really unfeasible because it will</font>

1116
00:48:03,990 --> 00:48:06,319
take<font color="#E5E5E5"> years to cover all possibilities</font>

1117
00:48:06,319 --> 00:48:09,210
<font color="#E5E5E5">this leads us to</font><font color="#CCCCCC"> the dictionary</font><font color="#E5E5E5"> attack</font>

1118
00:48:09,210 --> 00:48:10,950
where you actually<font color="#E5E5E5"> cover all</font>

1119
00:48:10,950 --> 00:48:13,800
possibilities<font color="#CCCCCC"> in a list so</font><font color="#E5E5E5"> you're going</font>

1120
00:48:13,800 --> 00:48:15,900
to<font color="#E5E5E5"> have a list of passwords</font><font color="#CCCCCC"> these can</font><font color="#E5E5E5"> be</font>

1121
00:48:15,900 --> 00:48:18,750
made of common passwords<font color="#E5E5E5"> or based on the</font>

1122
00:48:18,750 --> 00:48:20,700
research that<font color="#E5E5E5"> you did</font><font color="#CCCCCC"> on your target</font><font color="#E5E5E5"> in</font>

1123
00:48:20,700 --> 00:48:23,670
the dictionary attack<font color="#CCCCCC"> you'll</font><font color="#E5E5E5"> only cover</font>

1124
00:48:23,670 --> 00:48:26,190
<font color="#CCCCCC">the passwords that exist</font><font color="#E5E5E5"> in the word</font>

1125
00:48:26,190 --> 00:48:28,710
list so unlike the<font color="#CCCCCC"> brute-force attack</font>

1126
00:48:28,710 --> 00:48:30,569
it's not<font color="#CCCCCC"> guaranteed because with the</font>

1127
00:48:30,569 --> 00:48:31,770
brute<font color="#CCCCCC"> force we're going to cover all</font>

1128
00:48:31,770 --> 00:48:34,230
possible combinations<font color="#E5E5E5"> in the dictionary</font>

1129
00:48:34,230 --> 00:48:36,089
attack<font color="#CCCCCC"> we're only going</font><font color="#E5E5E5"> to cover the</font>

1130
00:48:36,089 --> 00:48:38,520
passwords that<font color="#E5E5E5"> are in our word list or</font>

1131
00:48:38,520 --> 00:48:40,590
in the dictionary

1132
00:48:40,590 --> 00:48:42,720
so in the<font color="#E5E5E5"> next few lectures we're gonna</font>

1133
00:48:42,720 --> 00:48:44,070
see how<font color="#CCCCCC"> you can create</font><font color="#E5E5E5"> your own</font>

1134
00:48:44,070 --> 00:48:46,860
dictionary<font color="#CCCCCC"> and we're gonna see how we</font>

1135
00:48:46,860 --> 00:48:49,110
can launch a<font color="#E5E5E5"> brute-force attack to gain</font>

1136
00:48:49,110 --> 00:48:51,540
<font color="#CCCCCC">access to a system</font><font color="#E5E5E5"> without exploiting</font>

1137
00:48:51,540 --> 00:48:53,610
<font color="#E5E5E5">any vulnerabilities</font><font color="#CCCCCC"> all we're gonna do</font>

1138
00:48:53,610 --> 00:48:56,790
<font color="#E5E5E5">is</font><font color="#CCCCCC"> just try a large number</font><font color="#E5E5E5"> of passwords</font>

1139
00:48:56,790 --> 00:48:59,010
<font color="#E5E5E5">until one of them works</font><font color="#CCCCCC"> and this is the</font>

1140
00:48:59,010 --> 00:49:00,420
<font color="#E5E5E5">reason why I don't</font><font color="#CCCCCC"> really</font><font color="#E5E5E5"> like brute</font>

1141
00:49:00,420 --> 00:49:02,640
<font color="#E5E5E5">force because there is no smart way</font>

1142
00:49:02,640 --> 00:49:04,410
you're not actually exploiting anything

1143
00:49:04,410 --> 00:49:05,730
you literally<font color="#E5E5E5"> just guessing the password</font>

1144
00:49:05,730 --> 00:49:08,850
<font color="#E5E5E5">until</font><font color="#CCCCCC"> it works</font><font color="#E5E5E5"> keep in mind though just</font>

1145
00:49:08,850 --> 00:49:10,470
<font color="#E5E5E5">because I don't</font><font color="#CCCCCC"> really</font><font color="#E5E5E5"> like it</font><font color="#CCCCCC"> doesn't</font>

1146
00:49:10,470 --> 00:49:11,850
<font color="#E5E5E5">mean that it's not</font><font color="#CCCCCC"> effective</font><font color="#E5E5E5"> I've</font>

1147
00:49:11,850 --> 00:49:14,460
actually<font color="#E5E5E5"> in many cases I spent days</font>

1148
00:49:14,460 --> 00:49:17,520
<font color="#CCCCCC">trying to break</font><font color="#E5E5E5"> into a system</font><font color="#CCCCCC"> and at the</font>

1149
00:49:17,520 --> 00:49:19,440
end one<font color="#CCCCCC"> of the times I still remember</font>

1150
00:49:19,440 --> 00:49:23,520
the password<font color="#E5E5E5"> was 1 2 3 4</font><font color="#CCCCCC"> 5</font><font color="#E5E5E5"> 6 ABC which</font>

1151
00:49:23,520 --> 00:49:25,980
yield probably if you had a word list of

1152
00:49:25,980 --> 00:49:28,200
common passwords you'll probably gain

1153
00:49:28,200 --> 00:49:30,240
access to<font color="#CCCCCC"> that</font><font color="#E5E5E5"> system within an hour or</font>

1154
00:49:30,240 --> 00:49:32,540
<font color="#CCCCCC">two</font>

1155
00:49:35,490 --> 00:49:37,530
in this lecture<font color="#CCCCCC"> we're going to learn</font><font color="#E5E5E5"> how</font>

1156
00:49:37,530 --> 00:49:40,470
to create<font color="#E5E5E5"> a word list this is</font><font color="#CCCCCC"> a really</font>

1157
00:49:40,470 --> 00:49:42,480
<font color="#E5E5E5">handy</font><font color="#CCCCCC"> skill to have under your</font><font color="#E5E5E5"> belt</font><font color="#CCCCCC"> if</font>

1158
00:49:42,480 --> 00:49:44,640
you want to be a penetration<font color="#E5E5E5"> tester</font>

1159
00:49:44,640 --> 00:49:46,410
because<font color="#E5E5E5"> you're going to face a</font><font color="#CCCCCC"> lot of</font>

1160
00:49:46,410 --> 00:49:49,140
<font color="#CCCCCC">scenarios where a wordless attack can</font>

1161
00:49:49,140 --> 00:49:51,930
become<font color="#E5E5E5"> very handy</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> you can actually go</font>

1162
00:49:51,930 --> 00:49:53,820
ahead<font color="#E5E5E5"> and</font><font color="#CCCCCC"> look for ready word lists</font><font color="#E5E5E5"> on</font>

1163
00:49:53,820 --> 00:49:55,500
<font color="#CCCCCC">the</font><font color="#E5E5E5"> internet and there is some really</font>

1164
00:49:55,500 --> 00:49:57,869
really<font color="#E5E5E5"> good ones</font><font color="#CCCCCC"> and you</font><font color="#E5E5E5"> should probably</font>

1165
00:49:57,869 --> 00:49:59,610
<font color="#E5E5E5">use a lot</font><font color="#CCCCCC"> of them</font><font color="#E5E5E5"> because</font><font color="#CCCCCC"> some of</font><font color="#E5E5E5"> them</font>

1166
00:49:59,610 --> 00:50:01,890
<font color="#E5E5E5">just have the common passwords but in</font>

1167
00:50:01,890 --> 00:50:04,020
<font color="#E5E5E5">many cases you might actually need to</font>

1168
00:50:04,020 --> 00:50:05,550
<font color="#E5E5E5">create your own word list</font>

1169
00:50:05,550 --> 00:50:07,350
so in this<font color="#E5E5E5"> lecture we're going to learn</font>

1170
00:50:07,350 --> 00:50:09,840
<font color="#E5E5E5">how you create</font><font color="#CCCCCC"> your own</font><font color="#E5E5E5"> word list using</font>

1171
00:50:09,840 --> 00:50:12,960
a tool called crunch<font color="#E5E5E5"> so using the tool</font>

1172
00:50:12,960 --> 00:50:14,490
is<font color="#E5E5E5"> very simple all you have</font><font color="#CCCCCC"> to do is</font>

1173
00:50:14,490 --> 00:50:17,760
just put<font color="#CCCCCC"> the name of the</font><font color="#E5E5E5"> tool and then</font>

1174
00:50:17,760 --> 00:50:20,040
<font color="#CCCCCC">you specify</font><font color="#E5E5E5"> the minimum number</font><font color="#CCCCCC"> of</font>

1175
00:50:20,040 --> 00:50:21,780
<font color="#E5E5E5">characters for the passwords</font><font color="#CCCCCC"> to be</font>

1176
00:50:21,780 --> 00:50:24,180
<font color="#E5E5E5">generated then we're going to specify</font>

1177
00:50:24,180 --> 00:50:26,550
<font color="#E5E5E5">the maximum number of characters for the</font>

1178
00:50:26,550 --> 00:50:30,390
password<font color="#E5E5E5"> then you specify the characters</font>

1179
00:50:30,390 --> 00:50:32,430
<font color="#E5E5E5">that you want to generate passwords from</font>

1180
00:50:32,430 --> 00:50:34,770
for<font color="#E5E5E5"> example you can put</font><font color="#CCCCCC"> all lowercase</font>

1181
00:50:34,770 --> 00:50:36,960
characters all uppercase you can put

1182
00:50:36,960 --> 00:50:39,690
<font color="#E5E5E5">numbers digits or you can just specify a</font>

1183
00:50:39,690 --> 00:50:42,030
small a smaller number<font color="#E5E5E5"> to make the word</font>

1184
00:50:42,030 --> 00:50:45,600
<font color="#E5E5E5">list smaller you can also use the option</font>

1185
00:50:45,600 --> 00:50:48,000
T which is<font color="#E5E5E5"> an optional</font><font color="#CCCCCC"> to give a pattern</font>

1186
00:50:48,000 --> 00:50:49,619
so for example let's say that<font color="#E5E5E5"> you are</font>

1187
00:50:49,619 --> 00:50:51,119
<font color="#CCCCCC">looking at the person while they were</font>

1188
00:50:51,119 --> 00:50:53,310
type in their password and you seen that

1189
00:50:53,310 --> 00:50:55,020
<font color="#E5E5E5">the password will start when it with an</font>

1190
00:50:55,020 --> 00:50:57,660
A so<font color="#E5E5E5"> you can tell crunch that the</font>

1191
00:50:57,660 --> 00:50:59,760
password will start with an A and then

1192
00:50:59,760 --> 00:51:01,980
<font color="#E5E5E5">give me all possible combination</font><font color="#CCCCCC"> of</font>

1193
00:51:01,980 --> 00:51:06,000
passwords<font color="#E5E5E5"> that start with an A and after</font>

1194
00:51:06,000 --> 00:51:08,220
that we use the<font color="#E5E5E5"> minus o option to</font>

1195
00:51:08,220 --> 00:51:10,140
specify<font color="#CCCCCC"> the file name</font><font color="#E5E5E5"> where the</font>

1196
00:51:10,140 --> 00:51:13,140
passwords are going to be stored<font color="#E5E5E5"> so we</font>

1197
00:51:13,140 --> 00:51:14,640
have a small<font color="#CCCCCC"> little example here that</font>

1198
00:51:14,640 --> 00:51:18,000
<font color="#E5E5E5">will generate a list of</font><font color="#CCCCCC"> passwords</font><font color="#E5E5E5"> that</font>

1199
00:51:18,000 --> 00:51:20,580
<font color="#E5E5E5">contain that start from</font><font color="#CCCCCC"> six characters</font>

1200
00:51:20,580 --> 00:51:23,340
to<font color="#E5E5E5"> eight characters and contain these</font>

1201
00:51:23,340 --> 00:51:25,170
characters right here so it's<font color="#E5E5E5"> going</font><font color="#CCCCCC"> to</font>

1202
00:51:25,170 --> 00:51:28,380
<font color="#E5E5E5">create combinations of</font><font color="#CCCCCC"> 1 2 3 ABC</font><font color="#E5E5E5"> and the</font>

1203
00:51:28,380 --> 00:51:30,900
dollar sign<font color="#E5E5E5"> and it's going to store it</font>

1204
00:51:30,900 --> 00:51:33,809
in<font color="#E5E5E5"> a file called</font>

1205
00:51:33,809 --> 00:51:36,509
<font color="#E5E5E5">that should be a no I'll fix that in a</font>

1206
00:51:36,509 --> 00:51:39,359
file called word<font color="#CCCCCC"> list</font><font color="#E5E5E5"> and these</font>

1207
00:51:39,359 --> 00:51:41,400
passwords are<font color="#CCCCCC"> going to start</font><font color="#E5E5E5"> with an A</font>

1208
00:51:41,400 --> 00:51:44,549
and end with<font color="#E5E5E5"> the B and it will generate</font>

1209
00:51:44,549 --> 00:51:47,039
passwords based on all<font color="#CCCCCC"> possible</font>

1210
00:51:47,039 --> 00:51:49,619
combinations<font color="#CCCCCC"> between the a</font><font color="#E5E5E5"> and the B so</font>

1211
00:51:49,619 --> 00:51:51,959
<font color="#CCCCCC">all of the generated passwords will</font>

1212
00:51:51,959 --> 00:51:55,880
always start with a and end with<font color="#E5E5E5"> beef</font>

1213
00:51:56,180 --> 00:51:58,339
so let's have an<font color="#CCCCCC"> example</font><font color="#E5E5E5"> of the tool now</font>

1214
00:51:58,339 --> 00:51:59,660
the tool<font color="#CCCCCC"> actually have a lot of</font><font color="#E5E5E5"> options</font>

1215
00:51:59,660 --> 00:52:02,210
<font color="#E5E5E5">other than what we've seen</font><font color="#CCCCCC"> so far so if</font>

1216
00:52:02,210 --> 00:52:06,340
you just type in man<font color="#E5E5E5"> crunch</font>

1217
00:52:06,340 --> 00:52:08,860
<font color="#E5E5E5">you'll see all the</font><font color="#CCCCCC"> options that you</font><font color="#E5E5E5"> can</font>

1218
00:52:08,860 --> 00:52:11,260
set and you'll see detailed description

1219
00:52:11,260 --> 00:52:13,150
<font color="#E5E5E5">about all of these options so it's</font>

1220
00:52:13,150 --> 00:52:15,220
actually<font color="#E5E5E5"> really really good</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> can go</font>

1221
00:52:15,220 --> 00:52:17,080
ahead and<font color="#CCCCCC"> spend some time to get</font>

1222
00:52:17,080 --> 00:52:19,000
<font color="#E5E5E5">familiar with the tool</font><font color="#CCCCCC"> now I'm going</font><font color="#E5E5E5"> to</font>

1223
00:52:19,000 --> 00:52:20,680
show you<font color="#E5E5E5"> the example and based on the</font>

1224
00:52:20,680 --> 00:52:22,180
example you'll be<font color="#CCCCCC"> able to</font><font color="#E5E5E5"> run</font><font color="#CCCCCC"> all of</font>

1225
00:52:22,180 --> 00:52:25,240
these commands<font color="#E5E5E5"> but if you want to run or</font>

1226
00:52:25,240 --> 00:52:27,520
create some advanced word lists<font color="#E5E5E5"> then I</font>

1227
00:52:27,520 --> 00:52:30,550
highly<font color="#CCCCCC"> recommend that you</font><font color="#E5E5E5"> go over this</font>

1228
00:52:30,550 --> 00:52:32,560
one of the really cool options that<font color="#E5E5E5"> I</font>

1229
00:52:32,560 --> 00:52:34,780
want to<font color="#E5E5E5"> highlight is the minus P option</font>

1230
00:52:34,780 --> 00:52:37,780
the minus<font color="#E5E5E5"> P option tells crunch to</font>

1231
00:52:37,780 --> 00:52:39,910
generate passwords<font color="#CCCCCC"> that don't have</font>

1232
00:52:39,910 --> 00:52:42,220
repeating characters for example<font color="#CCCCCC"> when</font>

1233
00:52:42,220 --> 00:52:44,650
you specify all lowercase characters you

1234
00:52:44,650 --> 00:52:47,530
specify ABCD<font color="#E5E5E5"> it will start by generating</font>

1235
00:52:47,530 --> 00:52:51,190
passwords made of<font color="#E5E5E5">  </font><font color="#CCCCCC"> and then a a</font>

1236
00:52:51,190 --> 00:52:55,540
<font color="#E5E5E5">then a bbbbb and all</font><font color="#CCCCCC"> of that</font><font color="#E5E5E5"> so when you</font>

1237
00:52:55,540 --> 00:52:57,670
do this<font color="#E5E5E5"> crunch will actually ignore</font>

1238
00:52:57,670 --> 00:52:59,440
these type of passwords<font color="#E5E5E5"> and it's a loan</font>

1239
00:52:59,440 --> 00:53:01,180
to create passwords<font color="#CCCCCC"> that don't have any</font>

1240
00:53:01,180 --> 00:53:03,490
repeating characters and<font color="#CCCCCC"> that'll reduce</font>

1241
00:53:03,490 --> 00:53:05,890
the size of the word list from the

1242
00:53:05,890 --> 00:53:07,690
number<font color="#E5E5E5"> of characters to the power of</font><font color="#CCCCCC"> the</font>

1243
00:53:07,690 --> 00:53:09,520
length to the number of<font color="#CCCCCC"> characters</font>

1244
00:53:09,520 --> 00:53:11,550
<font color="#E5E5E5">factorial</font>

1245
00:53:11,550 --> 00:53:14,160
if you scroll down<font color="#E5E5E5"> you'll actually see</font>

1246
00:53:14,160 --> 00:53:17,070
more examples<font color="#CCCCCC"> of commands and the type</font>

1247
00:53:17,070 --> 00:53:19,940
<font color="#CCCCCC">of word lists that will be</font><font color="#E5E5E5"> created</font><font color="#CCCCCC"> so</font>

1248
00:53:19,940 --> 00:53:22,170
<font color="#CCCCCC">again you can</font><font color="#E5E5E5"> have a look on these and</font>

1249
00:53:22,170 --> 00:53:24,930
get yourself<font color="#E5E5E5"> for me familiar with once</font>

1250
00:53:24,930 --> 00:53:26,610
you're<font color="#E5E5E5"> done looking at the</font><font color="#CCCCCC"> man you can</font>

1251
00:53:26,610 --> 00:53:28,680
<font color="#E5E5E5">just press Q and you'll be</font><font color="#CCCCCC"> out of it and</font>

1252
00:53:28,680 --> 00:53:30,810
we're gonna<font color="#E5E5E5"> run our command here so</font>

1253
00:53:30,810 --> 00:53:33,019
we're gonna use crunch

1254
00:53:33,019 --> 00:53:35,419
and again I want<font color="#CCCCCC"> to generate</font><font color="#E5E5E5"> passwords</font>

1255
00:53:35,419 --> 00:53:38,689
<font color="#E5E5E5">of minimum of six characters</font><font color="#CCCCCC"> and maximum</font>

1256
00:53:38,689 --> 00:53:41,659
of<font color="#E5E5E5"> eight characters and I want them</font><font color="#CCCCCC"> to</font>

1257
00:53:41,659 --> 00:53:45,259
contain combinations of ABC and let's

1258
00:53:45,259 --> 00:53:48,890
say the digits<font color="#CCCCCC"> 1 2 now in here you can</font>

1259
00:53:48,890 --> 00:53:50,599
<font color="#E5E5E5">actually keep listing things you can</font>

1260
00:53:50,599 --> 00:53:52,759
list<font color="#E5E5E5"> characters you can list uppercase</font>

1261
00:53:52,759 --> 00:53:54,679
characters or even symbols if you wanted

1262
00:53:54,679 --> 00:53:57,049
to once you're done<font color="#E5E5E5"> with listing the</font>

1263
00:53:57,049 --> 00:53:58,579
characters we're<font color="#E5E5E5"> going to specify</font><font color="#CCCCCC"> the</font>

1264
00:53:58,579 --> 00:54:00,919
file<font color="#E5E5E5"> to save it to and we're gonna save</font>

1265
00:54:00,919 --> 00:54:03,810
it<font color="#E5E5E5"> in a file called test</font>

1266
00:54:03,810 --> 00:54:08,130
but txt so the<font color="#E5E5E5"> command is very simple</font>

1267
00:54:08,130 --> 00:54:10,710
<font color="#CCCCCC">its</font><font color="#E5E5E5"> scrunch minimum length of the</font>

1268
00:54:10,710 --> 00:54:12,420
password<font color="#CCCCCC"> the maximum length</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> the</font>

1269
00:54:12,420 --> 00:54:14,580
password<font color="#E5E5E5"> followed by the characters that</font>

1270
00:54:14,580 --> 00:54:16,260
we want to use to<font color="#CCCCCC"> generate passwords</font>

1271
00:54:16,260 --> 00:54:19,650
from<font color="#E5E5E5"> and then</font><font color="#CCCCCC"> Oh to</font><font color="#E5E5E5"> the file that</font><font color="#CCCCCC"> the</font>

1272
00:54:19,650 --> 00:54:21,930
passwords are going to be stored<font color="#CCCCCC"> in you</font>

1273
00:54:21,930 --> 00:54:24,010
can hit<font color="#E5E5E5"> enter</font>

1274
00:54:24,010 --> 00:54:26,050
and as you can see<font color="#E5E5E5"> now is telling us</font>

1275
00:54:26,050 --> 00:54:28,750
that<font color="#E5E5E5"> it generated four hundred and forty</font>

1276
00:54:28,750 --> 00:54:31,240
eight thousand passwords<font color="#E5E5E5"> approximately</font>

1277
00:54:31,240 --> 00:54:33,610
and they're all stored in a file called

1278
00:54:33,610 --> 00:54:36,760
<font color="#CCCCCC">tester txt now</font><font color="#E5E5E5"> the size of the file is</font>

1279
00:54:36,760 --> 00:54:39,490
<font color="#E5E5E5">four megabytes and now I can open this</font>

1280
00:54:39,490 --> 00:54:42,329
file<font color="#E5E5E5"> by doing cat</font>

1281
00:54:42,329 --> 00:54:44,369
test

1282
00:54:44,369 --> 00:54:47,489
dot<font color="#E5E5E5"> txt and as you can</font><font color="#CCCCCC"> see now we can</font>

1283
00:54:47,489 --> 00:54:49,079
see all<font color="#CCCCCC"> the passwords that have been</font>

1284
00:54:49,079 --> 00:54:51,630
generated<font color="#CCCCCC"> I'm going to</font><font color="#E5E5E5"> control</font><font color="#CCCCCC"> C out</font><font color="#E5E5E5"> of</font>

1285
00:54:51,630 --> 00:54:53,999
it because<font color="#E5E5E5"> it's a huge file and as you</font>

1286
00:54:53,999 --> 00:54:55,859
can<font color="#E5E5E5"> see</font><font color="#CCCCCC"> it actually</font><font color="#E5E5E5"> contains all</font>

1287
00:54:55,859 --> 00:55:00,990
<font color="#CCCCCC">possible combinations of ABC one two</font>

1288
00:55:00,990 --> 00:55:03,180
I also want to show<font color="#E5E5E5"> you an example of</font>

1289
00:55:03,180 --> 00:55:05,609
<font color="#CCCCCC">using</font><font color="#E5E5E5"> the minus</font><font color="#CCCCCC"> T option so I'm gonna</font>

1290
00:55:05,609 --> 00:55:08,220
set this to only<font color="#CCCCCC"> six</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> six so it's</font><font color="#E5E5E5"> only</font>

1291
00:55:08,220 --> 00:55:10,560
six characters and we're<font color="#E5E5E5"> going to use</font>

1292
00:55:10,560 --> 00:55:12,300
the minus T option<font color="#CCCCCC"> which is</font><font color="#E5E5E5"> the pattern</font>

1293
00:55:12,300 --> 00:55:14,849
option<font color="#E5E5E5"> and I'm gonna tell it that I want</font>

1294
00:55:14,849 --> 00:55:16,650
the<font color="#CCCCCC"> password to always start with an A</font>

1295
00:55:16,650 --> 00:55:20,190
and then<font color="#E5E5E5"> I want you to fill all possible</font>

1296
00:55:20,190 --> 00:55:22,859
combinations of characters<font color="#E5E5E5"> between the a</font>

1297
00:55:22,859 --> 00:55:26,400
<font color="#E5E5E5">and the B so I want passwords</font><font color="#CCCCCC"> that start</font>

1298
00:55:26,400 --> 00:55:29,099
<font color="#CCCCCC">with an A and end</font><font color="#E5E5E5"> with the beep and in</font>

1299
00:55:29,099 --> 00:55:31,170
the middle at the<font color="#CCCCCC"> add sign you can fill</font>

1300
00:55:31,170 --> 00:55:34,369
all possible combinations of ABC<font color="#E5E5E5"> one two</font>

1301
00:55:34,369 --> 00:55:37,000
can hit<font color="#CCCCCC"> enter</font>

1302
00:55:37,000 --> 00:55:38,320
<font color="#E5E5E5">as you can see now the number of</font>

1303
00:55:38,320 --> 00:55:41,680
passwords is much less it's only<font color="#CCCCCC"> 625</font>

1304
00:55:41,680 --> 00:55:44,860
passwords<font color="#E5E5E5"> because I've narrowed down the</font>

1305
00:55:44,860 --> 00:55:47,410
possibilities of<font color="#E5E5E5"> passwords again if I do</font>

1306
00:55:47,410 --> 00:55:49,490
<font color="#CCCCCC">cat</font>

1307
00:55:49,490 --> 00:55:53,390
test dot txt<font color="#E5E5E5"> you'll see that I have all</font>

1308
00:55:53,390 --> 00:55:56,369
the passwords<font color="#E5E5E5"> right here</font>

1309
00:55:56,369 --> 00:55:59,099
so this is it<font color="#E5E5E5"> tool is really useful can</font>

1310
00:55:59,099 --> 00:56:01,619
be used in many<font color="#CCCCCC"> scenarios I highly</font>

1311
00:56:01,619 --> 00:56:03,119
<font color="#E5E5E5">recommend that you spend some</font><font color="#CCCCCC"> time</font><font color="#E5E5E5"> with</font>

1312
00:56:03,119 --> 00:56:05,519
<font color="#CCCCCC">it</font><font color="#E5E5E5"> and also have have a look on</font><font color="#CCCCCC"> some of</font>

1313
00:56:05,519 --> 00:56:07,469
the<font color="#CCCCCC"> existing word lists out there on the</font>

1314
00:56:07,469 --> 00:56:09,859
<font color="#E5E5E5">Internet</font>

1315
00:56:11,090 --> 00:56:13,670
now that we have<font color="#CCCCCC"> a word list ready</font>

1316
00:56:13,670 --> 00:56:15,050
whether you downloaded<font color="#E5E5E5"> it from the</font>

1317
00:56:15,050 --> 00:56:17,510
internet<font color="#CCCCCC"> or if you</font><font color="#E5E5E5"> created it by</font>

1318
00:56:17,510 --> 00:56:19,940
yourself now we can go ahead<font color="#CCCCCC"> and proceed</font>

1319
00:56:19,940 --> 00:56:23,600
to<font color="#E5E5E5"> gain an access to our</font><font color="#CCCCCC"> target website</font>

1320
00:56:23,600 --> 00:56:26,809
using a word list attack

1321
00:56:26,809 --> 00:56:28,519
so we're<font color="#CCCCCC"> gonna use a tool called Hydra</font>

1322
00:56:28,519 --> 00:56:31,969
and<font color="#CCCCCC"> Hydra can be used to brute force</font><font color="#E5E5E5"> any</font>

1323
00:56:31,969 --> 00:56:33,739
type<font color="#CCCCCC"> of</font><font color="#E5E5E5"> service</font><font color="#CCCCCC"> really I can't think of</font>

1324
00:56:33,739 --> 00:56:36,019
<font color="#E5E5E5">any service</font><font color="#CCCCCC"> that you can't brute force</font>

1325
00:56:36,019 --> 00:56:38,839
<font color="#E5E5E5">so it's a really handy</font><font color="#CCCCCC"> tool to</font><font color="#E5E5E5"> know how</font>

1326
00:56:38,839 --> 00:56:41,390
to use we're gonna do our example on a

1327
00:56:41,390 --> 00:56:43,909
web login<font color="#E5E5E5"> but you can use</font><font color="#CCCCCC"> it to</font><font color="#E5E5E5"> gain</font>

1328
00:56:43,909 --> 00:56:48,799
access to<font color="#CCCCCC"> SSH</font><font color="#E5E5E5"> FTP router is anything</font>

1329
00:56:48,799 --> 00:56:50,359
that<font color="#CCCCCC"> ask you for a username and</font><font color="#E5E5E5"> a</font>

1330
00:56:50,359 --> 00:56:52,500
password really

1331
00:56:52,500 --> 00:56:54,780
so to use the tool<font color="#CCCCCC"> the first thing we're</font>

1332
00:56:54,780 --> 00:56:56,340
<font color="#CCCCCC">going to do is we're gonna type in</font><font color="#E5E5E5"> Hydra</font>

1333
00:56:56,340 --> 00:56:59,849
<font color="#CCCCCC">and we got</font><font color="#E5E5E5"> ports - help to see how to</font>

1334
00:56:59,849 --> 00:57:02,270
<font color="#CCCCCC">use</font><font color="#E5E5E5"> it</font>

1335
00:57:02,740 --> 00:57:04,540
now as you can<font color="#E5E5E5"> see</font><font color="#CCCCCC"> there is a lot</font><font color="#E5E5E5"> of</font>

1336
00:57:04,540 --> 00:57:06,520
options<font color="#E5E5E5"> for the tool but don't be</font>

1337
00:57:06,520 --> 00:57:08,950
overwhelmed<font color="#E5E5E5"> with that they're already</font>

1338
00:57:08,950 --> 00:57:13,869
pretty simple to use<font color="#E5E5E5"> so if you go up</font><font color="#CCCCCC"> you</font>

1339
00:57:13,869 --> 00:57:15,940
can<font color="#CCCCCC"> see that the main syntax</font><font color="#E5E5E5"> of using</font>

1340
00:57:15,940 --> 00:57:17,980
the tool is you the first thing<font color="#E5E5E5"> you have</font>

1341
00:57:17,980 --> 00:57:20,260
<font color="#CCCCCC">to do is put in</font><font color="#E5E5E5"> the name of</font><font color="#CCCCCC"> the tool so</font>

1342
00:57:20,260 --> 00:57:23,490
<font color="#CCCCCC">we're gonna put</font><font color="#E5E5E5"> Hydra</font>

1343
00:57:23,690 --> 00:57:26,930
and then we're gonna put the service

1344
00:57:26,930 --> 00:57:28,849
that we want<font color="#E5E5E5"> to attack so you can see</font>

1345
00:57:28,849 --> 00:57:30,980
that they have examples here of you

1346
00:57:30,980 --> 00:57:34,970
<font color="#E5E5E5">attacking an FTP</font><font color="#CCCCCC"> service people</font><font color="#E5E5E5"> attack</font>

1347
00:57:34,970 --> 00:57:37,280
<font color="#E5E5E5">in an IMAP service and other type</font><font color="#CCCCCC"> of</font>

1348
00:57:37,280 --> 00:57:41,630
services<font color="#E5E5E5"> so in our example we</font><font color="#CCCCCC"> are</font>

1349
00:57:41,630 --> 00:57:44,829
interested<font color="#CCCCCC"> in</font><font color="#E5E5E5"> to gaining access to our</font>

1350
00:57:44,829 --> 00:57:50,210
<font color="#E5E5E5">login</font><font color="#CCCCCC"> here to to this page</font><font color="#E5E5E5"> and we're</font>

1351
00:57:50,210 --> 00:57:51,560
gonna<font color="#E5E5E5"> assume that we don't know I use</font>

1352
00:57:51,560 --> 00:57:53,510
the name<font color="#CCCCCC"> and a password and we're gonna</font>

1353
00:57:53,510 --> 00:57:55,490
try to<font color="#CCCCCC"> log in</font><font color="#E5E5E5"> to the admin without</font>

1354
00:57:55,490 --> 00:57:58,450
knowing their password

1355
00:57:58,450 --> 00:58:01,329
so our<font color="#E5E5E5"> target service is going to be</font>

1356
00:58:01,329 --> 00:58:03,779
this<font color="#E5E5E5"> one</font>

1357
00:58:05,510 --> 00:58:07,369
so the first thing you want<font color="#E5E5E5"> to use is</font>

1358
00:58:07,369 --> 00:58:12,020
<font color="#CCCCCC">its IP so the IP is 10 2014</font><font color="#E5E5E5"> to 12 so</font>

1359
00:58:12,020 --> 00:58:13,280
we're going<font color="#E5E5E5"> to put it after the name of</font>

1360
00:58:13,280 --> 00:58:15,790
<font color="#CCCCCC">the tool</font>

1361
00:58:16,580 --> 00:58:22,100
then looking at the syntax<font color="#CCCCCC"> here</font><font color="#E5E5E5"> you can</font>

1362
00:58:22,100 --> 00:58:24,790
see that we have to specify<font color="#E5E5E5"> a login and</font>

1363
00:58:24,790 --> 00:58:28,790
a password<font color="#E5E5E5"> so let's have a look on the</font>

1364
00:58:28,790 --> 00:58:31,100
<font color="#E5E5E5">minus L and the minus P options in here</font>

1365
00:58:31,100 --> 00:58:34,100
<font color="#E5E5E5">and you can see that you can use a small</font>

1366
00:58:34,100 --> 00:58:37,910
L to specify one<font color="#E5E5E5"> username or I capital L</font>

1367
00:58:37,910 --> 00:58:41,480
to specify a<font color="#E5E5E5"> list of</font><font color="#CCCCCC"> usernames so in our</font>

1368
00:58:41,480 --> 00:58:43,640
<font color="#E5E5E5">example we're only trying to gain access</font>

1369
00:58:43,640 --> 00:58:45,680
<font color="#CCCCCC">to the admin so we're not</font><font color="#E5E5E5"> going</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> use a</font>

1370
00:58:45,680 --> 00:58:47,240
list of usernames<font color="#E5E5E5"> we're only going to</font>

1371
00:58:47,240 --> 00:58:50,170
try to gain access to<font color="#E5E5E5"> the admin password</font>

1372
00:58:50,170 --> 00:58:52,940
<font color="#CCCCCC">so what we're</font><font color="#E5E5E5"> going to do is we're gonna</font>

1373
00:58:52,940 --> 00:58:55,970
do -<font color="#E5E5E5"> L small and then we're going</font><font color="#CCCCCC"> to</font>

1374
00:58:55,970 --> 00:58:58,430
tell<font color="#E5E5E5"> it that</font><font color="#CCCCCC"> the username is admin</font>

1375
00:58:58,430 --> 00:59:00,140
and then the next<font color="#CCCCCC"> thing we</font><font color="#E5E5E5"> need to</font>

1376
00:59:00,140 --> 00:59:04,010
<font color="#E5E5E5">specify</font><font color="#CCCCCC"> is the</font><font color="#E5E5E5"> password or a</font><font color="#CCCCCC"> password</font>

1377
00:59:04,010 --> 00:59:07,190
list<font color="#CCCCCC"> so similar to the other option you</font>

1378
00:59:07,190 --> 00:59:09,470
can<font color="#E5E5E5"> use a small</font><font color="#CCCCCC"> P to give one password</font>

1379
00:59:09,470 --> 00:59:13,040
<font color="#CCCCCC">or you can use a capital</font><font color="#E5E5E5"> P to specify a</font>

1380
00:59:13,040 --> 00:59:16,220
file or<font color="#E5E5E5"> a word list or a dictionary</font><font color="#CCCCCC"> of</font>

1381
00:59:16,220 --> 00:59:19,309
passwords so I'm<font color="#E5E5E5"> actually going to</font>

1382
00:59:19,309 --> 00:59:21,290
<font color="#CCCCCC">modify the password file that we created</font>

1383
00:59:21,290 --> 00:59:23,800
<font color="#E5E5E5">in</font><font color="#CCCCCC"> the previous video</font>

1384
00:59:23,800 --> 00:59:27,790
<font color="#E5E5E5">I'm just gonna</font><font color="#CCCCCC"> open it in my text editor</font>

1385
00:59:27,790 --> 00:59:30,190
<font color="#CCCCCC">so this one it's right here</font><font color="#E5E5E5"> it's called</font>

1386
00:59:30,190 --> 00:59:32,830
<font color="#E5E5E5">tester txt</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> I'm just gonna add the</font>

1387
00:59:32,830 --> 00:59:34,780
<font color="#E5E5E5">password for the admin I know the</font>

1388
00:59:34,780 --> 00:59:36,430
password<font color="#CCCCCC"> for the admin is called admin</font>

1389
00:59:36,430 --> 00:59:38,680
pass and I'll just add it<font color="#CCCCCC"> somewhere in</font>

1390
00:59:38,680 --> 00:59:41,070
<font color="#CCCCCC">the middle here</font>

1391
00:59:41,369 --> 00:59:43,529
<font color="#E5E5E5">okay so I'm going</font><font color="#CCCCCC"> to save it and quit it</font>

1392
00:59:43,529 --> 00:59:47,339
and now our word our word list contains

1393
00:59:47,339 --> 00:59:50,479
<font color="#E5E5E5">the password so we're gonna do minus P</font>

1394
00:59:50,479 --> 00:59:53,309
capital<font color="#CCCCCC"> P and then we're gonna give it</font>

1395
00:59:53,309 --> 00:59:55,170
<font color="#E5E5E5">where the password list is stored and</font>

1396
00:59:55,170 --> 00:59:59,960
it's stored<font color="#E5E5E5"> in</font><font color="#CCCCCC"> root test dot txt</font>

1397
01:00:00,150 --> 01:00:03,420
so everything is good<font color="#CCCCCC"> until now and</font>

1398
01:00:03,420 --> 01:00:06,240
there<font color="#E5E5E5"> is only one</font><font color="#CCCCCC"> more thing</font><font color="#E5E5E5"> to do</font>

1399
01:00:06,240 --> 01:00:08,760
we still haven't specified<font color="#E5E5E5"> what type of</font>

1400
01:00:08,760 --> 01:00:11,190
<font color="#E5E5E5">service</font><font color="#CCCCCC"> that we</font><font color="#E5E5E5"> are attacking</font><font color="#CCCCCC"> so we gave</font>

1401
01:00:11,190 --> 01:00:15,300
<font color="#CCCCCC">it the IP we gave it the username</font><font color="#E5E5E5"> and we</font>

1402
01:00:15,300 --> 01:00:18,180
gave<font color="#E5E5E5"> it the list of</font><font color="#CCCCCC"> passwords to try but</font>

1403
01:00:18,180 --> 01:00:20,010
<font color="#E5E5E5">Hydra still doesn't know what type</font><font color="#CCCCCC"> of</font>

1404
01:00:20,010 --> 01:00:21,750
service<font color="#CCCCCC"> that</font><font color="#E5E5E5"> we're going to attack and</font>

1405
01:00:21,750 --> 01:00:25,200
that is the most important<font color="#CCCCCC"> option and</font>

1406
01:00:25,200 --> 01:00:26,880
the<font color="#CCCCCC"> options that</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> need</font><font color="#E5E5E5"> to pay the</font>

1407
01:00:26,880 --> 01:00:29,370
most attention to<font color="#CCCCCC"> because this</font><font color="#E5E5E5"> is</font><font color="#CCCCCC"> where</font>

1408
01:00:29,370 --> 01:00:31,290
it gets<font color="#E5E5E5"> a</font><font color="#CCCCCC"> bit tricky and this is where</font>

1409
01:00:31,290 --> 01:00:32,610
<font color="#E5E5E5">things can go wrong</font>

1410
01:00:32,610 --> 01:00:35,340
so before I start<font color="#CCCCCC"> talking</font><font color="#E5E5E5"> about that I'm</font>

1411
01:00:35,340 --> 01:00:37,110
actually going to<font color="#E5E5E5"> copy our commands so</font>

1412
01:00:37,110 --> 01:00:39,990
far<font color="#E5E5E5"> and I'm just</font><font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> paste it in our</font>

1413
01:00:39,990 --> 01:00:42,590
notepad

1414
01:00:46,720 --> 01:00:49,780
so all we have to<font color="#CCCCCC"> do now</font><font color="#E5E5E5"> is tell</font><font color="#CCCCCC"> Hydra</font>

1415
01:00:49,780 --> 01:00:52,060
<font color="#E5E5E5">what type of service and how to use the</font>

1416
01:00:52,060 --> 01:00:53,890
service<font color="#CCCCCC"> to brute force the username</font><font color="#E5E5E5"> and</font>

1417
01:00:53,890 --> 01:00:56,829
<font color="#CCCCCC">password</font><font color="#E5E5E5"> for me and you can see here in</font>

1418
01:00:56,829 --> 01:00:59,200
the help it's telling<font color="#E5E5E5"> us</font><font color="#CCCCCC"> that these are</font>

1419
01:00:59,200 --> 01:01:01,329
all the type of the supported services

1420
01:01:01,329 --> 01:01:03,670
<font color="#E5E5E5">so as I said I can't actually</font><font color="#CCCCCC"> think of</font><font color="#E5E5E5"> a</font>

1421
01:01:03,670 --> 01:01:07,089
service that's not supported so you can

1422
01:01:07,089 --> 01:01:08,650
have a<font color="#E5E5E5"> look on all of these and try them</font>

1423
01:01:08,650 --> 01:01:11,440
what<font color="#CCCCCC"> we're interested in too is the HTTP</font>

1424
01:01:11,440 --> 01:01:13,660
<font color="#E5E5E5">and you can see that there's</font><font color="#CCCCCC"> going to</font><font color="#E5E5E5"> be</font>

1425
01:01:13,660 --> 01:01:17,079
<font color="#E5E5E5">a - and it's going to be either get or</font>

1426
01:01:17,079 --> 01:01:21,250
post<font color="#CCCCCC"> dependent on our target and after</font>

1427
01:01:21,250 --> 01:01:23,079
that it's also<font color="#E5E5E5"> going to be a</font><font color="#CCCCCC"> forum</font>

1428
01:01:23,079 --> 01:01:26,380
because<font color="#E5E5E5"> it's sent through HTML and I'll</font>

1429
01:01:26,380 --> 01:01:28,000
tell you why it's going<font color="#E5E5E5"> to be like this</font>

1430
01:01:28,000 --> 01:01:30,780
now let's go down

1431
01:01:31,690 --> 01:01:33,730
so I'm going to<font color="#E5E5E5"> right-click in</font><font color="#CCCCCC"> here and</font>

1432
01:01:33,730 --> 01:01:38,369
<font color="#E5E5E5">I'm going</font><font color="#CCCCCC"> to go to inspect</font><font color="#E5E5E5"> element</font>

1433
01:01:38,779 --> 01:01:40,729
and I'm gonna click<font color="#CCCCCC"> I'm gonna look</font><font color="#E5E5E5"> for</font>

1434
01:01:40,729 --> 01:01:42,349
<font color="#E5E5E5">something called form and you can</font><font color="#CCCCCC"> see</font>

1435
01:01:42,349 --> 01:01:43,789
<font color="#E5E5E5">that there is a form there has to be a</font>

1436
01:01:43,789 --> 01:01:48,019
form in<font color="#CCCCCC"> the HTML pages</font><font color="#E5E5E5"> and look for the</font>

1437
01:01:48,019 --> 01:01:51,849
method I'm going<font color="#CCCCCC"> to</font><font color="#E5E5E5"> zoom this</font><font color="#CCCCCC"> in for you</font>

1438
01:01:52,960 --> 01:01:55,390
and note<font color="#CCCCCC"> that and here it says</font><font color="#E5E5E5"> that the</font>

1439
01:01:55,390 --> 01:01:58,300
method<font color="#E5E5E5"> is going to be post and that</font><font color="#CCCCCC"> way</font>

1440
01:01:58,300 --> 01:02:01,480
<font color="#E5E5E5">we know that it's a post and if you look</font>

1441
01:02:01,480 --> 01:02:03,700
at the<font color="#CCCCCC"> URL here you'll see that the URL</font>

1442
01:02:03,700 --> 01:02:08,589
is a HTTP it's not<font color="#E5E5E5"> a</font><font color="#CCCCCC"> HTTP so therefore</font>

1443
01:02:08,589 --> 01:02:11,020
<font color="#E5E5E5">our module that we're going to use here</font>

1444
01:02:11,020 --> 01:02:14,680
<font color="#E5E5E5">or the service is going to be HTTP POST</font>

1445
01:02:14,680 --> 01:02:18,190
<font color="#E5E5E5">form so it's right here you can see it</font>

1446
01:02:18,190 --> 01:02:20,140
all the type of services like<font color="#CCCCCC"> I said</font>

1447
01:02:20,140 --> 01:02:25,960
so it's HTTP followed<font color="#E5E5E5"> by a - followed by</font>

1448
01:02:25,960 --> 01:02:29,920
<font color="#E5E5E5">post and followed by</font><font color="#CCCCCC"> form and to see how</font>

1449
01:02:29,920 --> 01:02:32,050
<font color="#E5E5E5">we can</font><font color="#CCCCCC"> use this</font><font color="#E5E5E5"> and to see an example of</font>

1450
01:02:32,050 --> 01:02:33,760
<font color="#E5E5E5">how you can use this service I'm</font>

1451
01:02:33,760 --> 01:02:35,849
actually going to<font color="#E5E5E5"> control</font><font color="#CCCCCC"> see this</font><font color="#E5E5E5"> and</font>

1452
01:02:35,849 --> 01:02:40,900
I'm<font color="#E5E5E5"> gonna say Hydra - you and I'm gonna</font>

1453
01:02:40,900 --> 01:02:42,609
give<font color="#CCCCCC"> it the</font><font color="#E5E5E5"> name of</font><font color="#CCCCCC"> the forum</font><font color="#E5E5E5"> or the</font>

1454
01:02:42,609 --> 01:02:44,050
name of<font color="#CCCCCC"> the service that</font><font color="#E5E5E5"> I want to use</font>

1455
01:02:44,050 --> 01:02:47,170
which is going to<font color="#CCCCCC"> be HTTP</font>

1456
01:02:47,170 --> 01:02:49,920
<font color="#CCCCCC">post</font>

1457
01:02:50,270 --> 01:02:52,049
form

1458
01:02:52,049 --> 01:02:54,179
as you can see now<font color="#E5E5E5"> again it's</font><font color="#CCCCCC"> giving you</font>

1459
01:02:54,179 --> 01:02:56,429
a long description<font color="#E5E5E5"> about</font><font color="#CCCCCC"> how you can</font><font color="#E5E5E5"> use</font>

1460
01:02:56,429 --> 01:02:59,309
this<font color="#CCCCCC"> service</font><font color="#E5E5E5"> and at the bottom it gives</font>

1461
01:02:59,309 --> 01:03:01,349
you examples and the examples are

1462
01:03:01,349 --> 01:03:03,509
amazing<font color="#E5E5E5"> the examples are</font><font color="#CCCCCC"> really good</font>

1463
01:03:03,509 --> 01:03:05,459
because<font color="#E5E5E5"> you</font><font color="#CCCCCC"> can just</font><font color="#E5E5E5"> copy and paste them</font>

1464
01:03:05,459 --> 01:03:09,680
<font color="#E5E5E5">and adapt them</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> your target</font>

1465
01:03:09,680 --> 01:03:12,950
so the format of<font color="#E5E5E5"> this service is you</font>

1466
01:03:12,950 --> 01:03:15,829
give it<font color="#E5E5E5"> the location where the brute</font>

1467
01:03:15,829 --> 01:03:17,500
<font color="#CCCCCC">force where you want to brute force</font>

1468
01:03:17,500 --> 01:03:20,900
<font color="#E5E5E5">deform from</font><font color="#CCCCCC"> your gonna give</font><font color="#E5E5E5"> it</font><font color="#CCCCCC"> the user</font>

1469
01:03:20,900 --> 01:03:23,270
<font color="#E5E5E5">parameter so whether it's</font><font color="#CCCCCC"> you well it's</font>

1470
01:03:23,270 --> 01:03:25,390
whatever<font color="#E5E5E5"> this parameter</font><font color="#CCCCCC"> is called</font><font color="#E5E5E5"> and</font>

1471
01:03:25,390 --> 01:03:27,410
then you're<font color="#CCCCCC"> gonna give</font><font color="#E5E5E5"> me the password</font>

1472
01:03:27,410 --> 01:03:30,650
parameter and then you're gonna give<font color="#CCCCCC"> it</font>

1473
01:03:30,650 --> 01:03:32,930
the<font color="#E5E5E5"> incorrect message so when</font><font color="#CCCCCC"> there's</font><font color="#E5E5E5"> a</font>

1474
01:03:32,930 --> 01:03:35,210
failed login<font color="#E5E5E5"> what happens to the web</font>

1475
01:03:35,210 --> 01:03:38,150
<font color="#E5E5E5">page</font><font color="#CCCCCC"> so I'm</font><font color="#E5E5E5"> going to copy this the way</font>

1476
01:03:38,150 --> 01:03:40,450
it is

1477
01:03:43,460 --> 01:03:46,190
and we're<font color="#E5E5E5"> gonna modify to adapt to</font><font color="#CCCCCC"> our</font>

1478
01:03:46,190 --> 01:03:49,130
target<font color="#E5E5E5"> so the first thing you we want to</font>

1479
01:03:49,130 --> 01:03:51,680
put is the<font color="#CCCCCC"> page that the</font><font color="#E5E5E5"> login happens</font>

1480
01:03:51,680 --> 01:03:54,580
from<font color="#E5E5E5"> which is this page</font>

1481
01:03:54,580 --> 01:03:56,470
so we're<font color="#E5E5E5"> going to put all of this</font>

1482
01:03:56,470 --> 01:04:00,480
<font color="#E5E5E5">instead of login dot PHP here</font>

1483
01:04:02,450 --> 01:04:05,809
so that's all good<font color="#CCCCCC"> now the</font><font color="#E5E5E5"> next thing</font>

1484
01:04:05,809 --> 01:04:08,180
<font color="#E5E5E5">that we</font><font color="#CCCCCC"> need to modify</font><font color="#E5E5E5"> is the user and</font>

1485
01:04:08,180 --> 01:04:11,930
the pass<font color="#E5E5E5"> so these are the names of the</font>

1486
01:04:11,930 --> 01:04:14,540
<font color="#CCCCCC">parameters that</font><font color="#E5E5E5"> are sent to the web</font>

1487
01:04:14,540 --> 01:04:16,730
<font color="#CCCCCC">application</font><font color="#E5E5E5"> and we don't know what</font><font color="#CCCCCC"> these</font>

1488
01:04:16,730 --> 01:04:19,040
<font color="#CCCCCC">are called and for</font><font color="#E5E5E5"> this we're gonna use</font>

1489
01:04:19,040 --> 01:04:21,049
burp<font color="#CCCCCC"> suit</font><font color="#E5E5E5"> now I'm not going to show you</font>

1490
01:04:21,049 --> 01:04:23,059
how<font color="#E5E5E5"> to configure this because</font><font color="#CCCCCC"> we've done</font>

1491
01:04:23,059 --> 01:04:25,190
<font color="#E5E5E5">that before so I'm just</font><font color="#CCCCCC"> gonna turn my</font>

1492
01:04:25,190 --> 01:04:28,549
<font color="#CCCCCC">Interceptor on</font><font color="#E5E5E5"> and I'm gonna log</font><font color="#CCCCCC"> in with</font>

1493
01:04:28,549 --> 01:04:30,230
our<font color="#CCCCCC"> wrong username and password so I</font>

1494
01:04:30,230 --> 01:04:32,299
just want to see what gets sent to the

1495
01:04:32,299 --> 01:04:34,609
<font color="#E5E5E5">target web application so I'm just gonna</font>

1496
01:04:34,609 --> 01:04:37,400
<font color="#E5E5E5">log</font><font color="#CCCCCC"> in with</font><font color="#E5E5E5"> the username admin and just</font>

1497
01:04:37,400 --> 01:04:38,780
any password so I'm<font color="#E5E5E5"> just gonna put</font>

1498
01:04:38,780 --> 01:04:41,950
random characters<font color="#E5E5E5"> hit enter</font>

1499
01:04:41,950 --> 01:04:45,930
and I'm gonna go<font color="#CCCCCC"> on the headers</font>

1500
01:04:45,930 --> 01:04:48,660
and this is what's being sent so you can

1501
01:04:48,660 --> 01:04:52,140
see that the<font color="#CCCCCC"> username parameter is just</font>

1502
01:04:52,140 --> 01:04:54,390
<font color="#E5E5E5">called username so I'm going to copy</font>

1503
01:04:54,390 --> 01:04:59,119
that<font color="#E5E5E5"> and put it</font><font color="#CCCCCC"> here instead</font><font color="#E5E5E5"> of user</font>

1504
01:04:59,660 --> 01:05:01,970
and we can also see the<font color="#E5E5E5"> password</font>

1505
01:05:01,970 --> 01:05:04,849
parameter again<font color="#CCCCCC"> it's</font><font color="#E5E5E5"> called password</font>

1506
01:05:04,849 --> 01:05:07,800
<font color="#E5E5E5">instead of pass</font>

1507
01:05:07,800 --> 01:05:09,330
and you can see that we also<font color="#E5E5E5"> have an</font>

1508
01:05:09,330 --> 01:05:12,390
extra<font color="#E5E5E5"> parameter here which is an login</font>

1509
01:05:12,390 --> 01:05:15,210
submit' button equals<font color="#E5E5E5"> login so you need</font>

1510
01:05:15,210 --> 01:05:18,060
to add that<font color="#CCCCCC"> as well</font><font color="#E5E5E5"> and in your case if</font>

1511
01:05:18,060 --> 01:05:19,710
<font color="#CCCCCC">you had other</font><font color="#E5E5E5"> things that's being sent</font>

1512
01:05:19,710 --> 01:05:21,870
<font color="#CCCCCC">you need to add them</font><font color="#E5E5E5"> as well</font><font color="#CCCCCC"> to your</font>

1513
01:05:21,870 --> 01:05:24,480
request<font color="#E5E5E5"> so we're going to add that after</font>

1514
01:05:24,480 --> 01:05:26,650
the pass here

1515
01:05:26,650 --> 01:05:28,700
exactly the way it is we're<font color="#CCCCCC"> not</font><font color="#E5E5E5"> going to</font>

1516
01:05:28,700 --> 01:05:30,979
modify<font color="#E5E5E5"> anything so it's just going to be</font>

1517
01:05:30,979 --> 01:05:36,130
and<font color="#CCCCCC"> login.php submit button equals</font><font color="#E5E5E5"> login</font>

1518
01:05:36,130 --> 01:05:38,319
the last thing that we need<font color="#CCCCCC"> to modify</font><font color="#E5E5E5"> is</font>

1519
01:05:38,319 --> 01:05:42,449
this part and this part is<font color="#E5E5E5"> the way that</font>

1520
01:05:42,449 --> 01:05:44,890
Hydra<font color="#E5E5E5"> is going to know whether the login</font>

1521
01:05:44,890 --> 01:05:49,059
is successful or unsuccessful<font color="#CCCCCC"> so the way</font>

1522
01:05:49,059 --> 01:05:50,949
this<font color="#E5E5E5"> is going to work is</font><font color="#CCCCCC"> you either give</font>

1523
01:05:50,949 --> 01:05:54,719
it<font color="#E5E5E5"> a capital</font><font color="#CCCCCC"> f equals</font><font color="#E5E5E5"> to the</font>

1524
01:05:54,719 --> 01:05:57,489
unsuccessful<font color="#E5E5E5"> so it equals</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> the failed</font>

1525
01:05:57,489 --> 01:06:00,069
attempts or you can give it<font color="#CCCCCC"> a</font><font color="#E5E5E5"> capital S</font>

1526
01:06:00,069 --> 01:06:03,160
<font color="#E5E5E5">and you tell</font><font color="#CCCCCC"> it what happens when a</font>

1527
01:06:03,160 --> 01:06:06,729
successful login<font color="#E5E5E5"> happens so in my case</font>

1528
01:06:06,729 --> 01:06:10,299
I'm gonna<font color="#E5E5E5"> give it a capital F to tell it</font>

1529
01:06:10,299 --> 01:06:12,160
what happens when<font color="#E5E5E5"> a failed login happens</font>

1530
01:06:12,160 --> 01:06:14,440
and I'm just<font color="#E5E5E5"> going to turn off the</font>

1531
01:06:14,440 --> 01:06:16,509
<font color="#E5E5E5">Interceptor now and we can see</font><font color="#CCCCCC"> that we</font>

1532
01:06:16,509 --> 01:06:19,209
have a failed login and in a failed

1533
01:06:19,209 --> 01:06:21,729
login you<font color="#CCCCCC"> can either use this or</font><font color="#E5E5E5"> in my</font>

1534
01:06:21,729 --> 01:06:24,069
<font color="#E5E5E5">experimentation it was easier to just</font>

1535
01:06:24,069 --> 01:06:27,430
<font color="#CCCCCC">use this so if you just</font><font color="#E5E5E5"> use the message</font>

1536
01:06:27,430 --> 01:06:30,369
right<font color="#E5E5E5"> here</font><font color="#CCCCCC"> that says</font><font color="#E5E5E5"> not logged in so</font>

1537
01:06:30,369 --> 01:06:34,109
we're going<font color="#E5E5E5"> to say F equals</font>

1538
01:06:39,570 --> 01:06:42,660
so this is the most<font color="#E5E5E5"> part the most</font>

1539
01:06:42,660 --> 01:06:44,820
important part and<font color="#CCCCCC"> the</font><font color="#E5E5E5"> most tricky part</font>

1540
01:06:44,820 --> 01:06:47,310
I'd say of the whole attack<font color="#E5E5E5"> so I'm</font><font color="#CCCCCC"> going</font>

1541
01:06:47,310 --> 01:06:49,080
<font color="#CCCCCC">to go over it again</font>

1542
01:06:49,080 --> 01:06:50,940
we can see that<font color="#E5E5E5"> the</font><font color="#CCCCCC"> whole</font><font color="#E5E5E5"> request is</font>

1543
01:06:50,940 --> 01:06:53,750
separated by<font color="#E5E5E5"> three columns</font>

1544
01:06:53,750 --> 01:06:57,050
the start of<font color="#E5E5E5"> it is the location where</font><font color="#CCCCCC"> we</font>

1545
01:06:57,050 --> 01:06:58,970
want<font color="#E5E5E5"> where the page that we're going to</font>

1546
01:06:58,970 --> 01:07:04,750
<font color="#E5E5E5">brute force</font><font color="#CCCCCC"> is so we took that</font><font color="#E5E5E5"> from here</font>

1547
01:07:05,760 --> 01:07:09,630
the second part is<font color="#E5E5E5"> the parameters that</font>

1548
01:07:09,630 --> 01:07:11,790
we're<font color="#CCCCCC"> going to be dealing with</font><font color="#E5E5E5"> and that</font>

1549
01:07:11,790 --> 01:07:13,500
we're going<font color="#E5E5E5"> to be sending</font><font color="#CCCCCC"> to the server</font>

1550
01:07:13,500 --> 01:07:17,910
<font color="#E5E5E5">and</font><font color="#CCCCCC"> we took that from</font><font color="#E5E5E5"> burp</font><font color="#CCCCCC"> suit</font>

1551
01:07:17,910 --> 01:07:21,329
and the third part<font color="#E5E5E5"> is the</font><font color="#CCCCCC"> way that</font>

1552
01:07:21,329 --> 01:07:23,130
pursuit is going to know whether<font color="#E5E5E5"> this</font>

1553
01:07:23,130 --> 01:07:26,130
login is successful<font color="#E5E5E5"> or in successful and</font>

1554
01:07:26,130 --> 01:07:29,309
we gave it<font color="#E5E5E5"> capital F to tell it that</font>

1555
01:07:29,309 --> 01:07:31,289
this<font color="#E5E5E5"> is</font><font color="#CCCCCC"> what happens when the password</font>

1556
01:07:31,289 --> 01:07:34,140
<font color="#E5E5E5">is wrong and we told it that you'll see</font>

1557
01:07:34,140 --> 01:07:37,369
a<font color="#CCCCCC"> message called</font><font color="#E5E5E5"> not logged in</font>

1558
01:07:37,369 --> 01:07:39,829
so we're going to combine<font color="#E5E5E5"> this with the</font>

1559
01:07:39,829 --> 01:07:41,420
command that<font color="#E5E5E5"> we already had so the</font>

1560
01:07:41,420 --> 01:07:43,190
command that<font color="#E5E5E5"> we</font><font color="#CCCCCC"> already had was Hydra</font>

1561
01:07:43,190 --> 01:07:45,990
<font color="#E5E5E5">the</font><font color="#CCCCCC"> IP</font>

1562
01:07:45,990 --> 01:07:48,869
<font color="#E5E5E5">followed by the username that we're</font>

1563
01:07:48,869 --> 01:07:51,360
<font color="#CCCCCC">going to use which is admin followed</font><font color="#E5E5E5"> by</font>

1564
01:07:51,360 --> 01:07:54,660
the password list<font color="#E5E5E5"> and we're</font><font color="#CCCCCC"> going to put</font>

1565
01:07:54,660 --> 01:07:57,810
<font color="#CCCCCC">all of this</font><font color="#E5E5E5"> after</font><font color="#CCCCCC"> it and that's it</font>

1566
01:07:57,810 --> 01:07:59,670
that's our command<font color="#E5E5E5"> done I'm</font><font color="#CCCCCC"> going to</font>

1567
01:07:59,670 --> 01:08:02,150
copy this

1568
01:08:03,099 --> 01:08:07,559
paste it in here<font color="#CCCCCC"> and execute</font>

1569
01:08:07,559 --> 01:08:10,319
and I forgot<font color="#CCCCCC"> to</font><font color="#E5E5E5"> tell it the type of</font><font color="#CCCCCC"> the</font>

1570
01:08:10,319 --> 01:08:12,299
service<font color="#E5E5E5"> that we're going to be</font><font color="#CCCCCC"> attacking</font>

1571
01:08:12,299 --> 01:08:15,150
so I only gave<font color="#CCCCCC"> it the I only gave it</font>

1572
01:08:15,150 --> 01:08:17,219
<font color="#E5E5E5">what it should send but I didn't tell</font><font color="#CCCCCC"> it</font>

1573
01:08:17,219 --> 01:08:18,839
what type<font color="#E5E5E5"> of service were going attack</font>

1574
01:08:18,839 --> 01:08:21,029
<font color="#E5E5E5">so like I</font><font color="#CCCCCC"> said</font><font color="#E5E5E5"> before it's going to be</font>

1575
01:08:21,029 --> 01:08:26,368
HTTP<font color="#E5E5E5"> POST</font><font color="#CCCCCC"> form so it's the same service</font>

1576
01:08:26,368 --> 01:08:28,380
that<font color="#CCCCCC"> we were</font><font color="#E5E5E5"> inquiring about when we</font>

1577
01:08:28,380 --> 01:08:33,380
<font color="#CCCCCC">used you option so again</font><font color="#E5E5E5"> copy this</font>

1578
01:08:34,149 --> 01:08:36,330
paste it<font color="#CCCCCC"> here</font>

1579
01:08:36,330 --> 01:08:37,849
<font color="#CCCCCC">her enter</font>

1580
01:08:37,849 --> 01:08:40,609
now you can use the<font color="#CCCCCC"> minus</font><font color="#E5E5E5"> V option so</font>

1581
01:08:40,609 --> 01:08:43,219
that Hydra would actually display every

1582
01:08:43,219 --> 01:08:46,040
request<font color="#CCCCCC"> it sends</font><font color="#E5E5E5"> to the server I didn't</font>

1583
01:08:46,040 --> 01:08:47,868
use<font color="#CCCCCC"> that right now so all you see is</font>

1584
01:08:47,868 --> 01:08:49,908
literally just<font color="#E5E5E5"> a blank screen but we're</font>

1585
01:08:49,908 --> 01:08:51,529
going<font color="#E5E5E5"> to wait for</font><font color="#CCCCCC"> it until it finds the</font>

1586
01:08:51,529 --> 01:08:54,500
password for us<font color="#E5E5E5"> Hydra also supports</font>

1587
01:08:54,500 --> 01:08:57,290
<font color="#E5E5E5">pause and resume so if you just control</font>

1588
01:08:57,290 --> 01:08:59,630
<font color="#CCCCCC">C out of this the next</font><font color="#E5E5E5"> time you're on it</font>

1589
01:08:59,630 --> 01:09:01,549
all you<font color="#CCCCCC"> have to do is just</font><font color="#E5E5E5"> put in minus</font>

1590
01:09:01,549 --> 01:09:04,099
R<font color="#E5E5E5"> and</font><font color="#CCCCCC"> that'll actually allow you to</font>

1591
01:09:04,099 --> 01:09:06,948
continue<font color="#E5E5E5"> from where</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> were you left the</font>

1592
01:09:06,948 --> 01:09:09,399
last<font color="#E5E5E5"> time</font>

1593
01:09:10,069 --> 01:09:11,868
and as you can<font color="#E5E5E5"> see now we managed to</font>

1594
01:09:11,868 --> 01:09:15,109
find a valid username and password and

1595
01:09:15,109 --> 01:09:17,118
<font color="#CCCCCC">you can</font><font color="#E5E5E5"> see that the username is admin</font>

1596
01:09:17,118 --> 01:09:20,270
and<font color="#E5E5E5"> the password is admin pass and this</font>

1597
01:09:20,270 --> 01:09:23,000
works<font color="#E5E5E5"> against any web</font><font color="#CCCCCC"> login so it</font>

1598
01:09:23,000 --> 01:09:25,009
literally this web login doesn't read

1599
01:09:25,009 --> 01:09:27,439
doesn't need to have any<font color="#E5E5E5"> SQL injections</font>

1600
01:09:27,439 --> 01:09:30,618
<font color="#E5E5E5">or JavaScript or XSS or anything so now</font>

1601
01:09:30,618 --> 01:09:33,149
I can<font color="#CCCCCC"> login with the username</font><font color="#E5E5E5"> admin</font>

1602
01:09:33,149 --> 01:09:36,450
and password admin<font color="#CCCCCC"> pass</font>

1603
01:09:36,450 --> 01:09:39,270
and as you can<font color="#E5E5E5"> see now I'm logged in as</font>

1604
01:09:39,270 --> 00:00:00,000
admin

